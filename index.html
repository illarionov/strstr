<!doctype html><html lang=ru-ru dir=ltr><head><meta name=generator content="Hugo 0.142.0"><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Двусторонний алгоритм поиска подстроки в строке"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://strstr.0xdc.ru/"><meta property="og:site_name" content="Поиск подстроки в строке"><meta property="og:title" content="Двусторонний алгоритм"><meta property="og:description" content="Двусторонний алгоритм поиска подстроки в строке"><meta property="og:locale" content="ru_ru"><meta property="og:type" content="website"><title>Двусторонний алгоритм | Поиск подстроки в строке</title>
<link rel=icon href=./favicon.png><link rel=manifest href=./manifest.json><link rel=canonical href=https://strstr.0xdc.ru/><link rel=stylesheet href=./book.min.76e02c1593da7ac88fd28fc325fe8be214ab4dd3ce6991c365f99d1667f69ce0.css integrity="sha256-duAsFZPaesiP0o/DJf6L4hSrTdPOaZHDZfmdFmf2nOA=" crossorigin=anonymous><link rel=alternate type=application/rss+xml href=https://strstr.0xdc.ru/index.xml title="Поиск подстроки в строке"><link rel=stylesheet href=./katex/katex.min.css><script defer src=./katex/katex.min.js></script><script defer src=./katex/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=./><span>Поиск подстроки в строке</span></a></h2><ul><li><a href=https://github.com/illarionov/strstr target=_blank rel=noopener>Github</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=./svg/menu.svg class=book-icon alt=Menu></label><h3>Двусторонний алгоритм</h3><label for=toc-control><img src=./svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#двусторонний-алгоритм>Двусторонний алгоритм</a><ul><li><a href=#общая-схема>Общая схема</a></li><li><a href=#базовые-понятия>Базовые понятия</a></li><li><a href=#описание-алгоритма>Описание алгоритма</a><ul><li></li></ul></li><li><a href=#теорема-о-критическом-разбиении>Теорема о критическом разбиении</a></li><li><a href=#вычисление-критического-разбиения>Вычисление критического разбиения</a></li><li><a href=#реализация-алгоритма>Реализация алгоритма</a></li><li><a href=#источники>Источники</a></li></ul></li></ul></nav></aside></header><script>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),ym(89172637,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/89172637 style=position:absolute;left:-9999px alt></div></noscript><article class="markdown book-article"><h1 id=двусторонний-алгоритм>Двусторонний алгоритм
<a class=anchor href=#%d0%b4%d0%b2%d1%83%d1%81%d1%82%d0%be%d1%80%d0%be%d0%bd%d0%bd%d0%b8%d0%b9-%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc>#</a></h1><p><strong>Двусторонний алгоритм</strong> (англ. <em>Two-Way String-Matching algorithm</em>) — алгоритм поиска
подстроки в строке, разработанный и представленный Максимом Крочемором (Maxime Crochemore)
и Домиником Перреном (Dominique Perrin) в 1991 году.<a href=#reference_twoway_string_matching>[2]</a>
Относится к группе алгоритмов поиска подстроки с ограниченным потреблением памяти,
константным на практике (constant-space string matching).</p><p>По заданной строке <em>Text</em> длины <em>n</em> и шаблону поиска <em>Pattern</em> длины <em>m</em> алгоритм
позволяет найти все вхождения <em>Pattern</em> в <em>Text</em> за время ${O(n+m)}$, где ${O(m)}$ — этап
предварительных вычислений над шаблоном, а ${O(n)}$ — этап поиска. При этом, во время поиска
выполняется не более ${2n-m}$ операций сравнения.</p><p>В отличие от алгоритмов Кнута-Морриса-Пратта и Бойера-Мура, данный алгоритм требует
${O(\log(m))}$ памяти: на этапе препроцессинга строка шаблона разбивается на 2 подстроки и
хранится только позиция этого разбиения. Численное значение этой позиции меньше длины
шаблона $m$, поэтому требование по памяти может быть представлено как
${\lceil\log_2m\rceil}$ бит и на практике может быть взято за ${O(1)}$.</p><p>Другое отличие данного алгоритма заключается в том, что ему требуется упорядоченный
алфавит, так как во время препроцессинга символы сравниваются на больше и меньше.</p><p>Алгоритм в целом считается достаточно эффективным и благодаря тому, что потребление памяти
практически не зависит от длины текста или шаблона, он используется в реализациях функций
<code>strstr()</code>, <code>memem()</code> некоторых вариантов библиотек libc: <a href=https://github.com/bminor/glibc/blob/a01a13601c95f5d111d25557656d09fe661cfc89/string/strstr.c#L74>glibc</a>, <a href="https://sourceware.org/git/?p=newlib-cygwin.git;a=blob;f=newlib/libc/string/memmem.c;h=65267b9c5e52b15db86feec5b7a511d927ec469a;hb=HEAD#l112">newlib</a> <a href=https://git.musl-libc.org/cgit/musl/tree/src/string/strstr.c#n33>musl</a> при
достаточно длинной строке шаблона.</p><h2 id=общая-схема>Общая схема
<a class=anchor href=#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d1%81%d1%85%d0%b5%d0%bc%d0%b0>#</a></h2><p>Сканирование строки на этапе поиска двустороннего алгоритма похоже на сканирование в
примитивном алгоритме, алгоритмах Кнута-Морриса-Пратта и Бойера-Мура.</p><p>В алгоритме Кнута-Морриса-Пратта строка сканируется слева направо, сравнение символов
шаблона с символами текста также выполняется слева направо. Когда происходит несовпадение
в какой-то позиции шаблона (либо все символы шаблона равны и найдено вхождение), шаблон
сдвигается вправо на несколько позиций по заранее вычисленной таблице сдвигов паттернов
поиска.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 393"><g transform="translate(8,16)"><path d="M80 0h32" fill="none" stroke="currentcolor"/><path d="M112 0h32" fill="none" stroke="currentcolor"/><path d="M144 0h32" fill="none" stroke="currentcolor"/><path d="M176 0h32" fill="none" stroke="currentcolor"/><path d="M208 0h32" fill="none" stroke="currentcolor"/><path d="M240 0h32" fill="none" stroke="currentcolor"/><path d="M272 0h32" fill="none" stroke="currentcolor"/><path d="M304 0h32" fill="none" stroke="currentcolor"/><path d="M336 0h32" fill="none" stroke="currentcolor"/><path d="M368 0h32" fill="none" stroke="currentcolor"/><path d="M4e2.0h32" fill="none" stroke="currentcolor"/><path d="M432 0h32" fill="none" stroke="currentcolor"/><path d="M464 0h32" fill="none" stroke="currentcolor"/><path d="M496 0h32" fill="none" stroke="currentcolor"/><path d="M528 0h32" fill="none" stroke="currentcolor"/><path d="M560 0h32" fill="none" stroke="currentcolor"/><path d="M592 0h32" fill="none" stroke="currentcolor"/><path d="M624 0h32" fill="none" stroke="currentcolor"/><path d="M656 0h32" fill="none" stroke="currentcolor"/><path d="M688 0h32" fill="none" stroke="currentcolor"/><path d="M720 0h32" fill="none" stroke="currentcolor"/><path d="M80 48H752" fill="none" stroke="currentcolor"/><path d="M80 80H752" fill="none" stroke="currentcolor"/><path d="M224 112H344" fill="none" stroke="currentcolor"/><path d="M96 128H296" fill="none" stroke="currentcolor"/><path d="M96 160H296" fill="none" stroke="currentcolor"/><path d="M192 208H392" fill="none" stroke="currentcolor"/><path d="M96 224h72" fill="none" stroke="currentcolor"/><path d="M192 240H392" fill="none" stroke="currentcolor"/><path d="M224 288H424" fill="none" stroke="currentcolor"/><path d="M224 320H424" fill="none" stroke="currentcolor"/><path d="M80 0V16" fill="none" stroke="currentcolor"/><path d="M80 48V80" fill="none" stroke="currentcolor"/><path d="M96 160v64" fill="none" stroke="currentcolor"/><path d="M112 0V16" fill="none" stroke="currentcolor"/><path d="M144 0V16" fill="none" stroke="currentcolor"/><path d="M176 0V16" fill="none" stroke="currentcolor"/><path d="M208 0V16" fill="none" stroke="currentcolor"/><path d="M240 0V16" fill="none" stroke="currentcolor"/><path d="M272 0V16" fill="none" stroke="currentcolor"/><path d="M304 0V16" fill="none" stroke="currentcolor"/><path d="M336 0V16" fill="none" stroke="currentcolor"/><path d="M368 0V16" fill="none" stroke="currentcolor"/><path d="M4e2.0V16" fill="none" stroke="currentcolor"/><path d="M432 0V16" fill="none" stroke="currentcolor"/><path d="M464 0V16" fill="none" stroke="currentcolor"/><path d="M496 0V16" fill="none" stroke="currentcolor"/><path d="M528 0V16" fill="none" stroke="currentcolor"/><path d="M560 0V16" fill="none" stroke="currentcolor"/><path d="M592 0V16" fill="none" stroke="currentcolor"/><path d="M624 0V16" fill="none" stroke="currentcolor"/><path d="M656 0V16" fill="none" stroke="currentcolor"/><path d="M688 0V16" fill="none" stroke="currentcolor"/><path d="M720 0V16" fill="none" stroke="currentcolor"/><path d="M752 0V16" fill="none" stroke="currentcolor"/><path d="M752 48V80" fill="none" stroke="currentcolor"/><polygon points="176.000000,224.000000 164.000000,218.399994 164.000000,229.600006" fill="currentcolor" transform="rotate(0.000000, 168.000000, 224.000000)"/><polygon points="352.000000,112.000000 340.000000,106.400002 340.000000,117.599998" fill="currentcolor" transform="rotate(0.000000, 344.000000, 112.000000)"/><path d="M96 128A16 16 0 0080 144" fill="none" stroke="currentcolor"/><path d="M296 128a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M80 144a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M312 144a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><path d="M192 208a16 16 0 00-16 16" fill="none" stroke="currentcolor"/><path d="M392 208a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M176 224a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M408 224a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><path d="M224 288a16 16 0 00-16 16" fill="none" stroke="currentcolor"/><path d="M424 288a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M208 304a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M440 304a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><text text-anchor="middle" x="0" y="148" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="228" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="308" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="148" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="228" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="308" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="228" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="308" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="228" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="308" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="68" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="32" y="148" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="148" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="228" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="308" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="68" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="148" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="228" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="308" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="148" fill="currentcolor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="228" fill="currentcolor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="308" fill="currentcolor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="68" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="148" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="228" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="308" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="96" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="116" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="96" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="112" y="212" fill="currentcolor" style="font-size:1em">С</text><text text-anchor="middle" x="120" y="212" fill="currentcolor" style="font-size:1em">д</text><text text-anchor="middle" x="128" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="116" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="128" y="148" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="212" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="136" y="212" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="144" y="212" fill="currentcolor" style="font-size:1em">г</text><text text-anchor="middle" x="160" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="160" y="116" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="160" y="148" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="192" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="116" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="192" y="148" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="196" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="192" y="228" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="372" fill="currentcolor" style="font-size:1em">С</text><text text-anchor="middle" x="216" y="372" fill="currentcolor" style="font-size:1em">к</text><text text-anchor="middle" x="224" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="224" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="228" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="224" y="276" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="308" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="372" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="232" y="100" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="232" y="372" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="240" y="100" fill="currentcolor" style="font-size:1em">к</text><text text-anchor="middle" x="240" y="372" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="248" y="100" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="248" y="372" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="256" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="256" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="100" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="256" y="148" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="228" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="276" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="256" y="308" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="372" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="264" y="100" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="264" y="372" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="272" y="100" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="272" y="372" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="280" y="100" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="280" y="372" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="288" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="288" y="100" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="288" y="148" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="228" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="276" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="288" y="308" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="288" y="372" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="296" y="100" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="296" y="372" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="304" y="100" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="312" y="100" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="312" y="372" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="320" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="320" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="320" y="100" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="320" y="228" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="276" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="320" y="308" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="320" y="372" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="328" y="372" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="336" y="372" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="344" y="372" fill="currentcolor" style="font-size:1em">к</text><text text-anchor="middle" x="352" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="352" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="352" y="228" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="276" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="352" y="308" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="352" y="372" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="368" y="372" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="384" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="384" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="384" y="228" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="276" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="384" y="308" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="384" y="372" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="392" y="372" fill="currentcolor" style="font-size:1em">л</text><text text-anchor="middle" x="400" y="372" fill="currentcolor" style="font-size:1em">г</text><text text-anchor="middle" x="408" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="408" y="372" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="416" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="276" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="416" y="308" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="416" y="372" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="424" y="372" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="432" y="372" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="440" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="440" y="372" fill="currentcolor" style="font-size:1em">м</text><text text-anchor="middle" x="448" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="448" y="372" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="464" y="372" fill="currentcolor" style="font-size:1em">К</text><text text-anchor="middle" x="472" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="472" y="372" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="480" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="480" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="480" y="372" fill="currentcolor" style="font-size:1em">у</text><text text-anchor="middle" x="488" y="372" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="496" y="372" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="504" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="504" y="372" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="512" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="512" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="512" y="372" fill="currentcolor" style="font-size:1em">М</text><text text-anchor="middle" x="520" y="372" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="528" y="372" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="536" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="536" y="372" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="544" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="544" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="544" y="372" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="552" y="372" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="560" y="372" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="568" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="568" y="372" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="576" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="576" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="576" y="372" fill="currentcolor" style="font-size:1em">П</text><text text-anchor="middle" x="584" y="372" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="592" y="372" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="600" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="600" y="372" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="608" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="608" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="608" y="372" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="616" y="372" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="632" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="640" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="664" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="672" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="696" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="704" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="728" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="736" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="68" fill="currentcolor" style="font-size:1em">B</text></g></svg></div><p>В алгоритме Бойера-Мура строка также сканируется слева направо, но символы шаблона
сравниваются справа налево. При встрече несовпадающего символа, шаблон сдвигается на
смещение, которое вычисляется как максимальное по 2 эвристикам: правилу сдвига плохого
символа и правилу хорошего суффикса.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 377"><g transform="translate(8,16)"><path d="M80 0h32" fill="none" stroke="currentcolor"/><path d="M112 0h32" fill="none" stroke="currentcolor"/><path d="M144 0h32" fill="none" stroke="currentcolor"/><path d="M176 0h32" fill="none" stroke="currentcolor"/><path d="M208 0h32" fill="none" stroke="currentcolor"/><path d="M240 0h32" fill="none" stroke="currentcolor"/><path d="M272 0h32" fill="none" stroke="currentcolor"/><path d="M304 0h32" fill="none" stroke="currentcolor"/><path d="M336 0h32" fill="none" stroke="currentcolor"/><path d="M368 0h32" fill="none" stroke="currentcolor"/><path d="M4e2.0h32" fill="none" stroke="currentcolor"/><path d="M432 0h32" fill="none" stroke="currentcolor"/><path d="M464 0h32" fill="none" stroke="currentcolor"/><path d="M496 0h32" fill="none" stroke="currentcolor"/><path d="M528 0h32" fill="none" stroke="currentcolor"/><path d="M560 0h32" fill="none" stroke="currentcolor"/><path d="M592 0h32" fill="none" stroke="currentcolor"/><path d="M624 0h32" fill="none" stroke="currentcolor"/><path d="M656 0h32" fill="none" stroke="currentcolor"/><path d="M688 0h32" fill="none" stroke="currentcolor"/><path d="M720 0h32" fill="none" stroke="currentcolor"/><path d="M80 48H752" fill="none" stroke="currentcolor"/><path d="M80 80H752" fill="none" stroke="currentcolor"/><path d="M136 112H256" fill="none" stroke="currentcolor"/><path d="M96 128H352" fill="none" stroke="currentcolor"/><path d="M96 160H344" fill="none" stroke="currentcolor"/><path d="M344 160h8" fill="none" stroke="currentcolor"/><path d="M320 208H584" fill="none" stroke="currentcolor"/><path d="M96 224H296" fill="none" stroke="currentcolor"/><path d="M320 240H584" fill="none" stroke="currentcolor"/><path d="M416 288H680" fill="none" stroke="currentcolor"/><path d="M416 320H680" fill="none" stroke="currentcolor"/><path d="M80 0V16" fill="none" stroke="currentcolor"/><path d="M80 48V80" fill="none" stroke="currentcolor"/><path d="M96 160v64" fill="none" stroke="currentcolor"/><path d="M112 0V16" fill="none" stroke="currentcolor"/><path d="M144 0V16" fill="none" stroke="currentcolor"/><path d="M176 0V16" fill="none" stroke="currentcolor"/><path d="M208 0V16" fill="none" stroke="currentcolor"/><path d="M240 0V16" fill="none" stroke="currentcolor"/><path d="M272 0V16" fill="none" stroke="currentcolor"/><path d="M304 0V16" fill="none" stroke="currentcolor"/><path d="M336 0V16" fill="none" stroke="currentcolor"/><path d="M368 0V16" fill="none" stroke="currentcolor"/><path d="M4e2.0V16" fill="none" stroke="currentcolor"/><path d="M432 0V16" fill="none" stroke="currentcolor"/><path d="M464 0V16" fill="none" stroke="currentcolor"/><path d="M496 0V16" fill="none" stroke="currentcolor"/><path d="M528 0V16" fill="none" stroke="currentcolor"/><path d="M560 0V16" fill="none" stroke="currentcolor"/><path d="M592 0V16" fill="none" stroke="currentcolor"/><path d="M624 0V16" fill="none" stroke="currentcolor"/><path d="M656 0V16" fill="none" stroke="currentcolor"/><path d="M688 0V16" fill="none" stroke="currentcolor"/><path d="M720 0V16" fill="none" stroke="currentcolor"/><path d="M752 0V16" fill="none" stroke="currentcolor"/><path d="M752 48V80" fill="none" stroke="currentcolor"/><polygon points="144.000000,112.000000 132.000000,106.400002 132.000000,117.599998" fill="currentcolor" transform="rotate(180.000000, 136.000000, 112.000000)"/><polygon points="304.000000,224.000000 292.000000,218.399994 292.000000,229.600006" fill="currentcolor" transform="rotate(0.000000, 296.000000, 224.000000)"/><path d="M96 128A16 16 0 0080 144" fill="none" stroke="currentcolor"/><path d="M352 128a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M80 144a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M368 144a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><path d="M320 208a16 16 0 00-16 16" fill="none" stroke="currentcolor"/><path d="M584 208a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M304 224a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M6e2 224a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><path d="M416 288a16 16 0 00-16 16" fill="none" stroke="currentcolor"/><path d="M680 288a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M4e2 304a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M696 304a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><text text-anchor="middle" x="0" y="148" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="228" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="308" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="148" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="228" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="308" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="228" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="308" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="228" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="308" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="68" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="32" y="148" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="308" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="148" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="228" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="308" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="68" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="148" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="228" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="308" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="148" fill="currentcolor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="228" fill="currentcolor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="308" fill="currentcolor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="68" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="148" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="228" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="308" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="96" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="128" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="148" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="136" y="212" fill="currentcolor" style="font-size:1em">С</text><text text-anchor="middle" x="144" y="212" fill="currentcolor" style="font-size:1em">д</text><text text-anchor="middle" x="152" y="100" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="152" y="212" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="160" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="100" fill="currentcolor" style="font-size:1em">к</text><text text-anchor="middle" x="160" y="148" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="160" y="212" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="168" y="100" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="168" y="212" fill="currentcolor" style="font-size:1em">г</text><text text-anchor="middle" x="176" y="100" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="184" y="100" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="192" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="192" y="100" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="192" y="148" fill="currentcolor" style="font-size:1em">X</text><text text-anchor="middle" x="200" y="100" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="208" y="100" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="216" y="100" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="216" y="356" fill="currentcolor" style="font-size:1em">С</text><text text-anchor="middle" x="224" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="224" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="224" y="100" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="224" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="356" fill="currentcolor" style="font-size:1em">к</text><text text-anchor="middle" x="232" y="100" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="232" y="356" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="240" y="100" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="240" y="356" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="248" y="356" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="256" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="256" y="68" fill="currentcolor" style="font-size:1em">X</text><text text-anchor="middle" x="256" y="148" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="356" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="264" y="356" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="272" y="356" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="280" y="356" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="288" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="68" fill="currentcolor" style="font-size:1em">F</text><text text-anchor="middle" x="288" y="116" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="288" y="148" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="288" y="356" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="296" y="356" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="304" y="356" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="320" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="320" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="320" y="116" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="320" y="148" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="320" y="228" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="356" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="328" y="356" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="336" y="356" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="344" y="356" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="352" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="352" y="68" fill="currentcolor" style="font-size:1em">E</text><text text-anchor="middle" x="352" y="116" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="352" y="148" fill="currentcolor" style="font-size:1em">E</text><text text-anchor="middle" x="352" y="228" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="356" fill="currentcolor" style="font-size:1em">к</text><text text-anchor="middle" x="360" y="356" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="376" y="356" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="384" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="384" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="228" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="392" y="356" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="400" y="356" fill="currentcolor" style="font-size:1em">л</text><text text-anchor="middle" x="408" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="408" y="356" fill="currentcolor" style="font-size:1em">г</text><text text-anchor="middle" x="416" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="68" fill="currentcolor" style="font-size:1em">E</text><text text-anchor="middle" x="416" y="228" fill="currentcolor" style="font-size:1em">X</text><text text-anchor="middle" x="416" y="308" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="416" y="356" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="424" y="356" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="432" y="356" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="440" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="440" y="356" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="448" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="448" y="228" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="448" y="308" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="448" y="356" fill="currentcolor" style="font-size:1em">м</text><text text-anchor="middle" x="456" y="356" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="472" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="472" y="356" fill="currentcolor" style="font-size:1em">Б</text><text text-anchor="middle" x="480" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="480" y="68" fill="currentcolor" style="font-size:1em">X</text><text text-anchor="middle" x="480" y="228" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="480" y="308" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="480" y="356" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="488" y="356" fill="currentcolor" style="font-size:1em">й</text><text text-anchor="middle" x="496" y="356" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="504" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="504" y="356" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="512" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="512" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="512" y="228" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="512" y="276" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="512" y="308" fill="currentcolor" style="font-size:1em">X</text><text text-anchor="middle" x="512" y="356" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="520" y="356" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="528" y="356" fill="currentcolor" style="font-size:1em">М</text><text text-anchor="middle" x="536" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="536" y="356" fill="currentcolor" style="font-size:1em">у</text><text text-anchor="middle" x="544" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="544" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="544" y="228" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="544" y="276" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="544" y="308" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="544" y="356" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="552" y="356" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="568" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="576" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="576" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="576" y="196" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="576" y="228" fill="currentcolor" style="font-size:1em">E</text><text text-anchor="middle" x="576" y="276" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="576" y="308" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="600" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="608" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="608" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="608" y="276" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="608" y="308" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="632" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="640" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="640" y="276" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="640" y="308" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="664" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="672" y="68" fill="currentcolor" style="font-size:1em">E</text><text text-anchor="middle" x="672" y="276" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="672" y="308" fill="currentcolor" style="font-size:1em">E</text><text text-anchor="middle" x="696" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="704" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="728" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="736" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="68" fill="currentcolor" style="font-size:1em">C</text></g></svg></div><p>В двустороннем алгоритме строка шаблона делится на 2 подстроки: $u$ и $v$. Сначала
сравнивается правая подстрока $v$ слева направо, затем, если все символы правой подстроки
совпали, то сравнивается левая подстрока $u$ справа налево. Если встречается несовпадающий
символ, то шаблон сдвигается вправо на некоторое количество позиций. Правила сдвигов при
несовпадении разные для правой и левой части разбиения. Величина сдвига вычисляется за
константное время и константную память.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 441"><g transform="translate(8,16)"><path d="M80 0h32" fill="none" stroke="currentcolor"/><path d="M112 0h32" fill="none" stroke="currentcolor"/><path d="M144 0h32" fill="none" stroke="currentcolor"/><path d="M176 0h32" fill="none" stroke="currentcolor"/><path d="M208 0h32" fill="none" stroke="currentcolor"/><path d="M240 0h32" fill="none" stroke="currentcolor"/><path d="M272 0h32" fill="none" stroke="currentcolor"/><path d="M304 0h32" fill="none" stroke="currentcolor"/><path d="M336 0h32" fill="none" stroke="currentcolor"/><path d="M368 0h32" fill="none" stroke="currentcolor"/><path d="M4e2.0h32" fill="none" stroke="currentcolor"/><path d="M432 0h32" fill="none" stroke="currentcolor"/><path d="M464 0h32" fill="none" stroke="currentcolor"/><path d="M496 0h32" fill="none" stroke="currentcolor"/><path d="M528 0h32" fill="none" stroke="currentcolor"/><path d="M560 0h32" fill="none" stroke="currentcolor"/><path d="M592 0h32" fill="none" stroke="currentcolor"/><path d="M624 0h32" fill="none" stroke="currentcolor"/><path d="M656 0h32" fill="none" stroke="currentcolor"/><path d="M688 0h32" fill="none" stroke="currentcolor"/><path d="M720 0h32" fill="none" stroke="currentcolor"/><path d="M80 48H752" fill="none" stroke="currentcolor"/><path d="M80 80H752" fill="none" stroke="currentcolor"/><path d="M88 128h80" fill="none" stroke="currentcolor"/><path d="M184 128H312" fill="none" stroke="currentcolor"/><path d="M96 160H296" fill="none" stroke="currentcolor"/><path d="M96 192h80" fill="none" stroke="currentcolor"/><path d="M176 192H296" fill="none" stroke="currentcolor"/><path d="M192 240H392" fill="none" stroke="currentcolor"/><path d="M96 256h72" fill="none" stroke="currentcolor"/><path d="M192 272h80" fill="none" stroke="currentcolor"/><path d="M272 272H392" fill="none" stroke="currentcolor"/><path d="M352 320H552" fill="none" stroke="currentcolor"/><path d="M352 352h80" fill="none" stroke="currentcolor"/><path d="M432 352H552" fill="none" stroke="currentcolor"/><path d="M80 0V16" fill="none" stroke="currentcolor"/><path d="M80 48V80" fill="none" stroke="currentcolor"/><path d="M96 192v64" fill="none" stroke="currentcolor"/><path d="M112 0V16" fill="none" stroke="currentcolor"/><path d="M144 0V16" fill="none" stroke="currentcolor"/><path d="M176 0V16" fill="none" stroke="currentcolor"/><path d="M176 176v16" fill="none" stroke="currentcolor"/><path d="M208 0V16" fill="none" stroke="currentcolor"/><path d="M240 0V16" fill="none" stroke="currentcolor"/><path d="M272 0V16" fill="none" stroke="currentcolor"/><path d="M272 256v16" fill="none" stroke="currentcolor"/><path d="M304 0V16" fill="none" stroke="currentcolor"/><path d="M336 0V16" fill="none" stroke="currentcolor"/><path d="M368 0V16" fill="none" stroke="currentcolor"/><path d="M4e2.0V16" fill="none" stroke="currentcolor"/><path d="M432 0V16" fill="none" stroke="currentcolor"/><path d="M432 336v16" fill="none" stroke="currentcolor"/><path d="M464 0V16" fill="none" stroke="currentcolor"/><path d="M496 0V16" fill="none" stroke="currentcolor"/><path d="M528 0V16" fill="none" stroke="currentcolor"/><path d="M560 0V16" fill="none" stroke="currentcolor"/><path d="M592 0V16" fill="none" stroke="currentcolor"/><path d="M624 0V16" fill="none" stroke="currentcolor"/><path d="M656 0V16" fill="none" stroke="currentcolor"/><path d="M688 0V16" fill="none" stroke="currentcolor"/><path d="M720 0V16" fill="none" stroke="currentcolor"/><path d="M752 0V16" fill="none" stroke="currentcolor"/><path d="M752 48V80" fill="none" stroke="currentcolor"/><path d="M176 168v8" fill="none" stroke="currentcolor"/><path d="M272 248v8" fill="none" stroke="currentcolor"/><path d="M432 328v8" fill="none" stroke="currentcolor"/><polygon points="96.000000,128.000000 84.000000,122.400002 84.000000,133.600006" fill="currentcolor" transform="rotate(180.000000, 88.000000, 128.000000)"/><polygon points="176.000000,256.000000 164.000000,250.399994 164.000000,261.600006" fill="currentcolor" transform="rotate(0.000000, 168.000000, 256.000000)"/><polygon points="320.000000,128.000000 308.000000,122.400002 308.000000,133.600006" fill="currentcolor" transform="rotate(0.000000, 312.000000, 128.000000)"/><path d="M96 160A16 16 0 0080 176" fill="none" stroke="currentcolor"/><path d="M296 160a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M80 176a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M312 176a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><path d="M192 240a16 16 0 00-16 16" fill="none" stroke="currentcolor"/><path d="M392 240a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M176 256a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M408 256a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><path d="M352 320a16 16 0 00-16 16" fill="none" stroke="currentcolor"/><path d="M552 320a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M336 336a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M568 336a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><text text-anchor="middle" x="0" y="180" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="260" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="340" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="180" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="260" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="340" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="180" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="340" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="180" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="340" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="68" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="32" y="180" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="340" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="180" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="260" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="340" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="68" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="180" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="260" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="340" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="180" fill="currentcolor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="260" fill="currentcolor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="340" fill="currentcolor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="68" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="180" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="260" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="340" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="96" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="68" fill="currentcolor" style="font-size:1em">E</text><text text-anchor="middle" x="96" y="116" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="96" y="180" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="104" y="116" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="112" y="244" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="120" y="116" fill="currentcolor" style="font-size:1em">л</text><text text-anchor="middle" x="120" y="244" fill="currentcolor" style="font-size:1em">д</text><text text-anchor="middle" x="128" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="116" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="128" y="180" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="244" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="136" y="116" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="136" y="244" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="144" y="116" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="144" y="244" fill="currentcolor" style="font-size:1em">г</text><text text-anchor="middle" x="152" y="116" fill="currentcolor" style="font-size:1em">я</text><text text-anchor="middle" x="160" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="160" y="180" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="176" y="420" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="184" y="404" fill="currentcolor" style="font-size:1em">С</text><text text-anchor="middle" x="184" y="420" fill="currentcolor" style="font-size:1em">ш</text><text text-anchor="middle" x="192" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="116" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="192" y="148" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="192" y="180" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="260" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="192" y="404" fill="currentcolor" style="font-size:1em">к</text><text text-anchor="middle" x="192" y="420" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="200" y="116" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="200" y="404" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="200" y="420" fill="currentcolor" style="font-size:1em">б</text><text text-anchor="middle" x="208" y="404" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="208" y="420" fill="currentcolor" style="font-size:1em">л</text><text text-anchor="middle" x="216" y="116" fill="currentcolor" style="font-size:1em">п</text><text text-anchor="middle" x="216" y="404" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="216" y="420" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="224" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="224" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="116" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="224" y="148" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="180" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="228" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="224" y="260" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="224" y="404" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="224" y="420" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="232" y="116" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="232" y="404" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="240" y="116" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="240" y="404" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="240" y="420" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="248" y="116" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="248" y="404" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="248" y="420" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="256" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="116" fill="currentcolor" style="font-size:1em">я</text><text text-anchor="middle" x="256" y="148" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="256" y="180" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="228" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="256" y="260" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="404" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="256" y="420" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="264" y="404" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="264" y="420" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="272" y="116" fill="currentcolor" style="font-size:1em">ч</text><text text-anchor="middle" x="272" y="404" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="272" y="420" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="280" y="116" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="280" y="420" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="288" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="116" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="288" y="180" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="228" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="288" y="260" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="404" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="288" y="420" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="296" y="116" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="296" y="404" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="304" y="116" fill="currentcolor" style="font-size:1em">ь</text><text text-anchor="middle" x="304" y="404" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="304" y="420" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="312" y="404" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="312" y="420" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="320" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="320" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="228" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="320" y="260" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="404" fill="currentcolor" style="font-size:1em">к</text><text text-anchor="middle" x="320" y="420" fill="currentcolor" style="font-size:1em">з</text><text text-anchor="middle" x="328" y="404" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="328" y="420" fill="currentcolor" style="font-size:1em">б</text><text text-anchor="middle" x="336" y="420" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="344" y="404" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="344" y="420" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="352" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="352" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="228" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="352" y="260" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="340" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="360" y="404" fill="currentcolor" style="font-size:1em">д</text><text text-anchor="middle" x="360" y="420" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="368" y="404" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="368" y="420" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="376" y="404" fill="currentcolor" style="font-size:1em">у</text><text text-anchor="middle" x="384" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="384" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="228" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="384" y="260" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="340" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="384" y="404" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="384" y="420" fill="currentcolor" style="font-size:1em">п</text><text text-anchor="middle" x="392" y="404" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="392" y="420" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="400" y="404" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="400" y="420" fill="currentcolor" style="font-size:1em">д</text><text text-anchor="middle" x="408" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="408" y="404" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="408" y="420" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="416" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="416" y="340" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="416" y="404" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="416" y="420" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="424" y="404" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="424" y="420" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="432" y="404" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="432" y="420" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="440" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="440" y="404" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="440" y="420" fill="currentcolor" style="font-size:1em">к</text><text text-anchor="middle" x="448" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="448" y="308" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="448" y="340" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="448" y="404" fill="currentcolor" style="font-size:1em">м</text><text text-anchor="middle" x="448" y="420" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="464" y="404" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="464" y="420" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="472" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="472" y="404" fill="currentcolor" style="font-size:1em">л</text><text text-anchor="middle" x="472" y="420" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="480" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="480" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="480" y="340" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="480" y="404" fill="currentcolor" style="font-size:1em">г</text><text text-anchor="middle" x="480" y="420" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="488" y="404" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="488" y="420" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="496" y="404" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="496" y="420" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="504" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="504" y="404" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="504" y="420" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="512" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="512" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="512" y="340" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="512" y="404" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="512" y="420" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="520" y="404" fill="currentcolor" style="font-size:1em">м</text><text text-anchor="middle" x="520" y="420" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="528" y="404" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="528" y="420" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="536" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="536" y="420" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="544" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="544" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="544" y="340" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="544" y="420" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="552" y="420" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="568" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="576" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="576" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="600" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="608" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="608" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="632" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="640" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="664" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="672" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="696" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="704" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="728" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="736" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="68" fill="currentcolor" style="font-size:1em">D</text></g></svg></div><p>Общую схему для сканирования можно представить следующим псевдокодом:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>fun</span> stringMatching(text, pattern): Boolean {
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> n = text.length
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> m = pattern.length
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> <span>(</span>u, v) = factorize(pattern)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> pos = 0, i = u.length
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> (pos &lt;= n-m) {
</span></span><span style=display:flex><span>        <span style=color:green>// Сравнение правой части
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>while</span> (i &lt; m &amp;&amp; pattern[i] == text[pos + i]) i += 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> (i == m) {
</span></span><span style=display:flex><span>            <span style=color:green>// Сравнение левой части
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>if</span> (text.substring(pos .. pos + u.lastIndex) == u) {
</span></span><span style=display:flex><span>                <span style=color:#00f>return</span> <span style=color:#00f>true</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        (pos, i) = shift(pos, i)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#00f>false</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>factorize()</code> — функция разбиения шаблона на 2 подстроки.
Двусторонний алгоритм использует разбиение шаблона на подстроки, называемый <em>критическим
разбиением</em> (<em>Critical Factorization</em>) и базируется на <em>теореме о критическом разбиении</em>
(<em>Critical Factorization Theorem</em>).<br><code>shift()</code> — правила сдвигов.
Двусторонний алгоритм выбирает разбиение строки ${x = uv}$, такое, что длина левой
подстроки $u$ меньше глобального периода строки шаблона (${|u| &lt; per(x)}$), длина $u$
минимальна, а правая подстрока $v$ периодична.</p><blockquote class=book-hint><p>Есть также другой алгоритм, относящийся к алгоритмам с ограниченным потреблением памяти и
работающий по такой же схеме — это алгоритм Галиля — Сейфераса (Galil - Seiferas)
<a href=#reference_text_algorithms>[1]</a>, <a href=#reference_galil_seiferas>[4]</a>. В нем используется
разбиение, называемое <em>идеальным разбиением</em> (<em>perfect factorization</em>). Выбирается
позиция, где начинается наиболее часто повторяющаяся подстрока шаблона.</p></blockquote><h2 id=базовые-понятия>Базовые понятия
<a class=anchor href=#%d0%b1%d0%b0%d0%b7%d0%be%d0%b2%d1%8b%d0%b5-%d0%bf%d0%be%d0%bd%d1%8f%d1%82%d0%b8%d1%8f>#</a></h2><p>Зададим некоторые связанные со строками базовые определения, которые понадобятся в
описании алгоритма.</p><dl><dt><strong>Алфавит</strong></dt><dd><p><em><strong>Алфавит</strong></em> (<em>alphabet</em>) — это конечное непустое множество символов. Обозначим его через
$A$. Примеры наиболее часто используемых алфавитов:</p><ul><li>${A = \{\text{a,b,…, z}\}}$ — множество строчных букв английского алфавита</li><li>${A = \{\text{0,1,2,3,4,5,6,7,8,9}\}}$ — множество цифр</li><li>${A = \{\text{0,1}\}}$: бинарный алфавит</li></ul><p>и т.п.</p></dd><dt><strong>Строка</strong></dt><dd><p><em><strong>Строка</strong></em> (<em><strong>текст</strong></em>, <em><strong>слово</strong></em>) (<em>string</em>, <em>text</em>, <em>word</em>) — конечная последовательность символов из
некоторого алфавита $A$. Длина строки — это количество элементов в последовательности.
Например, длина строки &ldquo;${\tt{ABCDEF}}$&rdquo; равна 6.</p><p>Введем следующие обозначения для некоторый строки $x$:</p><p>${|x|}$ ­— длина строки $x$.<br>${x[i]}$ — ${(i+1)}$-ый символ строки (считаем, что первый символ находится по индексу 0).<br>${x[i…j]}$ — подстрока ${x[i]x[i+1]…x[j]}$ строки $x$.</p></dd></dl><p>Пустую строку обозначим через $ε$. Множество всех последовательностей алфавита $A$ —
через ${A^{*}}$, а множество всех непустых строк — через ${A^{+}}$.</p><dl><dt><strong>Подстрока</strong></dt><dd><p>Строка $x$ длины $n$ является <em><strong>подстрокой</strong></em> (или <em><strong>фактором</strong></em>) (<em>factor</em>,
<em>subword</em>) строки $y$, если ${x=y[i … i+n-1]}$ для некоторого целого $i$. Мы можем
говорить, что подстрока $x$ встречается в строке $y$ в позиции $i$. Стоит отметить, что
подстрока — это не то же самое, что и <em>подпоследовательность</em>.<br>Строка $x$ является <em><strong>подпоследовательностью</strong></em> (<em>subsequence</em>) строки $y$, если она может
быть получена удалением из $y$ нуля или более (не обязательно смежных) символов. Другими
словами, если ${x=y[i₁]y[i₂]…y[i_m]}$, где ${i₁, i₂, i_m}$ — увеличивающаяся
последовательность индексов строки $y$.</p></dd><dt><strong>Операции над строками</strong></dt><dd><p><em><strong>Конкатенацией</strong></em> двух строк $x$ и $y$ называют строку с последовательной записью их
символов. Обозначим конкатенацию строк $x$ и $y$ как $xy$. Например, если
${x=\texttt{AB}, y=\texttt{CD}}$, то ${xy=\tt{ABCD}}$.<br>Через ${k^x}$ обозначим конкатенацию $k$ копий строки $x$. Например, для ${x=\tt{AB}}$,
${x⁴=\tt{\underlinesegment{AB}\underlinesegment{AB}\underlinesegment{AB}\underlinesegment{AB}}}$.
Стоит отметить, что конкатенация ассоциативна, т.е. ${(xy)z = x(yz)}$, поэтому скобки здесь не
обязательны и выражение можно записать как ${xyz}$.</p></dd></dl><p>Рассмотрим строку ${x = uvw}$, представляющую из себя композицию из 3 подстрок: $u$, $v$ и
$w$. Подстроки $u$, $v$ и $w$ называются <em>факторами</em>
строки $x$. Кроме того:<br>$u$ — это <em>префикс</em> строки $x$,<br>$w$ — это <em>суффикс</em> строки $x$.</p><dl><dt><strong>Префикс</strong></dt><dd><p>Строка $u$ называется <em><strong>префиксом</strong></em> (<em>prefix</em>) строки $x$, если существует такая строка $v$, что
${x=uv}$. Например, ${\tt ABC}$ — это префикс строки ${\tt \underlinesegment{ABC}DAB}$.
Префикс можно рассматривать как особый случай подстроки. Обычный префикс может быть как
пустой строкой (ε), так и всей строкой.<br><em><strong>Собственный префикс</strong></em> (<em>proper prefix</em>) — это префикс с дополнительными ограничениями:
он не может быть пустым и не может быть равен всей строке целиком.</p></dd><dt><strong>Суффикс</strong></dt><dd><p>Строка $w$ называется <em><strong>суффиксом</strong></em> (<em>suffix</em>) строки $x$, если существует такая строка $v$, что
${x=vw}$ Например, ${\tt DAB}$ — суффикс строки ${\tt ABC\underlinesegment{DAB}}$.
Также, как и в случае с префиксом, обычный суффикс может быть как пустым, так и всей
строкой.<br><em><strong>Собственный суффикс</strong></em> (<em>proper suffix</em>) — это суффикс, который не может быть
равен пустой строке и всей строке целиком.</p></dd><dt><strong>Период</strong></dt><dd><p><em><strong>Период</strong></em> (<em>period</em>) строки $x$ — это целое число $p$, ${1&lt;p≤|x|}$ такое, что
${∀i∈\{0,1,…|x|-p-1\}x[i]=x[i+p]}$<br>Проще говоря, это длина постоянно повторяющегося фрагмента текста, причем,
последнее вхождение может быть &ldquo;обрезано&rdquo;. Например, строка ${\tt{AABAAABAA}}$ (её длина
равна 9), имеет периоды 4, 7, 8 и 9:</p><p>$\begin{aligned}
& \tt{\large{\underbrace{AABA}_4\underbrace{AABA}\underbrace{A\phantom{ABA}}}} \\
& \tt{\large{\underbrace{AABAAAB}_7\underbrace{AA\phantom{BAAAB}}}} \\
& \tt{\large{\underbrace{AABAAABA}_8\underbrace{A\phantom{ABAAABA}}}} \\
& \tt{\large{\underbrace{AABAAABAA}_9}}
\end{aligned}$</p></dd></dl><p>Отметим, что длина строки всегда является её периодом, а это значит, что любой строки
всегда есть хотя бы один период.<br>Обозначим <em><strong>наименьший период</strong></em> строки $x$ через ${per(x)}$ (численное значение), а саму
подстроку наименьшего периода — через ${period(x)}$.</p><p>Возьмем непустую строку $x$ и какое-то число $p$ такое, что ${0&lt;p≤|x|}$. Во всех следующих
случаях $p$ будет периодом строки $x$:</p><ol><li><p>Если $x$ — это подстрока некоторой строки ${y^k}$, где ${|y|=p}$ и ${k>0}$.<br><strong>Пример</strong><br>${y^k=\underbrace{\texttt{ABC}}_y\underbrace{\tt{ABC}}_y\underbrace{\texttt{ABC}}_y\underbrace{\texttt{ABC}}_y}
\qquad y=\texttt{ABC} \quad {p=3} \quad {k=4} $<br>Если взять за $x$ любой префикс или подстроку (фактор) строки ${y^k}$, то один из её
периодов будет тоже 3.</p></li><li><p>Если строку $x$ можно представить как ${(uv)^ku}$, где ${|uv|=p}$, строка $v$ — непустая и ${k>0}$<br><strong>Пример</strong><br>${x = \underbrace{\texttt{ABC}}_u\underbrace{\texttt{DEFG}}_v\underbrace{\texttt{ABC}}_u\underbrace{\texttt{DEFG}}_v\underbrace{\texttt{ABC}}_u}$<br>${u=\texttt{ABC}}, \space {v=\texttt{DEFG}}$<br>${x=(uv)²u}$<br>${|uv|=7}, \space {p=7}$</p></li><li><p>Возьмем некоторые строки $y$, $z$ равной длины и строку $w$, такие, что
${x=yw=wz}$; ${|y|=|z|}$. В этом случае длина $y$ и $z$ будет периодом строки
$x$: ${|y|=|z|=p}$.<br><strong>Пример</strong><br>${x=\mathrlap{
\overbrace{\phantom{\mathtt{ABCDAB}}}^w
\overbrace{\phantom{\mathtt{ABCD}}}^z
} \underbrace{\mathtt{ABCD}}_y\underbrace{\mathtt{ABCDAB}}_w
}$<br>${y=\tt ABCD}$<br>${z=\tt CDAB}$<br>${w=\tt ABCDAB}$<br>${p=|y|=|z|=4}$</p></li></ol><dl><dt><strong>Грань</strong></dt><dd><p><strong>Грань</strong> (также <strong>граница</strong> или <strong>бордер</strong>) (<em>border</em>) строки $x$ — это любой
собственный префикс строки, который равен её суффиксу. Т.е. грань — это такая строка
$w$, что ${x=yw=wz}$. Грань не может быть равна всей строке, но суффикс и префикс строки
могут быть перекрывающимися.
Например, грани строки ${\tt AABAAABAA}$: ${\tt AABAA, AA, A, ε}$.</p><p>Обозначим <em><strong>наибольшую грань</strong></em> строки $x$ через ${Border(x)}$. Мы можем рассматривать такую грань
как наибольшее совпадающее пересечение при наложении строки самой на себя.<br>Строка $x$ <em><strong>свободна от граней</strong></em> (<em>border free</em>), если наибольшая грань строки — это пустая
строка, или другими словами, если наименьший период равен длине строки (${per(x)=|x|}$)<br>Между гранями и периодами имеется взаимно однозначное соответствие, это можно увидеть по
пункту 3 из описания периода.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 928 121"><g transform="translate(8,16)"><path d="M16 0H152" fill="none" stroke="currentcolor"/><path d="M152 0H456" fill="none" stroke="currentcolor"/><path d="M16 32H152" fill="none" stroke="currentcolor"/><path d="M152 32H456" fill="none" stroke="currentcolor"/><path d="M32 48H136" fill="none" stroke="currentcolor"/><path d="M152 64H456" fill="none" stroke="currentcolor"/><path d="M456 64H592" fill="none" stroke="currentcolor"/><path d="M152 96H456" fill="none" stroke="currentcolor"/><path d="M456 96H592" fill="none" stroke="currentcolor"/><path d="M16 0V32" fill="none" stroke="currentcolor"/><path d="M152 0V32" fill="none" stroke="currentcolor"/><path d="M152 32V64" fill="none" stroke="currentcolor"/><path d="M152 64V96" fill="none" stroke="currentcolor"/><path d="M456 0V32" fill="none" stroke="currentcolor"/><path d="M456 32V48" fill="none" stroke="currentcolor"/><path d="M456 48V64" fill="none" stroke="currentcolor"/><path d="M456 64V96" fill="none" stroke="currentcolor"/><path d="M592 64V96" fill="none" stroke="currentcolor"/><polygon points="40.000000,48.000000 28.000000,42.400002 28.000000,53.599998" fill="currentcolor" transform="rotate(180.000000, 32.000000, 48.000000)"/><polygon points="144.000000,48.000000 132.000000,42.400002 132.000000,53.599998" fill="currentcolor" transform="rotate(0.000000, 136.000000, 48.000000)"/><text text-anchor="middle" x="0" y="20" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="56" y="68" fill="currentcolor" style="font-size:1em">П</text><text text-anchor="middle" x="64" y="68" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="72" y="68" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="80" y="68" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="88" y="68" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="96" y="68" fill="currentcolor" style="font-size:1em">д</text><text text-anchor="middle" x="112" y="68" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="136" y="84" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="256" y="20" fill="currentcolor" style="font-size:1em">Г</text><text text-anchor="middle" x="256" y="84" fill="currentcolor" style="font-size:1em">Г</text><text text-anchor="middle" x="264" y="20" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="264" y="84" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="272" y="20" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="272" y="84" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="280" y="20" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="280" y="84" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="288" y="20" fill="currentcolor" style="font-size:1em">ь</text><text text-anchor="middle" x="288" y="84" fill="currentcolor" style="font-size:1em">ь</text><text text-anchor="middle" x="304" y="20" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="304" y="84" fill="currentcolor" style="font-size:1em">x</text></g></svg></div></dd></dl><h2 id=описание-алгоритма>Описание алгоритма
<a class=anchor href=#%d0%be%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc%d0%b0>#</a></h2><p>Пусть $x$ — непустая строка, а ${uv}$ — разбиение $x$. Обозначим через $l$ длину левой части
разбиения минус 1 (${l = |u| - 1}$). ${0≤l&lt;|x|}$.<br>Непустая строка $w$ называется <em><strong>повторением для разбиения $\textit{\textbf{uv}}$</strong></em>
(<em>repetition for factorization</em>) или <em><strong>повторением в позиции $\textit{\textbf{l}}$ строки
$\textit{\textbf{x}}$</strong></em>, если выполняются оба условия:</p><ul><li>$w$ — суффикс $u$ или $u$ — суффикс $w$</li><li>$w$ — префикс $v$ или $v$ — префикс $w$</li></ul><p>Базовый случай повторения ($w$ — суффикс $u$ и $w$ — префикс $v$) — это когда разбиение
между $u$ и $v$ — это центр квадрата где-то в строке $x$:</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 233"><g transform="translate(8,16)"><path d="M48 0H80" fill="none" stroke="currentcolor"/><path d="M80 0h32" fill="none" stroke="currentcolor"/><path d="M112 0h32" fill="none" stroke="currentcolor"/><path d="M144 0h32" fill="none" stroke="currentcolor"/><path d="M176 0h32" fill="none" stroke="currentcolor"/><path d="M208 0h32" fill="none" stroke="currentcolor"/><path d="M240 0h32" fill="none" stroke="currentcolor"/><path d="M272 0h32" fill="none" stroke="currentcolor"/><path d="M304 0h32" fill="none" stroke="currentcolor"/><path d="M336 0h32" fill="none" stroke="currentcolor"/><path d="M368 0h32" fill="none" stroke="currentcolor"/><path d="M4e2.0h32" fill="none" stroke="currentcolor"/><path d="M432 0h32" fill="none" stroke="currentcolor"/><path d="M464 0h32" fill="none" stroke="currentcolor"/><path d="M496 0h32" fill="none" stroke="currentcolor"/><path d="M528 0h32" fill="none" stroke="currentcolor"/><path d="M560 0h32" fill="none" stroke="currentcolor"/><path d="M592 0h32" fill="none" stroke="currentcolor"/><path d="M624 0h32" fill="none" stroke="currentcolor"/><path d="M656 0h32" fill="none" stroke="currentcolor"/><path d="M688 0h32" fill="none" stroke="currentcolor"/><path d="M48 48H208" fill="none" stroke="currentcolor"/><path d="M208 48h32" fill="none" stroke="currentcolor"/><path d="M240 48h96" fill="none" stroke="currentcolor"/><path d="M336 48h32" fill="none" stroke="currentcolor"/><path d="M368 48H496" fill="none" stroke="currentcolor"/><path d="M496 48h24" fill="none" stroke="currentcolor"/><path d="M520 48H712" fill="none" stroke="currentcolor"/><path d="M48 80H208" fill="none" stroke="currentcolor"/><path d="M208 80h32" fill="none" stroke="currentcolor"/><path d="M240 80h96" fill="none" stroke="currentcolor"/><path d="M336 80h32" fill="none" stroke="currentcolor"/><path d="M368 80H496" fill="none" stroke="currentcolor"/><path d="M496 80h24" fill="none" stroke="currentcolor"/><path d="M520 80H712" fill="none" stroke="currentcolor"/><path d="M208 128H368" fill="none" stroke="currentcolor"/><path d="M368 128H520" fill="none" stroke="currentcolor"/><path d="M208 160H368" fill="none" stroke="currentcolor"/><path d="M368 160H520" fill="none" stroke="currentcolor"/><path d="M64 192H360" fill="none" stroke="currentcolor"/><path d="M376 192H704" fill="none" stroke="currentcolor"/><path d="M48 0V16" fill="none" stroke="currentcolor"/><path d="M48 48V80" fill="none" stroke="currentcolor"/><path d="M80 0V16" fill="none" stroke="currentcolor"/><path d="M112 0V16" fill="none" stroke="currentcolor"/><path d="M144 0V16" fill="none" stroke="currentcolor"/><path d="M176 0V16" fill="none" stroke="currentcolor"/><path d="M208 0V16" fill="none" stroke="currentcolor"/><path d="M208 48V80" fill="none" stroke="currentcolor"/><path d="M208 80v48" fill="none" stroke="currentcolor"/><path d="M208 128v32" fill="none" stroke="currentcolor"/><path d="M240 0V16" fill="none" stroke="currentcolor"/><path d="M240 48V80" fill="none" stroke="currentcolor"/><path d="M272 0V16" fill="none" stroke="currentcolor"/><path d="M304 0V16" fill="none" stroke="currentcolor"/><path d="M336 0V16" fill="none" stroke="currentcolor"/><path d="M336 48V80" fill="none" stroke="currentcolor"/><path d="M368 0V16" fill="none" stroke="currentcolor"/><path d="M368 48V80" fill="none" stroke="currentcolor"/><path d="M368 128v32" fill="none" stroke="currentcolor"/><path d="M4e2.0V16" fill="none" stroke="currentcolor"/><path d="M432 0V16" fill="none" stroke="currentcolor"/><path d="M464 0V16" fill="none" stroke="currentcolor"/><path d="M496 0V16" fill="none" stroke="currentcolor"/><path d="M496 48V80" fill="none" stroke="currentcolor"/><path d="M520 48V80" fill="none" stroke="currentcolor"/><path d="M520 80v48" fill="none" stroke="currentcolor"/><path d="M520 128v32" fill="none" stroke="currentcolor"/><path d="M528 0V16" fill="none" stroke="currentcolor"/><path d="M560 0V16" fill="none" stroke="currentcolor"/><path d="M592 0V16" fill="none" stroke="currentcolor"/><path d="M624 0V16" fill="none" stroke="currentcolor"/><path d="M656 0V16" fill="none" stroke="currentcolor"/><path d="M688 0V16" fill="none" stroke="currentcolor"/><path d="M712 48V80" fill="none" stroke="currentcolor"/><path d="M720 0V16" fill="none" stroke="currentcolor"/><polygon points="72.000000,192.000000 60.000000,186.399994 60.000000,197.600006" fill="currentcolor" transform="rotate(180.000000, 64.000000, 192.000000)"/><polygon points="368.000000,192.000000 356.000000,186.399994 356.000000,197.600006" fill="currentcolor" transform="rotate(0.000000, 360.000000, 192.000000)"/><polygon points="384.000000,192.000000 372.000000,186.399994 372.000000,197.600006" fill="currentcolor" transform="rotate(180.000000, 376.000000, 192.000000)"/><polygon points="712.000000,192.000000 700.000000,186.399994 700.000000,197.600006" fill="currentcolor" transform="rotate(0.000000, 704.000000, 192.000000)"/><text text-anchor="middle" x="32" y="68" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="64" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="200" y="212" fill="currentcolor" style="font-size:1em">𝒖</text><text text-anchor="middle" x="216" y="100" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="224" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="224" y="100" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="232" y="100" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="256" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="288" y="148" fill="currentcolor" style="font-size:1em">𝒘</text><text text-anchor="middle" x="320" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="344" y="100" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="352" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="376" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="384" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="408" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="416" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="440" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="440" y="148" fill="currentcolor" style="font-size:1em">𝒘</text><text text-anchor="middle" x="448" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="472" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="480" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="496" y="100" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="504" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="504" y="100" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="512" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="512" y="100" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="536" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="536" y="212" fill="currentcolor" style="font-size:1em">𝒗</text><text text-anchor="middle" x="544" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="568" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="576" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="600" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="608" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="632" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="664" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="696" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="704" y="20" fill="currentcolor" style="font-size:1em">0</text></g></svg></div><p>Другие случаи соответствуют ситуациям, когда $l$ находится близко к краям строки или при
переполнении $w$. Стоит заметить, что если есть строка ${x=uv}$, а в качестве $w$ взять
строку $vu$, то эта строка $w$ будет повторением для разбиения $uv$ (выполнятся оба
условия). Т.е. любое разбиение непустой строки $x$ всегда имеет хотя бы одно повторение.</p><p>Длина $r$ повторения для разбиения $uv$ называется <em><strong>локальным периодом
$\textit{\textbf{uv}}$</strong></em> или <em><strong>локальным периодом строки $\textit{\textbf{x}}$ в позиции
$\textit{\textbf{l}}$</strong></em>.
Другими словами, число $r$ является локальным периодом строки $x$ в позиции $l$, если
${x[i]=x[i+r]}$ для всех индексов ${l-r+1≤i≤l}$ и выполняются оба условия повторения.</p><p><em><strong>Наименьшее возможное значение</strong></em> локального периода для разбиения ${uv}$ обозначается как
${r(u,v)}$.</p><p><strong>Примеры</strong></p><p>Пусть строка ${x=\texttt{ABAABAA}}$.</p><p>Рассмотрим наименьший локальный период в позиции ${l=2}$:</p><p>${
\gdef\string_idx#1{\color{aaaaaa} \tt #1}
\mathrlap{
\overbrace{\phantom{
\def\arraystretch{1.3}\begin{array}{c c c} \string_idx{0} & \string_idx{1} & \tt 2 \\
\tt A & \tt B & \tt A
\end{array}
}
\hspace{0.4em}
}^u
\overbrace{\phantom{
\def\arraystretch{1.3}\begin{array}{c c c} \string_idx{3} & \string_idx{4} & \string_idx{5}
\\ A & B & A
\end{array}
}
\hspace{1.3em}
}^v
} \def\arraystretch{1.3}\begin{array}{c:c:c|c:c:c:c} \tt
\string_idx{0} & \string_idx{1} & \tt 2 & \string_idx{3} & \string_idx{4} & \string_idx{5} & \string_idx{6} \\ \hdashline
\tt A & \tt B & \tt \underlinesegment{A} & \tt \underlinesegment{A} & \tt B & \tt A &
\tt A
\end{array}}
$</p><p>$r(\texttt{ABA}, \texttt{ABAA}) = |\texttt{A}| = 1$,<br>наименьшее повторение $w=\texttt{A}$.</p><p>Рассмотрим наименьший локальный период в позиции ${l=1}$:</p><p>${
\mathrlap{
\underbrace{
\hspace{1.05em}
\phantom{
\def\arraystretch{1.3}\begin{array}{c c}
\string_idx{0} & 1 \\
\tt A & \tt B
\end{array}
}
}_w
\underbrace{
\phantom{
\def\arraystretch{1.3}\begin{array}{c c c}
\string_idx{2} \string_idx{3} \string_idx{4} \\
\tt A & \tt A \tt B
\end{array}
}
}_w
} \hspace{1em}
\def\arraystretch{1.3}\begin{array}{c:c|c:c:c:c:c}
\string_idx{0} & 1 & \string_idx{2} & \string_idx{3} & \string_idx{4} &
\string_idx{5} & \string_idx{6} \\
\hdashline
\tt A & \tt B & \tt A & \tt A & \tt B & \tt A & \tt A
\end{array}
}$</p><p>${r(\texttt{AB}, \texttt{AABAA}) = |\texttt{AAB}| = 3}$,<br>наименьшее повторение ${w=\texttt{AAB}}$.</p><p>Пусть строка ${x=\tt AABABAB}$</p><p>Рассмотрим наименьший локальный период в позиции ${l=5}$:</p><p>${ \mathrlap{
\hphantom{
\def\arraystretch{1.3}\begin{array}{c c c c}
\string_idx{0} & \string_idx{1} & \string_idx{2} & \string_idx{3}
\end{array}
}
\underbrace{
\phantom{
\def\arraystretch{1.3}\begin{array}{c c}
\string_idx{4} \\
\tt B & \tt \hspace{0.6em}
\end{array}
}
}_w
\underbrace{
\phantom{
\def\arraystretch{1.3}\begin{array}{c}
\string_idx{6} \\
\tt B
\end{array}
\hspace{0.6em}
}
}_w
} \def\arraystretch{1.3}\begin{array}{c:c:c:c:c:c|c}
\string_idx{0} & \string_idx{1} & \string_idx{2} & \string_idx{3} & \string_idx{4} &
\texttt{5} & \string_idx{6} \\
\hdashline
\tt A & \tt A & \tt B & \tt A & \tt B & \tt A & \tt B
\end{array}
}$</p><p>${r(\texttt{AABABA}, \texttt{B}) = |\texttt{BA}| = 2}$,<br>наименьшее повторение ${w=\texttt{BA}}$.</p><p>Рассмотрим наименьший локальный период позиции ${l=1}$:</p><p>${ \mathrlap{
\underbrace{
\phantom{
\def\arraystretch{1.3}\begin{array}{c c c c c}
\string_idx{3} \string_idx{2} \string_idx{1} \string_idx{0} 1 \\
\tt B & \tt A & \tt B & \tt A & \tt A
\end{array}
}
}_w
\underbrace{
\phantom{
\def\arraystretch{1.3}\begin{array}{c c c c c}
\string_idx{2} \string_idx{3} \string_idx{4} \string_idx{5} \string_idx{6}\\
\tt B & \tt A & \tt B & \tt A & \tt B
\end{array}
}
}_w
} \hspace{6.6em}
\def\arraystretch{1.3}\begin{array}{c:c|c:c:c:c:c}
\string_idx{0} & 1 & \string_idx{2} & \string_idx{3} & \string_idx{4} &
\string_idx{5} & \string_idx{6} \\
\hdashline
\tt A & \tt A & \tt B & \tt A & \tt B & \tt A & \tt B
\end{array}
}$</p><p>${r(\texttt{AA}, \texttt{BABAB}) = |\tt BABABAA| = 7}$,<br>наименьшее повторение ${w=\texttt{BABABAA}}$.</p><p>Наименьший локальный период разбиения ${x=uv}$ не может быть больше глобального
периода строки: ${1≤r(u,v)≤v}$, это следует из определений.</p><p>Разбиение ${x=uv}$, при котором наименьший локальный период равен глобальному периоду всей
строки ${r(u,v)=per(x)}$ называется <em><strong>критическим разбиением</strong></em> (<em>critical
factorization</em>), а позиция ${l=|u|-1}$ — <em><strong>критической позицией $\textit{\textbf{x}}$</strong></em> (<em>critical position</em>).</p><p><strong>Пример</strong></p><p>Пусть ${x=\tt \underlinesegment{AABABAB}AAB}$.<br>Глобальный период строки $x$: 7 (${\tt AABABAB}$)<br>Локальные периоды для каждой позиции разбиения показаны в следующей таблице:</p><p>${\def\arraystretch{1.3}\begin{array}{r|c:c:c:c:c:c:c:c:c:c}
\text{Строка} & \tt A & \tt A & \tt B & \tt A & \tt B & \tt A & \tt B & \tt A & \tt A
& \tt B \\ \hdashline
\text{Позиция разбиения }l & 0 & 1 & 2 & 3 & 4 & 5 & 6 &
7 & 8 & 9 \\ \hdashline
\text{Лок. период }r(u,v) & 1 & \underline{7} & 2 & 2 & 2 & 2 & \underline{7} & 1 & 3 & 1
\end{array}
}$</p><p>Критические разбиения: ${(\texttt{AA}, \texttt{BABABAAB})}$ и ${(\texttt{AABABAB}, \texttt{AAB})}$.</p><p>В двустороннем алгоритме в качестве разбиения для строки шаблона используется
критическое разбиение, при этом длина левой подстроки меньше глобального периода всей
строки шаблона (${|u| &lt; per(pattern)}$).</p><p>Используются следующие правила сдвигов:</p><ul><li><p>При несовпадении в процессе сравнения правой подстроки шаблон сдвигается вправо на
количество просканированных символов, так, чтобы позиция разбиения шаблона оказалась на
позиции несовпадающего символа:</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 944 281"><g transform="translate(8,16)"><path d="M80 0h32" fill="none" stroke="currentcolor"/><path d="M112 0h32" fill="none" stroke="currentcolor"/><path d="M144 0h32" fill="none" stroke="currentcolor"/><path d="M176 0h32" fill="none" stroke="currentcolor"/><path d="M208 0h32" fill="none" stroke="currentcolor"/><path d="M240 0h32" fill="none" stroke="currentcolor"/><path d="M272 0h32" fill="none" stroke="currentcolor"/><path d="M304 0h32" fill="none" stroke="currentcolor"/><path d="M336 0h32" fill="none" stroke="currentcolor"/><path d="M368 0h32" fill="none" stroke="currentcolor"/><path d="M4e2.0h32" fill="none" stroke="currentcolor"/><path d="M432 0h32" fill="none" stroke="currentcolor"/><path d="M464 0h32" fill="none" stroke="currentcolor"/><path d="M496 0h32" fill="none" stroke="currentcolor"/><path d="M528 0h32" fill="none" stroke="currentcolor"/><path d="M560 0h32" fill="none" stroke="currentcolor"/><path d="M592 0h32" fill="none" stroke="currentcolor"/><path d="M624 0h32" fill="none" stroke="currentcolor"/><path d="M656 0h32" fill="none" stroke="currentcolor"/><path d="M688 0h32" fill="none" stroke="currentcolor"/><path d="M720 0h32" fill="none" stroke="currentcolor"/><path d="M80 48H752" fill="none" stroke="currentcolor"/><path d="M80 80H752" fill="none" stroke="currentcolor"/><path d="M184 112H312" fill="none" stroke="currentcolor"/><path d="M96 144H288" fill="none" stroke="currentcolor"/><path d="M96 176h80" fill="none" stroke="currentcolor"/><path d="M176 176H288" fill="none" stroke="currentcolor"/><path d="M192 192h64" fill="none" stroke="currentcolor"/><path d="M192 224h72" fill="none" stroke="currentcolor"/><path d="M280 224H392" fill="none" stroke="currentcolor"/><path d="M192 256h80" fill="none" stroke="currentcolor"/><path d="M272 256H392" fill="none" stroke="currentcolor"/><path d="M80 0V16" fill="none" stroke="currentcolor"/><path d="M80 48V80" fill="none" stroke="currentcolor"/><path d="M112 0V16" fill="none" stroke="currentcolor"/><path d="M144 0V16" fill="none" stroke="currentcolor"/><path d="M176 0V16" fill="none" stroke="currentcolor"/><path d="M176 160v16" fill="none" stroke="currentcolor"/><path d="M208 0V16" fill="none" stroke="currentcolor"/><path d="M240 0V16" fill="none" stroke="currentcolor"/><path d="M272 0V16" fill="none" stroke="currentcolor"/><path d="M272 208v16" fill="none" stroke="currentcolor"/><path d="M272 224v32" fill="none" stroke="currentcolor"/><path d="M304 0V16" fill="none" stroke="currentcolor"/><path d="M336 0V16" fill="none" stroke="currentcolor"/><path d="M368 0V16" fill="none" stroke="currentcolor"/><path d="M4e2.0V16" fill="none" stroke="currentcolor"/><path d="M432 0V16" fill="none" stroke="currentcolor"/><path d="M464 0V16" fill="none" stroke="currentcolor"/><path d="M496 0V16" fill="none" stroke="currentcolor"/><path d="M528 0V16" fill="none" stroke="currentcolor"/><path d="M560 0V16" fill="none" stroke="currentcolor"/><path d="M592 0V16" fill="none" stroke="currentcolor"/><path d="M624 0V16" fill="none" stroke="currentcolor"/><path d="M656 0V16" fill="none" stroke="currentcolor"/><path d="M688 0V16" fill="none" stroke="currentcolor"/><path d="M720 0V16" fill="none" stroke="currentcolor"/><path d="M752 0V16" fill="none" stroke="currentcolor"/><path d="M752 48V80" fill="none" stroke="currentcolor"/><path d="M176 152v8" fill="none" stroke="currentcolor"/><polygon points="280.000000,224.000000 268.000000,218.399994 268.000000,229.600006" fill="currentcolor" transform="rotate(90.000000, 272.000000, 224.000000)"/><polygon points="320.000000,112.000000 308.000000,106.400002 308.000000,117.599998" fill="currentcolor" transform="rotate(0.000000, 312.000000, 112.000000)"/><path d="M96 144A16 16 0 0080 160" fill="none" stroke="currentcolor"/><path d="M288 144a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M80 160a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M304 160a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><path d="M176 176a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M256 192a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M192 224a16 16 0 00-16 16" fill="none" stroke="currentcolor"/><path d="M392 224a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M176 240a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M408 240a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><circle cx="176" cy="176" r="6" stroke="currentcolor" fill="#fff"/><text text-anchor="middle" x="0" y="164" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="244" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="164" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="244" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="164" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="244" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="164" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="244" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="68" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="32" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="244" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="164" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="244" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="68" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="164" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="244" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="164" fill="currentcolor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="244" fill="currentcolor" style="font-size:1em">₂</text><text text-anchor="middle" x="64" y="68" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="164" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="244" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="96" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="68" fill="currentcolor" style="font-size:1em">E</text><text text-anchor="middle" x="96" y="164" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="128" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="164" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="160" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="160" y="164" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="192" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="100" fill="currentcolor" style="font-size:1em">п</text><text text-anchor="middle" x="192" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="192" y="164" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="244" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="200" y="100" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="208" y="100" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="216" y="100" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="224" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="224" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="100" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="224" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="164" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="244" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="232" y="100" fill="currentcolor" style="font-size:1em">я</text><text text-anchor="middle" x="248" y="100" fill="currentcolor" style="font-size:1em">ч</text><text text-anchor="middle" x="256" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="256" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="100" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="256" y="132" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="256" y="164" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="244" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="264" y="100" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="272" y="100" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="280" y="100" fill="currentcolor" style="font-size:1em">ь</text><text text-anchor="middle" x="288" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="164" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="244" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="320" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="320" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="244" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="352" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="352" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="244" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="384" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="384" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="244" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="408" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="416" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="440" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="472" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="480" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="480" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="504" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="512" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="512" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="536" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="544" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="544" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="568" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="576" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="576" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="600" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="608" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="608" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="632" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="640" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="664" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="672" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="696" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="704" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="728" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="736" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="68" fill="currentcolor" style="font-size:1em">D</text></g></svg></div></li><li><p>При несовпадении в процессе сравнения левой подстроки шаблон сдвигается на глобальный
период шаблона ${per(pattern)}$:</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 944 313"><g transform="translate(8,16)"><path d="M80 0h32" fill="none" stroke="currentcolor"/><path d="M112 0h32" fill="none" stroke="currentcolor"/><path d="M144 0h32" fill="none" stroke="currentcolor"/><path d="M176 0h32" fill="none" stroke="currentcolor"/><path d="M208 0h32" fill="none" stroke="currentcolor"/><path d="M240 0h32" fill="none" stroke="currentcolor"/><path d="M272 0h32" fill="none" stroke="currentcolor"/><path d="M304 0h32" fill="none" stroke="currentcolor"/><path d="M336 0h32" fill="none" stroke="currentcolor"/><path d="M368 0h32" fill="none" stroke="currentcolor"/><path d="M4e2.0h32" fill="none" stroke="currentcolor"/><path d="M432 0h32" fill="none" stroke="currentcolor"/><path d="M464 0h32" fill="none" stroke="currentcolor"/><path d="M496 0h32" fill="none" stroke="currentcolor"/><path d="M528 0h32" fill="none" stroke="currentcolor"/><path d="M560 0h32" fill="none" stroke="currentcolor"/><path d="M592 0h32" fill="none" stroke="currentcolor"/><path d="M624 0h32" fill="none" stroke="currentcolor"/><path d="M656 0h32" fill="none" stroke="currentcolor"/><path d="M688 0h32" fill="none" stroke="currentcolor"/><path d="M720 0h32" fill="none" stroke="currentcolor"/><path d="M80 48H752" fill="none" stroke="currentcolor"/><path d="M80 80H752" fill="none" stroke="currentcolor"/><path d="M184 128h80" fill="none" stroke="currentcolor"/><path d="M280 128H408" fill="none" stroke="currentcolor"/><path d="M192 160H392" fill="none" stroke="currentcolor"/><path d="M192 192h80" fill="none" stroke="currentcolor"/><path d="M272 192H392" fill="none" stroke="currentcolor"/><path d="M352 240H552" fill="none" stroke="currentcolor"/><path d="M2e2 256H328" fill="none" stroke="currentcolor"/><path d="M352 272h80" fill="none" stroke="currentcolor"/><path d="M432 272H552" fill="none" stroke="currentcolor"/><path d="M80 0V16" fill="none" stroke="currentcolor"/><path d="M80 48V80" fill="none" stroke="currentcolor"/><path d="M112 0V16" fill="none" stroke="currentcolor"/><path d="M144 0V16" fill="none" stroke="currentcolor"/><path d="M176 0V16" fill="none" stroke="currentcolor"/><path d="M184 192v48" fill="none" stroke="currentcolor"/><path d="M208 0V16" fill="none" stroke="currentcolor"/><path d="M240 0V16" fill="none" stroke="currentcolor"/><path d="M272 0V16" fill="none" stroke="currentcolor"/><path d="M272 176v16" fill="none" stroke="currentcolor"/><path d="M304 0V16" fill="none" stroke="currentcolor"/><path d="M336 0V16" fill="none" stroke="currentcolor"/><path d="M368 0V16" fill="none" stroke="currentcolor"/><path d="M4e2.0V16" fill="none" stroke="currentcolor"/><path d="M432 0V16" fill="none" stroke="currentcolor"/><path d="M432 256v16" fill="none" stroke="currentcolor"/><path d="M464 0V16" fill="none" stroke="currentcolor"/><path d="M496 0V16" fill="none" stroke="currentcolor"/><path d="M528 0V16" fill="none" stroke="currentcolor"/><path d="M560 0V16" fill="none" stroke="currentcolor"/><path d="M592 0V16" fill="none" stroke="currentcolor"/><path d="M624 0V16" fill="none" stroke="currentcolor"/><path d="M656 0V16" fill="none" stroke="currentcolor"/><path d="M688 0V16" fill="none" stroke="currentcolor"/><path d="M720 0V16" fill="none" stroke="currentcolor"/><path d="M752 0V16" fill="none" stroke="currentcolor"/><path d="M752 48V80" fill="none" stroke="currentcolor"/><path d="M272 168v8" fill="none" stroke="currentcolor"/><path d="M432 248v8" fill="none" stroke="currentcolor"/><polygon points="192.000000,128.000000 180.000000,122.400002 180.000000,133.600006" fill="currentcolor" transform="rotate(180.000000, 184.000000, 128.000000)"/><polygon points="336.000000,256.000000 324.000000,250.399994 324.000000,261.600006" fill="currentcolor" transform="rotate(0.000000, 328.000000, 256.000000)"/><polygon points="416.000000,128.000000 404.000000,122.400002 404.000000,133.600006" fill="currentcolor" transform="rotate(0.000000, 408.000000, 128.000000)"/><path d="M192 160a16 16 0 00-16 16" fill="none" stroke="currentcolor"/><path d="M392 160a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M176 176a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M408 176a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><path d="M352 240a16 16 0 00-16 16" fill="none" stroke="currentcolor"/><path d="M552 240a16 16 0 0116 16" fill="none" stroke="currentcolor"/><path d="M184 240a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M336 256a16 16 0 0016 16" fill="none" stroke="currentcolor"/><path d="M568 256a16 16 0 01-16 16" fill="none" stroke="currentcolor"/><text text-anchor="middle" x="0" y="180" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="260" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="180" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="260" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="180" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="180" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="68" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="32" y="180" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="68" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="180" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="260" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="68" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="180" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="260" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="68" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="180" fill="currentcolor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="260" fill="currentcolor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="68" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="180" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="260" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="96" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="68" fill="currentcolor" style="font-size:1em">E</text><text text-anchor="middle" x="128" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="160" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="192" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="116" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="192" y="180" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="192" y="276" fill="currentcolor" style="font-size:1em">С</text><text text-anchor="middle" x="200" y="116" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="200" y="276" fill="currentcolor" style="font-size:1em">д</text><text text-anchor="middle" x="208" y="276" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="216" y="116" fill="currentcolor" style="font-size:1em">л</text><text text-anchor="middle" x="216" y="276" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="224" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="224" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="116" fill="currentcolor" style="font-size:1em">е</text><text text-anchor="middle" x="224" y="148" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="224" y="180" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="224" y="276" fill="currentcolor" style="font-size:1em">г</text><text text-anchor="middle" x="224" y="292" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="232" y="116" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="232" y="292" fill="currentcolor" style="font-size:1em">и</text><text text-anchor="middle" x="240" y="116" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="240" y="276" fill="currentcolor" style="font-size:1em">н</text><text text-anchor="middle" x="240" y="292" fill="currentcolor" style="font-size:1em">м</text><text text-anchor="middle" x="248" y="116" fill="currentcolor" style="font-size:1em">я</text><text text-anchor="middle" x="248" y="276" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="248" y="292" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="256" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="256" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="148" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="256" y="180" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="292" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="264" y="276" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="264" y="292" fill="currentcolor" style="font-size:1em">л</text><text text-anchor="middle" x="272" y="276" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="272" y="292" fill="currentcolor" style="font-size:1em">о</text><text text-anchor="middle" x="280" y="276" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="280" y="292" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="288" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="116" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="288" y="148" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="288" y="180" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="276" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="296" y="116" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="296" y="276" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="304" y="276" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="312" y="116" fill="currentcolor" style="font-size:1em">п</text><text text-anchor="middle" x="312" y="276" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="320" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="320" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="116" fill="currentcolor" style="font-size:1em">р</text><text text-anchor="middle" x="320" y="148" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="320" y="180" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="276" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="328" y="116" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="336" y="116" fill="currentcolor" style="font-size:1em">в</text><text text-anchor="middle" x="344" y="116" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="352" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="352" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="116" fill="currentcolor" style="font-size:1em">я</text><text text-anchor="middle" x="352" y="148" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="352" y="180" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="260" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="368" y="116" fill="currentcolor" style="font-size:1em">ч</text><text text-anchor="middle" x="376" y="116" fill="currentcolor" style="font-size:1em">а</text><text text-anchor="middle" x="384" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="384" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="116" fill="currentcolor" style="font-size:1em">с</text><text text-anchor="middle" x="384" y="148" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="384" y="180" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="260" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="392" y="116" fill="currentcolor" style="font-size:1em">т</text><text text-anchor="middle" x="400" y="116" fill="currentcolor" style="font-size:1em">ь</text><text text-anchor="middle" x="408" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="416" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="416" y="260" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="440" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="448" y="260" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="472" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="480" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="480" y="68" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="480" y="260" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="504" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="512" y="20" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="512" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="512" y="260" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="536" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="544" y="20" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="544" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="544" y="260" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="568" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="576" y="20" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="576" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="600" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="608" y="20" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="608" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="632" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="640" y="68" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="664" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="672" y="68" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="696" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="20" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="704" y="68" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="728" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="736" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="68" fill="currentcolor" style="font-size:1em">D</text></g></svg></div></li></ul><p>Такие правила сдвигов приводят к квадратичной сложности в худшем случае. Для улучшения
асимптотической сложности худшего случая, в алгоритме также используется техника
запоминания префикса (<em>prefix memorization</em>): когда производится сдвиг на ${per(pattern)}$
по правилу сдвига для левой подстроки, дополнительно запоминается префикс совпавшей части
шаблона, чтобы не сравнивать его ещё раз в следующем цикле.<br>Это та же техника, которая используется в модификации алгоритма Бойера-Мура с добавлением
правила Галиля (<a href=https://ru.wikipedia.org/wiki/%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC_%D0%91%D0%BE%D0%B9%D0%B5%D1%80%D0%B0_%E2%80%94_%D0%9C%D1%83%D1%80%D0%B0#cite_ref-_c27d75dd26585688_6-0>Wikipedia</a>).</p><p>Ниже представлена первый вариант двустороннего алгоритма. Считаем, что глобальный период
строки шаблона ${per(pattern)}$ и критическое разбиение ${uv}$ с ${|u|&lt;per(pattern)}$
вычислены заранее.</p><p>Код на kotlin, без обработки суррогатных пар.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>data</span> <span style=color:#00f>class</span> <span style=color:#2b91af>Factorization</span>(<span style=color:#00f>val</span> left: IntRange, <span style=color:#00f>val</span> right: IntRange)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>/**
</span></span></span><span style=display:flex><span><span style=color:green> * Возвращает позиции всех вхождений шаблона [pattern] в строке [text]
</span></span></span><span style=display:flex><span><span style=color:green> */</span>
</span></span><span style=display:flex><span><span style=color:#00f>fun</span> cp1(text: String, pattern: String): List&lt;Int&gt; {
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> result = mutableListOf&lt;Int&gt;()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green>// factorize() разбивает строку шаблона pattern на 2 подстроки:
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// left и right так, что |left| &lt; period.
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// left, right - закрытые диапазоны индексов соответствующих подстрок
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// period - глобальный период строки шаблона
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:#00f>val</span> <span>(</span>left, right) = factorize(pattern)
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> period = pattern.getMinimalPeriod()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> pos = 0
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> memPrefix = -1
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> (pos + pattern.length &lt;= text.length) {
</span></span><span style=display:flex><span>        <span style=color:green>// Сравнение правой части
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>val</span> i = (maxOf(right.first, memPrefix + 1)..right.last).find{ i-&gt;
</span></span><span style=display:flex><span>            pattern[i] != text[pos + i]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> (i != <span style=color:#00f>null</span>) {
</span></span><span style=display:flex><span>            pos = pos + i - right.first + 1
</span></span><span style=display:flex><span>            memPrefix = -1
</span></span><span style=display:flex><span>        } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>            <span style=color:green>// Сравнение левой части
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>val</span> match = (left.last downTo memPrefix + 1).all { j -&gt;
</span></span><span style=display:flex><span>                pattern[j] == text[pos + j]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#00f>if</span> (match) result.add(pos)
</span></span><span style=display:flex><span>            pos += period
</span></span><span style=display:flex><span>            memPrefix = pattern.length - period - 1
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> result
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>memprefix</code> — позиция запомненного префикса, обновляется при встрече несовпадающих
символов. Может быть установлена в неотрицательное значение только при сканировании левой
подстроки.</p><dl><dt>Лемма</dt><dd><p>Пусть ${uv}$ — критическое разбиение строки $x$. Если $w$ — суффикс $u$ и $w$ — префикс
$v$ (базовый случай), то длина $w$ кратна глобальному периоду строки $x$.</p></dd></dl><details><summary>Доказательство</summary><div class=markdown-inner><p>Свойство тривиально выполняется для пустой строки, в противном случае, так как
${r(u,v)=per(x)}$, т.е. ${per(x)}$ равен периоду строки $w$, то $x$ можно записать как
${(yz)^e}$, где ${|yz|=per(x)}$, $z$ — не пустая, ${e>0}$. Если $y$ не будет пустой, то
она будет повторением для разбиения ${uv}$. Но ${|y|&lt;per(x)}$ будет противоречить тому,
что ${uv}$ — критическое разбиение. Поэтому, ${|w|=e*period(x)}$.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 169"><g transform="translate(8,16)"><path d="M328 16h80" fill="none" stroke="currentcolor"/><path d="M24 32H128" fill="none" stroke="currentcolor"/><path d="M128 32h96" fill="none" stroke="currentcolor"/><path d="M224 32h96" fill="none" stroke="currentcolor"/><path d="M320 32h96" fill="none" stroke="currentcolor"/><path d="M416 32h96" fill="none" stroke="currentcolor"/><path d="M512 32h96" fill="none" stroke="currentcolor"/><path d="M608 32H736" fill="none" stroke="currentcolor"/><path d="M24 64H128" fill="none" stroke="currentcolor"/><path d="M128 64h96" fill="none" stroke="currentcolor"/><path d="M224 64h96" fill="none" stroke="currentcolor"/><path d="M320 64h96" fill="none" stroke="currentcolor"/><path d="M416 64h96" fill="none" stroke="currentcolor"/><path d="M512 64h96" fill="none" stroke="currentcolor"/><path d="M608 64H736" fill="none" stroke="currentcolor"/><path d="M24 112H224" fill="none" stroke="currentcolor"/><path d="M224 112H416" fill="none" stroke="currentcolor"/><path d="M416 112H608" fill="none" stroke="currentcolor"/><path d="M608 112H736" fill="none" stroke="currentcolor"/><path d="M24 144H224" fill="none" stroke="currentcolor"/><path d="M224 144H416" fill="none" stroke="currentcolor"/><path d="M416 144H608" fill="none" stroke="currentcolor"/><path d="M608 144H736" fill="none" stroke="currentcolor"/><path d="M24 32V64" fill="none" stroke="currentcolor"/><path d="M24 112v32" fill="none" stroke="currentcolor"/><path d="M128 32V64" fill="none" stroke="currentcolor"/><path d="M224 32V64" fill="none" stroke="currentcolor"/><path d="M224 64v48" fill="none" stroke="currentcolor"/><path d="M224 112v32" fill="none" stroke="currentcolor"/><path d="M320 32V64" fill="none" stroke="currentcolor"/><path d="M416 32V64" fill="none" stroke="currentcolor"/><path d="M416 64v48" fill="none" stroke="currentcolor"/><path d="M416 112v32" fill="none" stroke="currentcolor"/><path d="M512 32V64" fill="none" stroke="currentcolor"/><path d="M608 32V64" fill="none" stroke="currentcolor"/><path d="M608 64v48" fill="none" stroke="currentcolor"/><path d="M608 112v32" fill="none" stroke="currentcolor"/><path d="M736 32V64" fill="none" stroke="currentcolor"/><path d="M736 112v32" fill="none" stroke="currentcolor"/><polygon points="336.000000,16.000000 324.000000,10.400000 324.000000,21.600000" fill="currentcolor" transform="rotate(180.000000, 328.000000, 16.000000)"/><polygon points="416.000000,16.000000 404.000000,10.400000 404.000000,21.600000" fill="currentcolor" transform="rotate(0.000000, 408.000000, 16.000000)"/><text text-anchor="middle" x="152" y="52" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="160" y="52" fill="currentcolor" style="font-size:1em">z</text><text text-anchor="middle" x="280" y="52" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="288" y="52" fill="currentcolor" style="font-size:1em">z</text><text text-anchor="middle" x="320" y="132" fill="currentcolor" style="font-size:1em">𝒘</text><text text-anchor="middle" x="336" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="344" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="352" y="4" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="360" y="4" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="368" y="4" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="376" y="4" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="376" y="52" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="384" y="4" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="384" y="52" fill="currentcolor" style="font-size:1em">z</text><text text-anchor="middle" x="392" y="4" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="400" y="4" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="472" y="52" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="480" y="52" fill="currentcolor" style="font-size:1em">z</text><text text-anchor="middle" x="512" y="132" fill="currentcolor" style="font-size:1em">𝒘</text><text text-anchor="middle" x="568" y="52" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="576" y="52" fill="currentcolor" style="font-size:1em">z</text></g></svg></div></div></details><p>Доказательство корректности алгоритма есть в <a href=#reference_text_algorithms>[1]</a>. В таком
виде алгоритм использует максимум ${2*|text|}$ операций сравнения. (доказательство там же).</p><p>Глобальный период строки шаблона требуется только тогда, когда он относительно не большой
(меньше примерно половины длины шаблона), в остальных случаях можно обойтись без его
вычисления.</p><p>Второй вариант двустороннего алгоритма рассчитан на применение при большом периоде строки
шаблона. Дополнительное его преимущество — относительно небольшое максимальное количество
сравнений.</p><p>Вариант отличается от первого тем, что в нем больше не используется запоминание префикса,
а при несовпадении в левой подстроке используется другое правило — шаблон сдвигается не на
${per(pattern)}$ позиций, а на некоторое количество $q$, которое может быть меньше
глобального периода (${q ≤ per(pattern)}$).<br>Если взять в качестве значения ${q=1}$, то алгоритм станет аналогичен
наивному алгоритму с квадратичной сложностью, поэтому число $q$ выбирается с
дополнительным ограничением: ${q > \max(|u|, |v|)}$, где ${uv}$ — критическое разбиение
${pattern}$. В таком виде число сравнений во втором варианте по прежнему будет
меньше ${2*|text|}$, как и в первом, но вычисление глобального периода не
потребуется.<br>Запоминание префикса в данном случае не может быть применено из-за того, что
$q$ может быть меньше ${per(pattern)}$.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>fun</span> twoWay2(text: String, pattern: String): List&lt;Int&gt; {
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> result = mutableListOf&lt;Int&gt;()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> <span>(</span>left, right) = factorize(pattern)
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> q = maxOf(left.length, right.length) + 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> pos = 0
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> (pos + pattern.length &lt;= text.length) {
</span></span><span style=display:flex><span>        <span style=color:green>// Сравнение правой части
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>val</span> i = right.find { i -&gt; pattern[i] != text[pos + i] }
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> (i != <span style=color:#00f>null</span>) {
</span></span><span style=display:flex><span>            pos = pos + i - right.first + 1
</span></span><span style=display:flex><span>        } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>            <span style=color:green>// Сравнение левой части
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>val</span> match = left.reversed().all { j -&gt; pattern[j] == text[pos + j] }
</span></span><span style=display:flex><span>            <span style=color:#00f>if</span> (match) result.add(pos)
</span></span><span style=display:flex><span>            pos += q
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> result
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Доказательство корректности и максимального количества сравнений аналогично доказательству
первого варианта и также есть в <a href=#reference_text_algorithms>[1]</a>.</p><p>Конечный двусторонний алгоритм использует оба предыдущих варианта, выбирая нужный в
зависимости от того, является ли левая подстрока суффиксом периодической части правой. В
алгоритме, кроме критического разбиения строки шаблона на ${u,v}$, где ${|u|&lt;per(pattern)}$, также
используется заранее вычисленный период только правой подстроки $v$. Его вычисление может
быть произведено без дополнительных затрат одновременно с вычислением критического
разбиения.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>data</span> <span style=color:#00f>class</span> <span style=color:#2b91af>Factorization</span>(
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> left: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> right: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> rightPeriod: Int
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>fun</span> twoWay(text: String, pattern: String): List&lt;Int&gt; {
</span></span><span style=display:flex><span>    <span style=color:green>// factorize() разбивает строку шаблона pattern на 2 подстроки:
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// left и right так, что |left| &lt; per(pattern) и вычисляет период правой подстроки.
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// left, right — закрытые диапазоны индексов соответствующих подстрок.
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// rightPeriod — период правой подстроки
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:#00f>val</span> <span>(</span>left, right, rightPeriod) = factorize(pattern)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green>// left — суффикс подстроки right[0..rightPeriod-1]
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:#00f>val</span> leftIsSuffixOfRight = left.all { i -&gt;
</span></span><span style=display:flex><span>        pattern[i] == pattern[right.first + rightPeriod - left.length + i]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#00f>if</span> (leftIsSuffixOfRight) {
</span></span><span style=display:flex><span>        <span style=color:green>// rightPeriod равен периоду строки шаблона per(pattern).
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:green>// Вызываем первый вариант алгоритма, используя left, right
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:green>// и rightPeriod в качестве глобального периода
</span></span></span><span style=display:flex><span><span style=color:green></span>        cp1(text, pattern, left, right, rightPeriod)
</span></span><span style=display:flex><span>    } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>        <span style=color:green>// Вызываем второй вариант алгоритма, используя left, right
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:green>// и q.
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>val</span> q = maxOf(left.length, right.length) + 1
</span></span><span style=display:flex><span>        cp2(text, pattern, left, right, q)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Доказательства корректности алгоритма, а также того, что ${q=max(|u|,|v|)+1}$ соответствует
условию ${q≤per(pattern)}$ в случае, если $u$ не является суффиксом ${v[0…p-1]}$, даны в <a href=#reference_text_algorithms>[1]</a>.</p><p>Алгоритм выполняется за время ${O(|text| + |pattern|)}$ с константной памятью, при этом
выполняется не более ${2*|text|}$ сравнений.</p><p>Условие &ldquo;${u\texttt{ — суффикс }v[0…p-1]}$&rdquo; выполняется максимум за ${|pattern|/2}$
сравнений, вычисление периода и критического разбиения — ${4*|pattern|}$ сравнений, поэтому
весь препроцессинг выполняется максимум за ${4.5*|pattern|}$ сравнений.</p><h4 id=пример-работы-алгоритма>Пример работы алгоритма
<a class=anchor href=#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b-%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc%d0%b0>#</a></h4><p>1. Возьмем шаблон ${pattern=\texttt{A}^n\texttt{B}}$. Критическое разбиение: ${(\texttt{A}^n,
\texttt{B})}$. Поиск в тексте ${\texttt{B}^m}$ потребует ${2*|text|/|pattern|}$ сравнений.
Несовпадение встречается в левой части, алгоритм сдвигает шаблон на 3 позиции.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 169"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="0" y="52" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="100" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="148" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="8" y="52" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="100" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="148" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="16" y="52" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="100" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="52" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="100" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="32" y="52" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="100" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="148" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="52" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="100" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="148" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="52" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="100" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="148" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="52" fill="currentcolor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="100" fill="currentcolor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="148" fill="currentcolor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="52" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="100" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="148" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="88" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="88" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="104" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="104" y="36" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="104" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="112" y="52" fill="currentcolor" style="font-size:1em">|</text><text text-anchor="middle" x="120" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="120" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="120" y="52" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="136" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="136" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="152" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="152" y="84" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="152" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="100" fill="currentcolor" style="font-size:1em">|</text><text text-anchor="middle" x="168" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="168" y="84" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="168" y="100" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="184" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="184" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="200" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="200" y="132" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="200" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="148" fill="currentcolor" style="font-size:1em">|</text><text text-anchor="middle" x="216" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="216" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="216" y="148" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="232" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="248" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="264" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="280" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="296" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="312" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="328" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="344" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="360" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="376" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="392" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="408" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="424" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="440" y="4" fill="currentcolor" style="font-size:1em">B</text></g></svg></div><p>2. Шаблон ${pattern=\texttt{A}^n\texttt{BA}^n}$ с глобальным периодом ${n+1}$. Критическое
разбиение: ${(\texttt{A}^n, \texttt{BA}^n)}$. Левая часть — суффикс периодической части
правой, поэтому будет использован первый вариант алгоритма и ${2*|text|-2e-2}$ сравнений при
поиске в тексте ${text=(\texttt{A}^n\texttt{BA})^e\texttt{A}^{n-1}}$.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 265"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="0" y="52" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="100" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="148" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="196" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="244" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="8" y="52" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="100" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="148" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="196" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="244" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="16" y="52" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="100" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="196" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="244" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="52" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="100" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="196" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="244" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="32" y="52" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="100" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="148" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="196" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="244" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="52" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="100" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="148" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="196" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="244" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="52" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="100" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="148" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="196" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="244" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="52" fill="currentcolor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="100" fill="currentcolor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="148" fill="currentcolor" style="font-size:1em">₃</text><text text-anchor="middle" x="56" y="196" fill="currentcolor" style="font-size:1em">₄</text><text text-anchor="middle" x="56" y="244" fill="currentcolor" style="font-size:1em">₅</text><text text-anchor="middle" x="64" y="52" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="100" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="148" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="196" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="244" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="80" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="80" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="80" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="96" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="104" y="52" fill="currentcolor" style="font-size:1em">|</text><text text-anchor="middle" x="112" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="112" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="112" y="52" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="128" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="128" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="128" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="144" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="144" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="152" y="100" fill="currentcolor" style="font-size:1em">|</text><text text-anchor="middle" x="160" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="84" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="160" y="100" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="160" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="160" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="168" y="148" fill="currentcolor" style="font-size:1em">|</text><text text-anchor="middle" x="176" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="176" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="176" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="176" y="148" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="192" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="192" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="192" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="192" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="192" y="196" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="208" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="196" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="228" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="208" y="244" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="216" y="196" fill="currentcolor" style="font-size:1em">|</text><text text-anchor="middle" x="224" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="180" fill="currentcolor" style="font-size:1em">✘</text><text text-anchor="middle" x="224" y="196" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="224" y="228" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="244" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="232" y="244" fill="currentcolor" style="font-size:1em">|</text><text text-anchor="middle" x="240" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="240" y="196" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="240" y="228" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="240" y="244" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="256" y="196" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="256" y="228" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="256" y="244" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="272" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="272" y="228" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="272" y="244" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="288" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="304" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="320" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="336" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="352" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="368" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="384" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="400" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="416" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="432" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="448" y="4" fill="currentcolor" style="font-size:1em">A</text></g></svg></div><p>3. Шаблон ${pattern=\texttt{A}^n\texttt{BA}^{n-1}}$. Алгоритм будет использовать второй
вариант и также выполнит ${2*|text|-2e-2}$ сравнений при
поиске в тексте ${text=(\texttt{A}^n\texttt{BA})^e\texttt{A}^{n-1}}$.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 169"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="0" y="52" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="100" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="148" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="8" y="52" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="100" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="148" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="16" y="52" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="100" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="52" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="100" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="148" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="32" y="52" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="100" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="148" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="52" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="100" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="148" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="52" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="100" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="148" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="52" fill="currentcolor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="100" fill="currentcolor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="148" fill="currentcolor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="52" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="100" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="148" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="80" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="80" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="80" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="96" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="112" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="112" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="112" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="120" y="52" fill="currentcolor" style="font-size:1em">|</text><text text-anchor="middle" x="128" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="128" y="52" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="144" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="144" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="84" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="144" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="36" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="160" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="84" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="160" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="176" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="176" y="84" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="176" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="184" y="100" fill="currentcolor" style="font-size:1em">|</text><text text-anchor="middle" x="192" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="192" y="84" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="192" y="100" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="208" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="84" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="208" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="208" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="84" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="100" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="240" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="240" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="240" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="248" y="148" fill="currentcolor" style="font-size:1em">|</text><text text-anchor="middle" x="256" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="256" y="148" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="272" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="272" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="272" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="288" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="288" y="132" fill="currentcolor" style="font-size:1em">✔</text><text text-anchor="middle" x="288" y="148" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="304" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="336" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="352" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="368" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="384" y="4" fill="currentcolor" style="font-size:1em">B</text><text text-anchor="middle" x="400" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="416" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="432" y="4" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="448" y="4" fill="currentcolor" style="font-size:1em">B</text></g></svg></div><h2 id=теорема-о-критическом-разбиении>Теорема о критическом разбиении
<a class=anchor href=#%d1%82%d0%b5%d0%be%d1%80%d0%b5%d0%bc%d0%b0-%d0%be-%d0%ba%d1%80%d0%b8%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%bc-%d1%80%d0%b0%d0%b7%d0%b1%d0%b8%d0%b5%d0%bd%d0%b8%d0%b8>#</a></h2><p>Работа двустороннего алгоритма основывается на комбинаторных свойствах строки,
обозначенных в <strong>теореме о критическом разбиении</strong> (<em>Critical Factorization Theorem</em>).</p><p>Теорема гласит, что любая строка $x$ имеет хотя бы одно критическое разбиение ${x=uv}$
(т.е. такое разбиение, что ${r(u,v)=per(x)}$). Более того, подстрока $u$ может быть
выбрана такой, что ${|u|&lt;per(x)}$.</p><p>Впервые она была сформулирована и доказана в работах Césari и Vincent в 1978, а в
современном виде — в работе J. Duval (1989). Теорема имеет несколько доказательств, но для
двустороннего алгоритма было представлено свое собственное, на основе вычисления
максимальных суффиксов.</p><p>Введем отношения порядка строк.</p><p><em><strong>Лексикографический</strong></em> (или <em><strong>алфавитный</strong></em>) порядок определяется на множестве строк
${A^{*}}$ упорядоченного алфавита $A$. Для двух строк ${x, y ∈ A^*}$ строка ${x≤y}$ тогда, когда
выполняется одно из условий:</p><ul><li>$x$ — префикс $y$</li><li>$x$ <em>строго меньше</em> $y$. Т. е. $x$ и $y$ можно представить как
${x=w\texttt{A}x, y=w\texttt{B}y}$, где ${w,x,y}$ — строки из множества ${A^{*}}$; а
${\texttt{A}, \texttt{B}}$ ­— два символа, такие, что ${\texttt{A}&lt;\texttt{B}}$.</li></ul><p><em><strong>Обратный лексикографический порядок</strong></em> — лексикографический порядок на алфавите $A$,
порядок символов которого заменен на обратный. Т.е. $x$ строго меньше $y$, если $x$ и $y$
можно представить как ${x=w\texttt{A}x, y=w\texttt{B}y}$, где ${w,x,y}$ — строки из множества
${A^{*}}$, а ${\texttt{A}, \texttt{B}}$ ­— два символа, такие, что ${\texttt{A}>\texttt{B}}$.</p><p>Обозначим через $≤$ прямой лексикографический порядок, а через $⪯$ — обратный.</p><p>Стоит отметить, что порядок $≤$ — не инверсия порядка $⪯$. Например, возьмем алфавит
${A=\{\texttt{A},\texttt{B}\}}$ с ${\texttt{A} &lt; \texttt{B}}$. Для строк ${\tt ABB}$ и
${\tt ABBAA}$ верны оба равенства:</p><ul><li>${\texttt{ABB} ≤ \texttt{ABBAA}}$</li><li>${\texttt{ABB} ⪯ \texttt{ABBAA}}$</li></ul><p>Более того, в пересечении порядков $≤$ и $⪯$ совпадает только первое условие префикса.
Т.е.оба выражения ${x ≤ y}$ и ${x ⪯ y}$ верны только в том случае, если $x$ — префикс $y$.</p><p>Ниже представлены все суффиксы строки ${\tt ABAABAA}$, отсортированные в прямом и
обратном порядке:</p><pre tabindex=0><code class=language-textinline data-lang=textinline>  Суффиксы        ≤                ⪯
ABAABAA         A                BAA
BAABAA          AA               BAABAA
AABAA           AABAA            A
ABAA            ABAA             ABAA
BAA             ABAABAA          ABAABAA
AA              BAA              AA
A               BAABAA           AABAA
</code></pre><p><em><strong>Максимальный суффикс</strong></em> — это наибольшая подстрока строки $x$ в соответствии с заданным
лексикографическим порядком. Обозначим его через ${Maxsuf(x)}$. В примере выше
${Maxsuf(\tt ABAABAA)}$ равен ${\tt BAABAA}$ для прямого порядка и ${\tt AABAA}$ для
обратного.</p><p><strong>Теорема</strong></p><p>Пусть $x$ ­— непустая строка из символов алфавита $A$ и ${x=uv=u'v'}$, где $v$ ­—
лексикографически максимальный суффикс строки $x$ в соответствии с прямым порядком ($≤$), а
$v'$ — лексикографически максимальный суффикс $x$ в соответствии с обратным порядком (⪯).
Если ${|v|≤|v'|}$, то ${uv}$ — критическое разбиение $x$, а иначе ${u'v'}$ — критическое
разбиение $x$. Более того, ${|u|&lt;per(x)}$ и ${|u'|&lt;per(x)}$.</p><p>Доказательство дано в <a href=#reference_text_algorithms>[1]</a></p><p>Имея эту теорему, задача нахождения критического разбиения сводится к задаче нахождения
максимальных суффиксов для прямого и обратного алфавитного порядка.</p><h2 id=вычисление-критического-разбиения>Вычисление критического разбиения
<a class=anchor href=#%d0%b2%d1%8b%d1%87%d0%b8%d1%81%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%ba%d1%80%d0%b8%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b3%d0%be-%d1%80%d0%b0%d0%b7%d0%b1%d0%b8%d0%b5%d0%bd%d0%b8%d1%8f>#</a></h2><p>Ниже представлен алгоритм вычисления критического разбиения и максимальных суффиксов строки.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>data</span> <span style=color:#00f>class</span> <span style=color:#2b91af>Factorization</span>(
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> left: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> right: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> rightPeriod: Int
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>fun</span> factorize(pattern: String): Factorization {
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> naturalOrder = computeMaxSuffixAndPeriod(pattern, naturalOrder())
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> reverseOrder = computeMaxSuffixAndPeriod(pattern, reverseOrder())
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#00f>if</span> (naturalOrder.right.length &lt;= reverseOrder.right.length)
</span></span><span style=display:flex><span>        naturalOrder <span style=color:#00f>else</span> reverseOrder
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>fun</span> computeMaxSuffixAndPeriod(pattern: String, 
</span></span><span style=display:flex><span>                              comparator: Comparator&lt;Char&gt;): Factorization<span>…</span>
</span></span></code></pre></div><p><code>computeMaxSuffixAndPeriod()</code> — функция, вычисляющая максимальный суффикс и период правой
подстроки.</p><p><strong>Пример 1</strong></p><p>Шаблон ${pattern=\tt \underlinesegment{ABA}\underlinesegment{ABA}\underlinesegment{A\space\space\space}}$<br>Период ${pattern}$: ${p=3}$</p><table><thead><tr><th>Порядок</th><th>Макс. суффикс</th><th>Разбиение</th></tr></thead><tbody><tr><td>Прямой $≤$</td><td>${\tt BAABAA}$</td><td>${(\texttt{A}, \texttt{BAABAA})}$</td></tr><tr><td>Обратный $⪯$</td><td>${\tt AABAA}$</td><td>${(\texttt{AB}, \texttt{AABAA})}$</td></tr></tbody></table><p>Разбиение для прямого порядка — не критическое, его локальный период = 2 (${\texttt{BA}}$).
Разбиение для обратного порядка — критическое.</p><p><strong>Пример 2</strong></p><p>Шаблон ${pattern=\tt \underlinesegment{ABABAABB}\underlinesegment{ABABA\space\space\space\space}}$<br>Период ${pattern}$: ${p=8}$</p><table><thead><tr><th>Порядок</th><th>Макс. суффикс</th><th>Разбиение</th></tr></thead><tbody><tr><td>Прямой $≤$</td><td>${\tt BBABABA}$</td><td>${(\texttt{ABABAA}, \texttt{BBABABA})}$</td></tr><tr><td>Обратный $⪯$</td><td>${\tt AABBABABA}$</td><td>${(\texttt{ABAB}, \texttt{AABBABABA})}$</td></tr></tbody></table><p>Оба разбиения критические.</p><p>Алгоритм вычисления максимального суффикса основан на использовании декомпозиции Линдона.
Вместе с максимальным суффиксов в одном цикле вычисляется также период правой подстроки $v$.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>fun</span> computeMaxSuffixAndPeriod(pattern: String, comparator: Comparator&lt;<span style=color:#00f>in</span> Char&gt;): Factorization {
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> maxSuffix = -1
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> j = 0
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> k = 1
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> period = 1
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> (j + k &lt; pattern.length) {
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> a = pattern[j + k]
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> b = pattern[maxSuffix + k]
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> abOrder = comparator.compare(a, b)
</span></span><span style=display:flex><span>        <span style=color:#00f>when</span> {
</span></span><span style=display:flex><span>            <span style=color:green>// a &lt; b
</span></span></span><span style=display:flex><span><span style=color:green></span>            abOrder &lt; 0 -&gt; {
</span></span><span style=display:flex><span>                j += k
</span></span><span style=display:flex><span>                k = 1
</span></span><span style=display:flex><span>                period = j - maxSuffix
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:green>// a == b
</span></span></span><span style=display:flex><span><span style=color:green></span>            abOrder == 0 -&gt; {
</span></span><span style=display:flex><span>                <span style=color:#00f>if</span> (k != period) {
</span></span><span style=display:flex><span>                    k += 1
</span></span><span style=display:flex><span>                } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>                    j += period
</span></span><span style=display:flex><span>                    k = 1
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:green>// a &gt; b
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>else</span> -&gt;  {
</span></span><span style=display:flex><span>                maxSuffix = j
</span></span><span style=display:flex><span>                j = maxSuffix + 1
</span></span><span style=display:flex><span>                k = 1
</span></span><span style=display:flex><span>                period = 1
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> Factorization(0 .. maxSuffix,
</span></span><span style=display:flex><span>        maxSuffix + 1 .. pattern.lastIndex,
</span></span><span style=display:flex><span>        period
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Обозначим через ${Maxsuf(x)}$ максимальный суффикс строки $x$ в соответствии с алфавитным
порядком.</p><p>Пусть ${Maxsuf(x)=f^eg}$, где:<br>$f$, $g$ — подстроки<br>${|f|=per(Maxsuf(x))}$ (длина $f$ — это период строки максимального суффикса)<br>$g$ — собственный префикс подстроки $f$;<br>$e$ — целое число $e>0$.<br>Введем обозначения: ${Per(x)=f; \space Rest(x)=g}$<br>Отметим, что ${Rest(x)}$ — это грань строки ${Maxsuf(x)}$ и ${Border(Maxsuf(x))=f^{e-1}g}$, даже при ${e=1}$.</p><p>Переменная <code>maxSuffix</code> в алгоритме — позиция перед первым символом рассматриваемой строки
максимального суффикса.<br><code>period</code> — период строки максимального суффикса, длина ${Per(x)}$.<br><code>j</code> … <code>j+k</code> — подстрока в ${Maxsuf(x)}$ последнего встреченного вхождения ${Rest(x)}$ в
подстроке максимального суффикса.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 265"><g transform="translate(8,16)"><path d="M152 0H696" fill="none" stroke="currentcolor"/><path d="M152 32H696" fill="none" stroke="currentcolor"/><path d="M16 64H120" fill="none" stroke="currentcolor"/><path d="M120 64h32" fill="none" stroke="currentcolor"/><path d="M152 64h88" fill="none" stroke="currentcolor"/><path d="M240 64h32" fill="none" stroke="currentcolor"/><path d="M272 64H696" fill="none" stroke="currentcolor"/><path d="M696 64h32" fill="none" stroke="currentcolor"/><path d="M728 64h64" fill="none" stroke="currentcolor"/><path d="M16 96H120" fill="none" stroke="currentcolor"/><path d="M120 96h32" fill="none" stroke="currentcolor"/><path d="M152 96h88" fill="none" stroke="currentcolor"/><path d="M240 96h32" fill="none" stroke="currentcolor"/><path d="M272 96H696" fill="none" stroke="currentcolor"/><path d="M696 96h32" fill="none" stroke="currentcolor"/><path d="M728 96h64" fill="none" stroke="currentcolor"/><path d="M152 144H304" fill="none" stroke="currentcolor"/><path d="M456 144H608" fill="none" stroke="currentcolor"/><path d="M608 144h88" fill="none" stroke="currentcolor"/><path d="M152 176H304" fill="none" stroke="currentcolor"/><path d="M456 176H608" fill="none" stroke="currentcolor"/><path d="M608 176h88" fill="none" stroke="currentcolor"/><path d="M152 208h88" fill="none" stroke="currentcolor"/><path d="M152 240h88" fill="none" stroke="currentcolor"/><path d="M16 64V96" fill="none" stroke="currentcolor"/><path d="M120 64V96" fill="none" stroke="currentcolor"/><path d="M152 0V32" fill="none" stroke="currentcolor"/><path d="M152 64V96" fill="none" stroke="currentcolor"/><path d="M152 144v32" fill="none" stroke="currentcolor"/><path d="M152 208v32" fill="none" stroke="currentcolor"/><path d="M240 64V96" fill="none" stroke="currentcolor"/><path d="M240 208v32" fill="none" stroke="currentcolor"/><path d="M272 64V96" fill="none" stroke="currentcolor"/><path d="M304 144v32" fill="none" stroke="currentcolor"/><path d="M456 144v32" fill="none" stroke="currentcolor"/><path d="M608 144v32" fill="none" stroke="currentcolor"/><path d="M696 0V32" fill="none" stroke="currentcolor"/><path d="M696 64V96" fill="none" stroke="currentcolor"/><path d="M696 144v32" fill="none" stroke="currentcolor"/><path d="M728 64V96" fill="none" stroke="currentcolor"/><path d="M792 64V96" fill="none" stroke="currentcolor"/><text text-anchor="middle" x="0" y="84" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="116" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="136" y="116" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="152" y="52" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="152" y="116" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="152" y="132" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="152" y="196" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="168" y="228" fill="currentcolor" style="font-size:1em">R</text><text text-anchor="middle" x="176" y="164" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="176" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="184" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="184" y="228" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="192" y="164" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="192" y="228" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="200" y="164" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="200" y="228" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="208" y="164" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="208" y="228" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="216" y="164" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="216" y="228" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="224" y="164" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="232" y="164" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="240" y="116" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="240" y="132" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="240" y="164" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="240" y="196" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="248" y="196" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="256" y="84" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="256" y="196" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="264" y="84" fill="currentcolor" style="font-size:1em">'</text><text text-anchor="middle" x="264" y="196" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="272" y="20" fill="currentcolor" style="font-size:1em">M</text><text text-anchor="middle" x="272" y="196" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="280" y="20" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="288" y="20" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="296" y="20" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="304" y="20" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="312" y="20" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="320" y="20" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="328" y="20" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="328" y="164" fill="currentcolor" style="font-size:1em">…</text><text text-anchor="middle" x="336" y="20" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="352" y="164" fill="currentcolor" style="font-size:1em">…</text><text text-anchor="middle" x="376" y="164" fill="currentcolor" style="font-size:1em">…</text><text text-anchor="middle" x="408" y="164" fill="currentcolor" style="font-size:1em">…</text><text text-anchor="middle" x="432" y="164" fill="currentcolor" style="font-size:1em">…</text><text text-anchor="middle" x="472" y="164" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="480" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="488" y="164" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="496" y="164" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="504" y="164" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="512" y="164" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="520" y="164" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="528" y="164" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="536" y="164" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="608" y="84" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="608" y="116" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="608" y="132" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="616" y="116" fill="currentcolor" style="font-size:1em">j</text><text text-anchor="middle" x="624" y="164" fill="currentcolor" style="font-size:1em">R</text><text text-anchor="middle" x="632" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="640" y="164" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="648" y="164" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="656" y="164" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="664" y="164" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="672" y="164" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="696" y="116" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="696" y="132" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="704" y="116" fill="currentcolor" style="font-size:1em">j</text><text text-anchor="middle" x="712" y="84" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="712" y="116" fill="currentcolor" style="font-size:1em">+</text><text text-anchor="middle" x="720" y="116" fill="currentcolor" style="font-size:1em">k</text></g></svg></div><p>Алгоритм выполняется за время ${O(|pattern|)}$, при этом выполняется менее ${2*|pattern|}$
сравнений.</p><p>Рассмотрим на примере, как изменяется максимальный суффикс строки $x$ при добавлении в её
конец символов $\texttt{A}, \texttt{B}\text{ и }\texttt{C}$.</p><p>Пусть ${x=\tt ABCBCBACBCBACBC}$. В соответствии с алфавитным порядком её максимальный суффикс равен
${Maxsuf(x)=\texttt{CBCBACBCBACBC}=(\texttt{CBCBA})²\texttt{CBC}}$.<br>Макс. суффикс для строки ${x\texttt{A}}$: ${\tt CBCBACBCBACBCA}$ = ${Maxsuf(x)\texttt{A}}$. Слово
без границ.<br>Макс. суффикс для строки ${x\texttt{B}}$: ${\tt CBCBACBCBACBCB}$ = ${Maxsuf(x)\texttt{B}}$. У
строки такой же период, как и у ${Maxsuf(x)}$.<br>Макс. суффикс для строки ${x\texttt{C}}$: ${\tt CC}$.</p><p>Доказательство корректности алгоритма основывается на следующей лемме.</p><dl><dt><strong>Лемма</strong></dt><dd><p>Возьмем строку $x$, символ $\tt A$ и символ ${\texttt{A&rsquo;}}$ такой, что
${Rest(x)\texttt{A&rsquo;}}$ — это префикс ${Maxsuf(x)}$. Тогда значения
${Maxsuf(x\texttt{A}), Per(x\texttt{A}), Rest(x\texttt{A})}$ будут равны следующим:</p><table><thead><tr><th><strong>Условие</strong></th><th>$\bf Maxsuf(x\texttt{A})$</th><th>$\bf Per(x\texttt{A})$</th><th>$\bf Rest(x\texttt{A})$</th></tr></thead><tbody><tr><td>${\texttt{A} &lt; \texttt{A&rsquo;}}$</td><td>${Maxsuf(x)\texttt{A}}$</td><td>${Maxsuf(x)\texttt{A}}$</td><td>$ε$</td></tr><tr><td>${\texttt{A} = \texttt{A&rsquo;}}$</td><td>${Maxsuf(x)\texttt{A}}$</td><td>${Per(x)}$</td><td>${Rest(x)\texttt{A}}$, либо $ε$</td></tr><tr><td>${\texttt{A} > \texttt{A&rsquo;}}$</td><td>${Maxsuf(Rest(x)\texttt{A})}$</td><td>${Per(Rest(x)\texttt{A})}$</td><td>${Rest(Rest(x)\texttt{A})}$</td></tr></tbody></table><p>Доказательство дано в <a href=#reference_text_algorithms>[1]</a>.</p></dd></dl><h2 id=реализация-алгоритма>Реализация алгоритма
<a class=anchor href=#%d1%80%d0%b5%d0%b0%d0%bb%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc%d0%b0>#</a></h2><p>Ниже приведена полная реализация алгоритма (на Kotlin, без учета суррогатных пар).</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>internal</span> <span style=color:#00f>data</span> <span style=color:#00f>class</span> <span style=color:#2b91af>Factorization</span>(
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> pattern: String,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> left: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> right: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> rightPeriod: Int
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    <span style=color:#00f>fun</span> leftIsSuffixOfRight(): Boolean {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> left.all {
</span></span><span style=display:flex><span>            i -&gt; pattern[i] == pattern[right.first + rightPeriod - left.length + i]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>fun</span> findSubstringTwoWay(text: String, pattern: String): List&lt;Int&gt; {
</span></span><span style=display:flex><span>    <span style=color:#00f>when</span> {
</span></span><span style=display:flex><span>        text.isEmpty() -&gt; <span style=color:#00f>return</span> emptyList()
</span></span><span style=display:flex><span>        pattern.isEmpty() -&gt; <span style=color:#00f>return</span> text.indices.toList()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> result: MutableList&lt;Int&gt; = mutableListOf()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> factorization = factorize(pattern)
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (factorization.leftIsSuffixOfRight()) {
</span></span><span style=display:flex><span>        <span style=color:green>// CP1
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>val</span> <span>(</span>_, left, right, period) = factorization
</span></span><span style=display:flex><span>        <span style=color:#00f>var</span> pos = 0
</span></span><span style=display:flex><span>        <span style=color:#00f>var</span> memPrefix = -1
</span></span><span style=display:flex><span>        <span style=color:#00f>while</span> (pos + pattern.length &lt;= text.length) {
</span></span><span style=display:flex><span>            <span style=color:green>// Сравнение правой части
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>val</span> i = (maxOf(right.first, memPrefix + 1)..right.last).find { i -&gt;
</span></span><span style=display:flex><span>                pattern[i] != text[pos + i]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#00f>if</span> (i != <span style=color:#00f>null</span>) {
</span></span><span style=display:flex><span>                pos = pos + i - right.first + 1
</span></span><span style=display:flex><span>                memPrefix = -1
</span></span><span style=display:flex><span>            } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>                <span style=color:green>// Сравнение левой части
</span></span></span><span style=display:flex><span><span style=color:green></span>                <span style=color:#00f>val</span> match = (left.last downTo memPrefix + 1).all { j -&gt;
</span></span><span style=display:flex><span>                    pattern[j] == text[pos + j]
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                <span style=color:#00f>if</span> (match) result.add(pos)
</span></span><span style=display:flex><span>                pos += period
</span></span><span style=display:flex><span>                memPrefix = pattern.length - period - 1
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>        <span style=color:green>// CP2
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>val</span> left = factorization.left.reversed()
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> right = factorization.right
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> q = maxOf(left.length, right.length) + 1
</span></span><span style=display:flex><span>        <span style=color:#00f>var</span> pos = 0
</span></span><span style=display:flex><span>        <span style=color:#00f>while</span> (pos + pattern.length &lt;= text.length) {
</span></span><span style=display:flex><span>            <span style=color:green>// Сравнение правой части
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>val</span> i = right.find { i -&gt; pattern[i] != text[pos + i] }
</span></span><span style=display:flex><span>            <span style=color:#00f>if</span> (i != <span style=color:#00f>null</span>) {
</span></span><span style=display:flex><span>                pos = pos + i - right.first + 1
</span></span><span style=display:flex><span>            } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>                <span style=color:green>// Сравнение левой части
</span></span></span><span style=display:flex><span><span style=color:green></span>                <span style=color:#00f>val</span> match = left.all { j -&gt; pattern[j] == text[pos + j] }
</span></span><span style=display:flex><span>                <span style=color:#00f>if</span> (match) result.add(pos)
</span></span><span style=display:flex><span>                pos += q
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> result
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>private</span> <span style=color:#00f>fun</span> factorize(pattern: String): Factorization {
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> naturalOrder = computeMaxSuffixAndPeriod(pattern, naturalOrder())
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> reverseOrder = computeMaxSuffixAndPeriod(pattern, reverseOrder())
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#00f>if</span> (naturalOrder.right.length &lt;= reverseOrder.right.length)
</span></span><span style=display:flex><span>        naturalOrder <span style=color:#00f>else</span> reverseOrder
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>internal</span> <span style=color:#00f>fun</span> computeMaxSuffixAndPeriod(pattern: String,
</span></span><span style=display:flex><span>                                       comparator: Comparator&lt;<span style=color:#00f>in</span> Char&gt;): Factorization {
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> maxSuffix = -1
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> j = 0
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> k = 1
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> period = 1
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> (j + k &lt; pattern.length) {
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> a = pattern[j + k]
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> b = pattern[maxSuffix + k]
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> abOrder = comparator.compare(a, b)
</span></span><span style=display:flex><span>        <span style=color:#00f>when</span> {
</span></span><span style=display:flex><span>            <span style=color:green>// a &lt; b
</span></span></span><span style=display:flex><span><span style=color:green></span>            abOrder &lt; 0 -&gt; {
</span></span><span style=display:flex><span>                j += k
</span></span><span style=display:flex><span>                k = 1
</span></span><span style=display:flex><span>                period = j - maxSuffix
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:green>// a == b
</span></span></span><span style=display:flex><span><span style=color:green></span>            abOrder == 0 -&gt; {
</span></span><span style=display:flex><span>                <span style=color:#00f>if</span> (k != period) {
</span></span><span style=display:flex><span>                    k += 1
</span></span><span style=display:flex><span>                } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>                    j += period
</span></span><span style=display:flex><span>                    k = 1
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:green>// a &gt; b
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>else</span> -&gt; {
</span></span><span style=display:flex><span>                maxSuffix = j
</span></span><span style=display:flex><span>                j = maxSuffix + 1
</span></span><span style=display:flex><span>                k = 1
</span></span><span style=display:flex><span>                period = 1
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> Factorization(
</span></span><span style=display:flex><span>        pattern,
</span></span><span style=display:flex><span>        0..maxSuffix,
</span></span><span style=display:flex><span>        maxSuffix + 1..pattern.lastIndex,
</span></span><span style=display:flex><span>        period
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Она же в репозитории: <a href=https://github.com/illarionov/strstr/blob/main/code/src/main/kotlin/substring/TwoWay.kt>twoway.kt</a>.</p><h2 id=источники>Источники
<a class=anchor href=#%d0%b8%d1%81%d1%82%d0%be%d1%87%d0%bd%d0%b8%d0%ba%d0%b8>#</a></h2><ol><li id=reference_text_algorithms>CROCHEMORE, M., RYTTER, W., 1994, Text Algorithms, Oxford University Press. (<a href=https://www-igm.univ-mlv.fr/~mac/REC/B1.html>ссылка</a>)</li><li id=reference_twoway_string_matching>CROCHEMORE M., PERRIN D., 1991, Two-way string-matching, Journal of the ACM 38(3):651-675. (<a href=https://monge.univ-mlv.fr/~mac/Articles-PDF/CP-1991-jacm.pdf>ссылка</a>)</li><li id=reference_twoway_wikipedia>Wikipedia: Two-way string-matching algorithm (<a href=https://en.wikipedia.org/wiki/Two-way_string-matching_algorithm>ссылка</a>).</li><li id=reference_twoway_itmo>Викиконспекты ИТМО: Двусторонний алгоритм (<a href="https://neerc.ifmo.ru/wiki/index.php?title=%D0%94%D0%B2%D1%83%D1%81%D1%82%D0%BE%D1%80%D0%BE%D0%BD%D0%BD%D0%B8%D0%B9_%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC">ссылка</a>).</li><li id=reference_kutelin_clickhouse>Кутенин Данила М., 2019. Умные алгоритмы обработки строк в ClickHouse (<a href=https://www.hse.ru/edu/vkr/296308510>ссылка</a>)</li><li id=reference_galil_seiferas>Galil-Seiferas algorithm (<a href=http://www-igm.univ-mlv.fr/~lecroq/string/node25.html#SECTION00250>ссылка</a>)</li></ol></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/illarionov/strstr/commit/a85f143cfbe016c29d3e8e0d63adfee7178127ea title='Последнее изменение от Alexey Illarionov | 2025-01-27' target=_blank rel=noopener><img src=./svg/calendar.svg class=book-icon alt>
<span>2025-01-27</span></a></div><div><a class="flex align-center" href=https://github.com/illarionov/strstr/edit/main/content/_index.md target=_blank rel=noopener><img src=./svg/edit.svg class=book-icon alt>
<span>Редактировать эту страницу</span></a></div></div></footer><div class=book-comments><script src=https://utteranc.es/client.js data-repo=illarionov/strstr data-issue-term=title data-label=comment data-theme=github-light crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#двусторонний-алгоритм>Двусторонний алгоритм</a><ul><li><a href=#общая-схема>Общая схема</a></li><li><a href=#базовые-понятия>Базовые понятия</a></li><li><a href=#описание-алгоритма>Описание алгоритма</a><ul><li></li></ul></li><li><a href=#теорема-о-критическом-разбиении>Теорема о критическом разбиении</a></li><li><a href=#вычисление-критического-разбиения>Вычисление критического разбиения</a></li><li><a href=#реализация-алгоритма>Реализация алгоритма</a></li><li><a href=#источники>Источники</a></li></ul></li></ul></nav></div></aside></main></body></html>