<!doctype html><html lang=ru-ru dir=ltr><head><meta name=generator content="Hugo 0.147.7"><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Двусторонний алгоритм поиска подстроки в строке"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://strstr.0xdc.ru/"><meta property="og:site_name" content="Поиск подстроки в строке"><meta property="og:title" content="Двусторонний алгоритм"><meta property="og:description" content="Двусторонний алгоритм поиска подстроки в строке"><meta property="og:locale" content="ru_ru"><meta property="og:type" content="website"><title>Двусторонний алгоритм | Поиск подстроки в строке</title><link rel=icon href=./favicon.png><link rel=manifest href=./manifest.json><link rel=canonical href=https://strstr.0xdc.ru/><link rel=stylesheet href=./book.min.9b578a8ab891ebe65ebff8fe86f29a46935f8f0c3f37b47f7f62652fb36028b1.css integrity="sha256-m1eKiriR6+Zev/j+hvKaRpNfjww/N7R/f2JlL7NgKLE=" crossorigin=anonymous><link rel=alternate type=application/rss+xml href=https://strstr.0xdc.ru/index.xml title="Поиск подстроки в строке"><link href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css rel=stylesheet><link rel=preload href=https://fonts.gstatic.com/s/roboto/v32/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://fonts.gstatic.com/s/roboto/v32/KFOlCnqEu92Fr1MmWUlfBBc4AMP6lQ.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://fonts.gstatic.com/s/robotomono/v23/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_ROW4AJi8SJQt.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/fonts/KaTeX_Main-Regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/fonts/KaTeX_Main-Bold.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/fonts/KaTeX_Math-Italic.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/fonts/KaTeX_Typewriter-Regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/fonts/KaTeX_Main-BoldItalic.woff2 as=font type=font/woff2 crossorigin></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=./><span>Поиск подстроки в строке</span></a></h2><ul><li><a href=https://github.com/illarionov/strstr target=_blank rel=noopener>Github</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=./svg/menu.svg class=book-icon alt=Menu></label><h3>Двусторонний алгоритм</h3><label for=toc-control><img src=./svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#двусторонний-алгоритм>Двусторонний алгоритм</a><ul><li><a href=#общая-схема>Общая схема</a></li><li><a href=#базовые-понятия>Базовые понятия</a></li><li><a href=#описание-алгоритма>Описание алгоритма</a><ul><li></li></ul></li><li><a href=#теорема-о-критическом-разбиении>Теорема о критическом разбиении</a></li><li><a href=#вычисление-критического-разбиения>Вычисление критического разбиения</a></li><li><a href=#реализация-алгоритма>Реализация алгоритма</a></li><li><a href=#источники>Источники</a></li></ul></li></ul></nav></aside></header><script>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),ym(89172637,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/89172637 style=position:absolute;left:-9999px alt></div></noscript><article class="markdown book-article"><h1 id=двусторонний-алгоритм>Двусторонний алгоритм
<a class=anchor href=#%d0%b4%d0%b2%d1%83%d1%81%d1%82%d0%be%d1%80%d0%be%d0%bd%d0%bd%d0%b8%d0%b9-%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc>#</a></h1><p><strong>Двусторонний алгоритм</strong> (англ. <em>Two-Way String-Matching algorithm</em>) — алгоритм поиска
подстроки в строке, разработанный и представленный Максимом Крочемором (Maxime Crochemore)
и Домиником Перреном (Dominique Perrin) в 1991 году.<a href=#reference_twoway_string_matching>[2]</a>
Относится к группе алгоритмов поиска подстроки с ограниченным потреблением памяти,
константным на практике (constant-space string matching).</p><p>По заданной строке <em>Text</em> длины <em>n</em> и шаблону поиска <em>Pattern</em> длины <em>m</em> алгоритм
позволяет найти все вхождения <em>Pattern</em> в <em>Text</em> за время <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(n+m)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>O</span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span></span>, где <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(m)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>O</span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span></span> — этап
предварительных вычислений над шаблоном, а <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(n)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>O</span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span></span> — этап поиска. При этом, во время поиска
выполняется не более <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi><mo>−</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">{2n-m}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7278em;vertical-align:-.0833em></span><span class=mord><span class=mord>2</span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal">m</span></span></span></span></span> операций сравнения.</p><p>В отличие от алгоритмов Кнута-Морриса-Пратта и Бойера-Мура, данный алгоритм требует
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(\log(m))}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>O</span><span class=mopen>(</span><span class=mop>lo<span style=margin-right:.01389em>g</span></span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>))</span></span></span></span></span> памяти: на этапе препроцессинга строка шаблона разбивается на 2 подстроки и
хранится только позиция этого разбиения. Численное значение этой позиции меньше длины
шаблона <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">m</span></span></span></span>, поэтому требование по памяти может быть представлено как
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>m</mi><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">{\lceil\log_2m\rceil}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>⌈</span><span class=mop><span class=mop>lo<span style=margin-right:.01389em>g</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.207em><span style=top:-2.4559em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2441em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">m</span><span class=mclose>⌉</span></span></span></span></span> бит и на практике может быть взято за <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(1)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>O</span><span class=mopen>(</span><span class=mord>1</span><span class=mclose>)</span></span></span></span></span>.</p><p>Другое отличие данного алгоритма заключается в том, что ему требуется упорядоченный
алфавит, так как во время препроцессинга символы сравниваются на больше и меньше.</p><p>Алгоритм в целом считается достаточно эффективным и благодаря тому, что потребление памяти
практически не зависит от длины текста или шаблона, он используется в реализациях функций
<code>strstr()</code>, <code>memem()</code> некоторых вариантов библиотек libc: <a href=https://github.com/bminor/glibc/blob/a01a13601c95f5d111d25557656d09fe661cfc89/string/strstr.c#L74>glibc</a>, <a href="https://sourceware.org/git/?p=newlib-cygwin.git;a=blob;f=newlib/libc/string/memmem.c;h=65267b9c5e52b15db86feec5b7a511d927ec469a;hb=HEAD#l112">newlib</a> <a href=https://git.musl-libc.org/cgit/musl/tree/src/string/strstr.c#n33>musl</a> при
достаточно длинной строке шаблона.</p><h2 id=общая-схема>Общая схема
<a class=anchor href=#%d0%be%d0%b1%d1%89%d0%b0%d1%8f-%d1%81%d1%85%d0%b5%d0%bc%d0%b0>#</a></h2><p>Сканирование строки на этапе поиска двустороннего алгоритма похоже на сканирование в
примитивном алгоритме, алгоритмах Кнута-Морриса-Пратта и Бойера-Мура.</p><p>В алгоритме Кнута-Морриса-Пратта строка сканируется слева направо, сравнение символов
шаблона с символами текста также выполняется слева направо. Когда происходит несовпадение
в какой-то позиции шаблона (либо все символы шаблона равны и найдено вхождение), шаблон
сдвигается вправо на несколько позиций по заранее вычисленной таблице сдвигов паттернов
поиска.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 393"><g transform="translate(8,16)"><path d="M80 0h32" fill="none" stroke="currentColor"/><path d="M112 0h32" fill="none" stroke="currentColor"/><path d="M144 0h32" fill="none" stroke="currentColor"/><path d="M176 0h32" fill="none" stroke="currentColor"/><path d="M208 0h32" fill="none" stroke="currentColor"/><path d="M240 0h32" fill="none" stroke="currentColor"/><path d="M272 0h32" fill="none" stroke="currentColor"/><path d="M304 0h32" fill="none" stroke="currentColor"/><path d="M336 0h32" fill="none" stroke="currentColor"/><path d="M368 0h32" fill="none" stroke="currentColor"/><path d="M4e2.0h32" fill="none" stroke="currentColor"/><path d="M432 0h32" fill="none" stroke="currentColor"/><path d="M464 0h32" fill="none" stroke="currentColor"/><path d="M496 0h32" fill="none" stroke="currentColor"/><path d="M528 0h32" fill="none" stroke="currentColor"/><path d="M560 0h32" fill="none" stroke="currentColor"/><path d="M592 0h32" fill="none" stroke="currentColor"/><path d="M624 0h32" fill="none" stroke="currentColor"/><path d="M656 0h32" fill="none" stroke="currentColor"/><path d="M688 0h32" fill="none" stroke="currentColor"/><path d="M720 0h32" fill="none" stroke="currentColor"/><path d="M80 48H752" fill="none" stroke="currentColor"/><path d="M80 80H752" fill="none" stroke="currentColor"/><path d="M224 112H344" fill="none" stroke="currentColor"/><path d="M96 128H296" fill="none" stroke="currentColor"/><path d="M96 160H296" fill="none" stroke="currentColor"/><path d="M192 208H392" fill="none" stroke="currentColor"/><path d="M96 224h72" fill="none" stroke="currentColor"/><path d="M192 240H392" fill="none" stroke="currentColor"/><path d="M224 288H424" fill="none" stroke="currentColor"/><path d="M224 320H424" fill="none" stroke="currentColor"/><path d="M80 0V16" fill="none" stroke="currentColor"/><path d="M80 48V80" fill="none" stroke="currentColor"/><path d="M96 160v64" fill="none" stroke="currentColor"/><path d="M112 0V16" fill="none" stroke="currentColor"/><path d="M144 0V16" fill="none" stroke="currentColor"/><path d="M176 0V16" fill="none" stroke="currentColor"/><path d="M208 0V16" fill="none" stroke="currentColor"/><path d="M240 0V16" fill="none" stroke="currentColor"/><path d="M272 0V16" fill="none" stroke="currentColor"/><path d="M304 0V16" fill="none" stroke="currentColor"/><path d="M336 0V16" fill="none" stroke="currentColor"/><path d="M368 0V16" fill="none" stroke="currentColor"/><path d="M4e2.0V16" fill="none" stroke="currentColor"/><path d="M432 0V16" fill="none" stroke="currentColor"/><path d="M464 0V16" fill="none" stroke="currentColor"/><path d="M496 0V16" fill="none" stroke="currentColor"/><path d="M528 0V16" fill="none" stroke="currentColor"/><path d="M560 0V16" fill="none" stroke="currentColor"/><path d="M592 0V16" fill="none" stroke="currentColor"/><path d="M624 0V16" fill="none" stroke="currentColor"/><path d="M656 0V16" fill="none" stroke="currentColor"/><path d="M688 0V16" fill="none" stroke="currentColor"/><path d="M720 0V16" fill="none" stroke="currentColor"/><path d="M752 0V16" fill="none" stroke="currentColor"/><path d="M752 48V80" fill="none" stroke="currentColor"/><polygon points="176.000000,224.000000 164.000000,218.399994 164.000000,229.600006" fill="currentColor" transform="rotate(0.000000, 168.000000, 224.000000)"/><polygon points="352.000000,112.000000 340.000000,106.400002 340.000000,117.599998" fill="currentColor" transform="rotate(0.000000, 344.000000, 112.000000)"/><path d="M96 128A16 16 0 0080 144" fill="none" stroke="currentColor"/><path d="M296 128a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M80 144a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M312 144a16 16 0 01-16 16" fill="none" stroke="currentColor"/><path d="M192 208a16 16 0 00-16 16" fill="none" stroke="currentColor"/><path d="M392 208a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M176 224a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M408 224a16 16 0 01-16 16" fill="none" stroke="currentColor"/><path d="M224 288a16 16 0 00-16 16" fill="none" stroke="currentColor"/><path d="M424 288a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M208 304a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M440 304a16 16 0 01-16 16" fill="none" stroke="currentColor"/><text text-anchor="middle" x="0" y="148" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="228" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="308" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="148" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="228" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="308" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="148" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="228" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="308" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="148" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="228" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="308" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="68" fill="currentColor" style="font-size:1em">T</text><text text-anchor="middle" x="32" y="148" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="228" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="308" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="68" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="148" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="228" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="308" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="68" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="148" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="228" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="308" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="68" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="148" fill="currentColor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="228" fill="currentColor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="308" fill="currentColor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="68" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="148" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="228" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="308" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="96" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="116" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="96" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="112" y="212" fill="currentColor" style="font-size:1em">С</text><text text-anchor="middle" x="120" y="212" fill="currentColor" style="font-size:1em">д</text><text text-anchor="middle" x="128" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="116" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="128" y="148" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="212" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="136" y="212" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="144" y="212" fill="currentColor" style="font-size:1em">г</text><text text-anchor="middle" x="160" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="160" y="116" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="160" y="148" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="192" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="116" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="192" y="148" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="196" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="192" y="228" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="372" fill="currentColor" style="font-size:1em">С</text><text text-anchor="middle" x="216" y="372" fill="currentColor" style="font-size:1em">к</text><text text-anchor="middle" x="224" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="224" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="228" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="224" y="276" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="308" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="372" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="232" y="100" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="232" y="372" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="240" y="100" fill="currentColor" style="font-size:1em">к</text><text text-anchor="middle" x="240" y="372" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="248" y="100" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="248" y="372" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="256" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="256" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="100" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="256" y="148" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="228" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="276" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="256" y="308" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="372" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="264" y="100" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="264" y="372" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="272" y="100" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="272" y="372" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="280" y="100" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="280" y="372" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="288" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="288" y="100" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="288" y="148" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="228" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="276" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="288" y="308" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="288" y="372" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="296" y="100" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="296" y="372" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="304" y="100" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="312" y="100" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="312" y="372" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="320" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="320" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="320" y="100" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="320" y="228" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="276" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="320" y="308" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="320" y="372" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="328" y="372" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="336" y="372" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="344" y="372" fill="currentColor" style="font-size:1em">к</text><text text-anchor="middle" x="352" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="352" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="352" y="228" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="276" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="352" y="308" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="352" y="372" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="368" y="372" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="384" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="384" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="384" y="228" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="276" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="384" y="308" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="384" y="372" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="392" y="372" fill="currentColor" style="font-size:1em">л</text><text text-anchor="middle" x="400" y="372" fill="currentColor" style="font-size:1em">г</text><text text-anchor="middle" x="408" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="408" y="372" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="416" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="276" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="416" y="308" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="416" y="372" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="424" y="372" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="432" y="372" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="440" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="440" y="372" fill="currentColor" style="font-size:1em">м</text><text text-anchor="middle" x="448" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="448" y="372" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="464" y="372" fill="currentColor" style="font-size:1em">К</text><text text-anchor="middle" x="472" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="472" y="372" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="480" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="480" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="480" y="372" fill="currentColor" style="font-size:1em">у</text><text text-anchor="middle" x="488" y="372" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="496" y="372" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="504" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="504" y="372" fill="currentColor" style="font-size:1em">-</text><text text-anchor="middle" x="512" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="512" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="512" y="372" fill="currentColor" style="font-size:1em">М</text><text text-anchor="middle" x="520" y="372" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="528" y="372" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="536" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="536" y="372" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="544" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="544" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="544" y="372" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="552" y="372" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="560" y="372" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="568" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="568" y="372" fill="currentColor" style="font-size:1em">-</text><text text-anchor="middle" x="576" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="576" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="576" y="372" fill="currentColor" style="font-size:1em">П</text><text text-anchor="middle" x="584" y="372" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="592" y="372" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="600" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="600" y="372" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="608" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="608" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="608" y="372" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="616" y="372" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="632" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="640" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="664" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="672" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="696" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="704" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="728" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="736" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="68" fill="currentColor" style="font-size:1em">B</text></g></svg></div><p>В алгоритме Бойера-Мура строка также сканируется слева направо, но символы шаблона
сравниваются справа налево. При встрече несовпадающего символа, шаблон сдвигается на
смещение, которое вычисляется как максимальное по 2 эвристикам: правилу сдвига плохого
символа и правилу хорошего суффикса.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 377"><g transform="translate(8,16)"><path d="M80 0h32" fill="none" stroke="currentColor"/><path d="M112 0h32" fill="none" stroke="currentColor"/><path d="M144 0h32" fill="none" stroke="currentColor"/><path d="M176 0h32" fill="none" stroke="currentColor"/><path d="M208 0h32" fill="none" stroke="currentColor"/><path d="M240 0h32" fill="none" stroke="currentColor"/><path d="M272 0h32" fill="none" stroke="currentColor"/><path d="M304 0h32" fill="none" stroke="currentColor"/><path d="M336 0h32" fill="none" stroke="currentColor"/><path d="M368 0h32" fill="none" stroke="currentColor"/><path d="M4e2.0h32" fill="none" stroke="currentColor"/><path d="M432 0h32" fill="none" stroke="currentColor"/><path d="M464 0h32" fill="none" stroke="currentColor"/><path d="M496 0h32" fill="none" stroke="currentColor"/><path d="M528 0h32" fill="none" stroke="currentColor"/><path d="M560 0h32" fill="none" stroke="currentColor"/><path d="M592 0h32" fill="none" stroke="currentColor"/><path d="M624 0h32" fill="none" stroke="currentColor"/><path d="M656 0h32" fill="none" stroke="currentColor"/><path d="M688 0h32" fill="none" stroke="currentColor"/><path d="M720 0h32" fill="none" stroke="currentColor"/><path d="M80 48H752" fill="none" stroke="currentColor"/><path d="M80 80H752" fill="none" stroke="currentColor"/><path d="M136 112H256" fill="none" stroke="currentColor"/><path d="M96 128H352" fill="none" stroke="currentColor"/><path d="M96 160H344" fill="none" stroke="currentColor"/><path d="M344 160h8" fill="none" stroke="currentColor"/><path d="M320 208H584" fill="none" stroke="currentColor"/><path d="M96 224H296" fill="none" stroke="currentColor"/><path d="M320 240H584" fill="none" stroke="currentColor"/><path d="M416 288H680" fill="none" stroke="currentColor"/><path d="M416 320H680" fill="none" stroke="currentColor"/><path d="M80 0V16" fill="none" stroke="currentColor"/><path d="M80 48V80" fill="none" stroke="currentColor"/><path d="M96 160v64" fill="none" stroke="currentColor"/><path d="M112 0V16" fill="none" stroke="currentColor"/><path d="M144 0V16" fill="none" stroke="currentColor"/><path d="M176 0V16" fill="none" stroke="currentColor"/><path d="M208 0V16" fill="none" stroke="currentColor"/><path d="M240 0V16" fill="none" stroke="currentColor"/><path d="M272 0V16" fill="none" stroke="currentColor"/><path d="M304 0V16" fill="none" stroke="currentColor"/><path d="M336 0V16" fill="none" stroke="currentColor"/><path d="M368 0V16" fill="none" stroke="currentColor"/><path d="M4e2.0V16" fill="none" stroke="currentColor"/><path d="M432 0V16" fill="none" stroke="currentColor"/><path d="M464 0V16" fill="none" stroke="currentColor"/><path d="M496 0V16" fill="none" stroke="currentColor"/><path d="M528 0V16" fill="none" stroke="currentColor"/><path d="M560 0V16" fill="none" stroke="currentColor"/><path d="M592 0V16" fill="none" stroke="currentColor"/><path d="M624 0V16" fill="none" stroke="currentColor"/><path d="M656 0V16" fill="none" stroke="currentColor"/><path d="M688 0V16" fill="none" stroke="currentColor"/><path d="M720 0V16" fill="none" stroke="currentColor"/><path d="M752 0V16" fill="none" stroke="currentColor"/><path d="M752 48V80" fill="none" stroke="currentColor"/><polygon points="144.000000,112.000000 132.000000,106.400002 132.000000,117.599998" fill="currentColor" transform="rotate(180.000000, 136.000000, 112.000000)"/><polygon points="304.000000,224.000000 292.000000,218.399994 292.000000,229.600006" fill="currentColor" transform="rotate(0.000000, 296.000000, 224.000000)"/><path d="M96 128A16 16 0 0080 144" fill="none" stroke="currentColor"/><path d="M352 128a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M80 144a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M368 144a16 16 0 01-16 16" fill="none" stroke="currentColor"/><path d="M320 208a16 16 0 00-16 16" fill="none" stroke="currentColor"/><path d="M584 208a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M304 224a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M6e2 224a16 16 0 01-16 16" fill="none" stroke="currentColor"/><path d="M416 288a16 16 0 00-16 16" fill="none" stroke="currentColor"/><path d="M680 288a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M4e2 304a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M696 304a16 16 0 01-16 16" fill="none" stroke="currentColor"/><text text-anchor="middle" x="0" y="148" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="228" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="308" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="148" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="228" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="308" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="148" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="228" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="308" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="148" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="228" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="308" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="68" fill="currentColor" style="font-size:1em">T</text><text text-anchor="middle" x="32" y="148" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="228" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="308" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="68" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="148" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="228" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="308" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="68" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="148" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="228" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="308" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="68" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="148" fill="currentColor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="228" fill="currentColor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="308" fill="currentColor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="68" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="148" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="228" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="308" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="96" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="128" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="148" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="136" y="212" fill="currentColor" style="font-size:1em">С</text><text text-anchor="middle" x="144" y="212" fill="currentColor" style="font-size:1em">д</text><text text-anchor="middle" x="152" y="100" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="152" y="212" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="160" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="100" fill="currentColor" style="font-size:1em">к</text><text text-anchor="middle" x="160" y="148" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="160" y="212" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="168" y="100" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="168" y="212" fill="currentColor" style="font-size:1em">г</text><text text-anchor="middle" x="176" y="100" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="184" y="100" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="192" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="192" y="100" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="192" y="148" fill="currentColor" style="font-size:1em">X</text><text text-anchor="middle" x="200" y="100" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="208" y="100" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="216" y="100" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="216" y="356" fill="currentColor" style="font-size:1em">С</text><text text-anchor="middle" x="224" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="224" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="224" y="100" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="224" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="356" fill="currentColor" style="font-size:1em">к</text><text text-anchor="middle" x="232" y="100" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="232" y="356" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="240" y="100" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="240" y="356" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="248" y="356" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="256" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="256" y="68" fill="currentColor" style="font-size:1em">X</text><text text-anchor="middle" x="256" y="148" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="356" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="264" y="356" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="272" y="356" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="280" y="356" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="288" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="68" fill="currentColor" style="font-size:1em">F</text><text text-anchor="middle" x="288" y="116" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="288" y="148" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="288" y="356" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="296" y="356" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="304" y="356" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="320" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="320" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="320" y="116" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="320" y="148" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="320" y="228" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="356" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="328" y="356" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="336" y="356" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="344" y="356" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="352" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="352" y="68" fill="currentColor" style="font-size:1em">E</text><text text-anchor="middle" x="352" y="116" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="352" y="148" fill="currentColor" style="font-size:1em">E</text><text text-anchor="middle" x="352" y="228" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="356" fill="currentColor" style="font-size:1em">к</text><text text-anchor="middle" x="360" y="356" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="376" y="356" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="384" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="384" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="228" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="392" y="356" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="400" y="356" fill="currentColor" style="font-size:1em">л</text><text text-anchor="middle" x="408" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="408" y="356" fill="currentColor" style="font-size:1em">г</text><text text-anchor="middle" x="416" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="68" fill="currentColor" style="font-size:1em">E</text><text text-anchor="middle" x="416" y="228" fill="currentColor" style="font-size:1em">X</text><text text-anchor="middle" x="416" y="308" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="416" y="356" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="424" y="356" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="432" y="356" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="440" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="440" y="356" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="448" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="448" y="228" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="448" y="308" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="448" y="356" fill="currentColor" style="font-size:1em">м</text><text text-anchor="middle" x="456" y="356" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="472" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="472" y="356" fill="currentColor" style="font-size:1em">Б</text><text text-anchor="middle" x="480" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="480" y="68" fill="currentColor" style="font-size:1em">X</text><text text-anchor="middle" x="480" y="228" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="480" y="308" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="480" y="356" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="488" y="356" fill="currentColor" style="font-size:1em">й</text><text text-anchor="middle" x="496" y="356" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="504" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="504" y="356" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="512" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="512" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="512" y="228" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="512" y="276" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="512" y="308" fill="currentColor" style="font-size:1em">X</text><text text-anchor="middle" x="512" y="356" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="520" y="356" fill="currentColor" style="font-size:1em">-</text><text text-anchor="middle" x="528" y="356" fill="currentColor" style="font-size:1em">М</text><text text-anchor="middle" x="536" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="536" y="356" fill="currentColor" style="font-size:1em">у</text><text text-anchor="middle" x="544" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="544" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="544" y="228" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="544" y="276" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="544" y="308" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="544" y="356" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="552" y="356" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="568" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="576" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="576" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="576" y="196" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="576" y="228" fill="currentColor" style="font-size:1em">E</text><text text-anchor="middle" x="576" y="276" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="576" y="308" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="600" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="608" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="608" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="608" y="276" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="608" y="308" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="632" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="640" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="640" y="276" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="640" y="308" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="664" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="672" y="68" fill="currentColor" style="font-size:1em">E</text><text text-anchor="middle" x="672" y="276" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="672" y="308" fill="currentColor" style="font-size:1em">E</text><text text-anchor="middle" x="696" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="704" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="728" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="736" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="68" fill="currentColor" style="font-size:1em">C</text></g></svg></div><p>В двустороннем алгоритме строка шаблона делится на 2 подстроки: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span>. Сначала
сравнивается правая подстрока <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span> слева направо, затем, если все символы правой подстроки
совпали, то сравнивается левая подстрока <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> справа налево. Если встречается несовпадающий
символ, то шаблон сдвигается вправо на некоторое количество позиций. Правила сдвигов при
несовпадении разные для правой и левой части разбиения. Величина сдвига вычисляется за
константное время и константную память.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 441"><g transform="translate(8,16)"><path d="M80 0h32" fill="none" stroke="currentColor"/><path d="M112 0h32" fill="none" stroke="currentColor"/><path d="M144 0h32" fill="none" stroke="currentColor"/><path d="M176 0h32" fill="none" stroke="currentColor"/><path d="M208 0h32" fill="none" stroke="currentColor"/><path d="M240 0h32" fill="none" stroke="currentColor"/><path d="M272 0h32" fill="none" stroke="currentColor"/><path d="M304 0h32" fill="none" stroke="currentColor"/><path d="M336 0h32" fill="none" stroke="currentColor"/><path d="M368 0h32" fill="none" stroke="currentColor"/><path d="M4e2.0h32" fill="none" stroke="currentColor"/><path d="M432 0h32" fill="none" stroke="currentColor"/><path d="M464 0h32" fill="none" stroke="currentColor"/><path d="M496 0h32" fill="none" stroke="currentColor"/><path d="M528 0h32" fill="none" stroke="currentColor"/><path d="M560 0h32" fill="none" stroke="currentColor"/><path d="M592 0h32" fill="none" stroke="currentColor"/><path d="M624 0h32" fill="none" stroke="currentColor"/><path d="M656 0h32" fill="none" stroke="currentColor"/><path d="M688 0h32" fill="none" stroke="currentColor"/><path d="M720 0h32" fill="none" stroke="currentColor"/><path d="M80 48H752" fill="none" stroke="currentColor"/><path d="M80 80H752" fill="none" stroke="currentColor"/><path d="M88 128h80" fill="none" stroke="currentColor"/><path d="M184 128H312" fill="none" stroke="currentColor"/><path d="M96 160H296" fill="none" stroke="currentColor"/><path d="M96 192h80" fill="none" stroke="currentColor"/><path d="M176 192H296" fill="none" stroke="currentColor"/><path d="M192 240H392" fill="none" stroke="currentColor"/><path d="M96 256h72" fill="none" stroke="currentColor"/><path d="M192 272h80" fill="none" stroke="currentColor"/><path d="M272 272H392" fill="none" stroke="currentColor"/><path d="M352 320H552" fill="none" stroke="currentColor"/><path d="M352 352h80" fill="none" stroke="currentColor"/><path d="M432 352H552" fill="none" stroke="currentColor"/><path d="M80 0V16" fill="none" stroke="currentColor"/><path d="M80 48V80" fill="none" stroke="currentColor"/><path d="M96 192v64" fill="none" stroke="currentColor"/><path d="M112 0V16" fill="none" stroke="currentColor"/><path d="M144 0V16" fill="none" stroke="currentColor"/><path d="M176 0V16" fill="none" stroke="currentColor"/><path d="M176 176v16" fill="none" stroke="currentColor"/><path d="M208 0V16" fill="none" stroke="currentColor"/><path d="M240 0V16" fill="none" stroke="currentColor"/><path d="M272 0V16" fill="none" stroke="currentColor"/><path d="M272 256v16" fill="none" stroke="currentColor"/><path d="M304 0V16" fill="none" stroke="currentColor"/><path d="M336 0V16" fill="none" stroke="currentColor"/><path d="M368 0V16" fill="none" stroke="currentColor"/><path d="M4e2.0V16" fill="none" stroke="currentColor"/><path d="M432 0V16" fill="none" stroke="currentColor"/><path d="M432 336v16" fill="none" stroke="currentColor"/><path d="M464 0V16" fill="none" stroke="currentColor"/><path d="M496 0V16" fill="none" stroke="currentColor"/><path d="M528 0V16" fill="none" stroke="currentColor"/><path d="M560 0V16" fill="none" stroke="currentColor"/><path d="M592 0V16" fill="none" stroke="currentColor"/><path d="M624 0V16" fill="none" stroke="currentColor"/><path d="M656 0V16" fill="none" stroke="currentColor"/><path d="M688 0V16" fill="none" stroke="currentColor"/><path d="M720 0V16" fill="none" stroke="currentColor"/><path d="M752 0V16" fill="none" stroke="currentColor"/><path d="M752 48V80" fill="none" stroke="currentColor"/><path d="M176 168v8" fill="none" stroke="currentColor"/><path d="M272 248v8" fill="none" stroke="currentColor"/><path d="M432 328v8" fill="none" stroke="currentColor"/><polygon points="96.000000,128.000000 84.000000,122.400002 84.000000,133.600006" fill="currentColor" transform="rotate(180.000000, 88.000000, 128.000000)"/><polygon points="176.000000,256.000000 164.000000,250.399994 164.000000,261.600006" fill="currentColor" transform="rotate(0.000000, 168.000000, 256.000000)"/><polygon points="320.000000,128.000000 308.000000,122.400002 308.000000,133.600006" fill="currentColor" transform="rotate(0.000000, 312.000000, 128.000000)"/><path d="M96 160A16 16 0 0080 176" fill="none" stroke="currentColor"/><path d="M296 160a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M80 176a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M312 176a16 16 0 01-16 16" fill="none" stroke="currentColor"/><path d="M192 240a16 16 0 00-16 16" fill="none" stroke="currentColor"/><path d="M392 240a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M176 256a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M408 256a16 16 0 01-16 16" fill="none" stroke="currentColor"/><path d="M352 320a16 16 0 00-16 16" fill="none" stroke="currentColor"/><path d="M552 320a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M336 336a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M568 336a16 16 0 01-16 16" fill="none" stroke="currentColor"/><text text-anchor="middle" x="0" y="180" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="260" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="340" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="180" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="260" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="340" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="180" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="260" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="340" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="180" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="260" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="340" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="68" fill="currentColor" style="font-size:1em">T</text><text text-anchor="middle" x="32" y="180" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="260" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="340" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="68" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="180" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="260" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="340" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="68" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="180" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="260" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="340" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="68" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="180" fill="currentColor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="260" fill="currentColor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="340" fill="currentColor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="68" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="180" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="260" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="340" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="96" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="68" fill="currentColor" style="font-size:1em">E</text><text text-anchor="middle" x="96" y="116" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="96" y="180" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="104" y="116" fill="currentColor" style="font-size:1em">.</text><text text-anchor="middle" x="112" y="244" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="120" y="116" fill="currentColor" style="font-size:1em">л</text><text text-anchor="middle" x="120" y="244" fill="currentColor" style="font-size:1em">д</text><text text-anchor="middle" x="128" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="116" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="128" y="180" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="244" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="136" y="116" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="136" y="244" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="144" y="116" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="144" y="244" fill="currentColor" style="font-size:1em">г</text><text text-anchor="middle" x="152" y="116" fill="currentColor" style="font-size:1em">я</text><text text-anchor="middle" x="160" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="160" y="180" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="176" y="420" fill="currentColor" style="font-size:1em">(</text><text text-anchor="middle" x="184" y="404" fill="currentColor" style="font-size:1em">С</text><text text-anchor="middle" x="184" y="420" fill="currentColor" style="font-size:1em">ш</text><text text-anchor="middle" x="192" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="116" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="192" y="148" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="192" y="180" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="260" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="192" y="404" fill="currentColor" style="font-size:1em">к</text><text text-anchor="middle" x="192" y="420" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="200" y="116" fill="currentColor" style="font-size:1em">.</text><text text-anchor="middle" x="200" y="404" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="200" y="420" fill="currentColor" style="font-size:1em">б</text><text text-anchor="middle" x="208" y="404" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="208" y="420" fill="currentColor" style="font-size:1em">л</text><text text-anchor="middle" x="216" y="116" fill="currentColor" style="font-size:1em">п</text><text text-anchor="middle" x="216" y="404" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="216" y="420" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="224" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="224" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="116" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="224" y="148" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="180" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="228" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="224" y="260" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="224" y="404" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="224" y="420" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="232" y="116" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="232" y="404" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="240" y="116" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="240" y="404" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="240" y="420" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="248" y="116" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="248" y="404" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="248" y="420" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="256" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="116" fill="currentColor" style="font-size:1em">я</text><text text-anchor="middle" x="256" y="148" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="256" y="180" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="228" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="256" y="260" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="404" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="256" y="420" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="264" y="404" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="264" y="420" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="272" y="116" fill="currentColor" style="font-size:1em">ч</text><text text-anchor="middle" x="272" y="404" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="272" y="420" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="280" y="116" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="280" y="420" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="288" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="116" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="288" y="180" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="228" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="288" y="260" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="404" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="288" y="420" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="296" y="116" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="296" y="404" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="304" y="116" fill="currentColor" style="font-size:1em">ь</text><text text-anchor="middle" x="304" y="404" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="304" y="420" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="312" y="404" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="312" y="420" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="320" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="320" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="228" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="320" y="260" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="404" fill="currentColor" style="font-size:1em">к</text><text text-anchor="middle" x="320" y="420" fill="currentColor" style="font-size:1em">з</text><text text-anchor="middle" x="328" y="404" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="328" y="420" fill="currentColor" style="font-size:1em">б</text><text text-anchor="middle" x="336" y="420" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="344" y="404" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="344" y="420" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="352" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="352" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="228" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="352" y="260" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="340" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="360" y="404" fill="currentColor" style="font-size:1em">д</text><text text-anchor="middle" x="360" y="420" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="368" y="404" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="368" y="420" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="376" y="404" fill="currentColor" style="font-size:1em">у</text><text text-anchor="middle" x="384" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="384" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="228" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="384" y="260" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="340" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="384" y="404" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="384" y="420" fill="currentColor" style="font-size:1em">п</text><text text-anchor="middle" x="392" y="404" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="392" y="420" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="400" y="404" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="400" y="420" fill="currentColor" style="font-size:1em">д</text><text text-anchor="middle" x="408" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="408" y="404" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="408" y="420" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="416" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="416" y="340" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="416" y="404" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="416" y="420" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="424" y="404" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="424" y="420" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="432" y="404" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="432" y="420" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="440" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="440" y="404" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="440" y="420" fill="currentColor" style="font-size:1em">к</text><text text-anchor="middle" x="448" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="448" y="308" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="448" y="340" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="448" y="404" fill="currentColor" style="font-size:1em">м</text><text text-anchor="middle" x="448" y="420" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="464" y="404" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="464" y="420" fill="currentColor" style="font-size:1em">[</text><text text-anchor="middle" x="472" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="472" y="404" fill="currentColor" style="font-size:1em">л</text><text text-anchor="middle" x="472" y="420" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="480" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="480" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="480" y="340" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="480" y="404" fill="currentColor" style="font-size:1em">г</text><text text-anchor="middle" x="480" y="420" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="488" y="404" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="488" y="420" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="496" y="404" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="496" y="420" fill="currentColor" style="font-size:1em">]</text><text text-anchor="middle" x="504" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="504" y="404" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="504" y="420" fill="currentColor" style="font-size:1em">[</text><text text-anchor="middle" x="512" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="512" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="512" y="340" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="512" y="404" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="512" y="420" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="520" y="404" fill="currentColor" style="font-size:1em">м</text><text text-anchor="middle" x="520" y="420" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="528" y="404" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="528" y="420" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="536" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="536" y="420" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="544" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="544" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="544" y="340" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="544" y="420" fill="currentColor" style="font-size:1em">]</text><text text-anchor="middle" x="552" y="420" fill="currentColor" style="font-size:1em">)</text><text text-anchor="middle" x="568" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="576" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="576" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="600" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="608" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="608" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="632" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="640" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="664" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="672" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="696" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="704" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="728" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="736" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="68" fill="currentColor" style="font-size:1em">D</text></g></svg></div><p>Общую схему для сканирования можно представить следующим псевдокодом:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>fun</span> stringMatching(text, pattern): Boolean {
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> n = text.length
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> m = pattern.length
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> <span>(</span>u, v) = factorize(pattern)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> pos = 0, i = u.length
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> (pos &lt;= n-m) {
</span></span><span style=display:flex><span>        <span style=color:green>// Сравнение правой части
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>while</span> (i &lt; m &amp;&amp; pattern[i] == text[pos + i]) i += 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> (i == m) {
</span></span><span style=display:flex><span>            <span style=color:green>// Сравнение левой части
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>if</span> (text.substring(pos .. pos + u.lastIndex) == u) {
</span></span><span style=display:flex><span>                <span style=color:#00f>return</span> <span style=color:#00f>true</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        (pos, i) = shift(pos, i)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#00f>false</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>factorize()</code> — функция разбиения шаблона на 2 подстроки.
Двусторонний алгоритм использует разбиение шаблона на подстроки, называемый <em>критическим
разбиением</em> (<em>Critical Factorization</em>) и базируется на <em>теореме о критическом разбиении</em>
(<em>Critical Factorization Theorem</em>).<br><code>shift()</code> — правила сдвигов.
Двусторонний алгоритм выбирает разбиение строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{x = uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span>, такое, что длина левой
подстроки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> меньше глобального периода строки шаблона (<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>u</mi><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{|u| &lt; per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal">u</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>), длина <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span>
минимальна, а правая подстрока <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span> периодична.</p><blockquote class=book-hint><p>Есть также другой алгоритм, относящийся к алгоритмам с ограниченным потреблением памяти и
работающий по такой же схеме — это алгоритм Галиля — Сейфераса (Galil - Seiferas)
<a href=#reference_text_algorithms>[1]</a>, <a href=#reference_galil_seiferas>[4]</a>. В нем используется
разбиение, называемое <em>идеальным разбиением</em> (<em>perfect factorization</em>). Выбирается
позиция, где начинается наиболее часто повторяющаяся подстрока шаблона.</p></blockquote><h2 id=базовые-понятия>Базовые понятия
<a class=anchor href=#%d0%b1%d0%b0%d0%b7%d0%be%d0%b2%d1%8b%d0%b5-%d0%bf%d0%be%d0%bd%d1%8f%d1%82%d0%b8%d1%8f>#</a></h2><p>Зададим некоторые связанные со строками базовые определения, которые понадобятся в
описании алгоритма.</p><dl><dt><strong>Алфавит</strong></dt><dd><p><em><strong>Алфавит</strong></em> (<em>alphabet</em>) — это конечное непустое множество символов. Обозначим его через
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">A</span></span></span></span>. Примеры наиболее часто используемых алфавитов:</p><ul><li><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mspace linebreak="newline"></mspace><mo stretchy="false">{</mo><mrow><mtext>a,b,</mtext><mo>…</mo><mtext>, z</mtext></mrow><mspace linebreak="newline"></mspace><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">{A = \\\{\text{a,b,…, z}\\\}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">A</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class="mspace newline"></span><span class=mspace style=margin-right:.2778em></span><span class=mopen>{</span><span class="mord text"><span class=mord>a,b,</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class=mord>, z</span></span><span class="mspace newline"></span><span class=mclose>}</span></span></span></span></span> — множество строчных букв английского алфавита</li><li><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mspace linebreak="newline"></mspace><mo stretchy="false">{</mo><mtext>0,1,2,3,4,5,6,7,8,9</mtext><mspace linebreak="newline"></mspace><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">{A = \\\{\text{0,1,2,3,4,5,6,7,8,9}\\\}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">A</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class="mspace newline"></span><span class=mspace style=margin-right:.2778em></span><span class=mopen>{</span><span class="mord text"><span class=mord>0,1,2,3,4,5,6,7,8,9</span></span><span class="mspace newline"></span><span class=mclose>}</span></span></span></span></span> — множество цифр</li><li><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mspace linebreak="newline"></mspace><mo stretchy="false">{</mo><mtext>0,1</mtext><mspace linebreak="newline"></mspace><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">{A = \\\{\text{0,1}\\\}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">A</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class="mspace newline"></span><span class=mspace style=margin-right:.2778em></span><span class=mopen>{</span><span class="mord text"><span class=mord>0,1</span></span><span class="mspace newline"></span><span class=mclose>}</span></span></span></span></span>: бинарный алфавит</li></ul><p>и т.п.</p></dd><dt><strong>Строка</strong></dt><dd><p><em><strong>Строка</strong></em> (<em><strong>текст</strong></em>, <em><strong>слово</strong></em>) (<em>string</em>, <em>text</em>, <em>word</em>) — конечная последовательность символов из
некоторого алфавита <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">A</span></span></span></span>. Длина строки — это количество элементов в последовательности.
Например, длина строки &ldquo;<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">D</mi><mi mathvariant="monospace">E</mi><mi mathvariant="monospace">F</mi></mrow><annotation encoding="application/x-tex">{\tt{ABCDEF}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class=mord><span class="mord mathtt">ABCDEF</span></span></span></span></span></span></span>&rdquo; равна 6.</p><p>Введем следующие обозначения для некоторый строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>:</p><p><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{|x|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mord>∣</span></span></span></span></span> ­— длина строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>.<br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{x[i]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">x</span><span class=mopen>[</span><span class="mord mathnormal">i</span><span class=mclose>]</span></span></span></span></span> — <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(i+1)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class=mord>1</span><span class=mclose>)</span></span></span></span></span>-ый символ строки (считаем, что первый символ находится по индексу 0).<br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo>…</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{x[i…j]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">x</span><span class=mopen>[</span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.05724em>j</span><span class=mclose>]</span></span></span></span></span> — подстрока <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>…</mo><mi>x</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{x[i]x[i+1]…x[j]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">x</span><span class=mopen>[</span><span class="mord mathnormal">i</span><span class=mclose>]</span><span class="mord mathnormal">x</span><span class=mopen>[</span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class=mord>1</span><span class=mclose>]</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">x</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:.05724em>j</span><span class=mclose>]</span></span></span></span></span> строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>.</p></dd></dl><p>Пустую строку обозначим через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ε</mi></mrow><annotation encoding="application/x-tex">ε</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">ε</span></span></span></span>. Множество всех последовательностей алфавита <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">A</span></span></span></span> —
через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mo lspace="0em" rspace="0em">∗</mo></msup></mrow><annotation encoding="application/x-tex">{A^{*}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6887em></span><span class=mord><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span>, а множество всех непустых строк — через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mo lspace="0em" rspace="0em">+</mo></msup></mrow><annotation encoding="application/x-tex">{A^{+}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7713em></span><span class=mord><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7713em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span></span></span></span></span></span></span></span></span>.</p><dl><dt><strong>Подстрока</strong></dt><dd><p>Строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> длины <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">n</span></span></span></span> является <em><strong>подстрокой</strong></em> (или <em><strong>фактором</strong></em>) (<em>factor</em>,
<em>subword</em>) строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span>, если <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi><mo stretchy="false">[</mo><mi>i</mi><mo>…</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{x=y[i … i+n-1]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mopen>[</span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord>1</span><span class=mclose>]</span></span></span></span></span> для некоторого целого <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span>. Мы можем
говорить, что подстрока <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> встречается в строке <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span> в позиции <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span>. Стоит отметить, что
подстрока — это не то же самое, что и <em>подпоследовательность</em>.<br>Строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> является <em><strong>подпоследовательностью</strong></em> (<em>subsequence</em>) строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span>, если она может
быть получена удалением из <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span> нуля или более (не обязательно смежных) символов. Другими
словами, если <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi><mo stretchy="false">[</mo><msub><mi>i</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mi>y</mi><mo stretchy="false">[</mo><msub><mi>i</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo>…</mo><mi>y</mi><mo stretchy="false">[</mo><msub><mi>i</mi><mi>m</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{x=y[i₁]y[i₂]…y[i_m]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mopen>[</span><span class=mord><span class="mord mathnormal">i</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>]</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mopen>[</span><span class=mord><span class="mord mathnormal">i</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>]</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mopen>[</span><span class=mord><span class="mord mathnormal">i</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>]</span></span></span></span></span>, где <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>i</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>i</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>i</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">{i₁, i₂, i_m}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.854em;vertical-align:-.1944em></span><span class=mord><span class=mord><span class="mord mathnormal">i</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">i</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">i</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></span> — увеличивающаяся
последовательность индексов строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span>.</p></dd><dt><strong>Операции над строками</strong></dt><dd><p><em><strong>Конкатенацией</strong></em> двух строк <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span> называют строку с последовательной записью их
символов. Обозначим конкатенацию строк <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span> как <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xy</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span>. Например, если
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mtext mathvariant="monospace">AB</mtext><mo separator="true">,</mo><mi>y</mi><mo>=</mo><mtext mathvariant="monospace">CD</mtext></mrow><annotation encoding="application/x-tex">{x=\texttt{AB}, y=\texttt{CD}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8055em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">AB</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">CD</span></span></span></span></span></span>, то <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>y</mi><mo>=</mo><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">D</mi></mrow></mrow><annotation encoding="application/x-tex">{xy=\tt{ABCD}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8055em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">x</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class=mord><span class="mord mathtt">ABCD</span></span></span></span></span></span></span>.<br>Через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">{k^x}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6644em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span> обозначим конкатенацию <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal" style=margin-right:.03148em>k</span></span></span></span> копий строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>. Например, для <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow></mrow><annotation encoding="application/x-tex">{x=\tt{AB}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class=mord><span class="mord mathtt">AB</span></span></span></span></span></span></span>,
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>4</mn></msup><mo>=</mo><mrow><munder accentunder="true"><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow><mo stretchy="true">undefined</mo></munder><munder accentunder="true"><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow><mo stretchy="true">undefined</mo></munder><munder accentunder="true"><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow><mo stretchy="true">undefined</mo></munder><munder accentunder="true"><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow><mo stretchy="true">undefined</mo></munder></mrow></mrow><annotation encoding="application/x-tex">{x⁴=\tt{\underlinesegment{AB}\underlinesegment{AB}\underlinesegment{AB}\underlinesegment{AB}}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3361em;vertical-align:-.522em></span><span class=mord><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class=mord><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">AB</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">AB</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">AB</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">AB</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span></span></span></span></span></span></span>.
Стоит отметить, что конкатенация ассоциативна, т.е. <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mi>y</mi><mo stretchy="false">)</mo><mi>z</mi><mo>=</mo><mi>x</mi><mo stretchy="false">(</mo><mi>y</mi><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(xy)z = x(yz)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class="mord mathnormal">x</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mclose>)</span><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">x</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.04398em>yz</span><span class=mclose>)</span></span></span></span></span>, поэтому скобки здесь не
обязательны и выражение можно записать как <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>y</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">{xyz}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">x</span><span class="mord mathnormal" style=margin-right:.04398em>yz</span></span></span></span></span>.</p></dd></dl><p>Рассмотрим строку <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>u</mi><mi>v</mi><mi>w</mi></mrow><annotation encoding="application/x-tex">{x = uvw}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>uv</span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span></span>, представляющую из себя композицию из 3 подстрок: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span> и
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span>. Подстроки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> называются <em>факторами</em>
строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>. Кроме того:<br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> — это <em>префикс</em> строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>,<br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> — это <em>суффикс</em> строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>.</p><dl><dt><strong>Префикс</strong></dt><dd><p>Строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> называется <em><strong>префиксом</strong></em> (<em>prefix</em>) строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>, если существует такая строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span>, что
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{x=uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span>. Например, <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi></mrow><annotation encoding="application/x-tex">{\tt ABC}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">ABC</span></span></span></span></span></span> — это префикс строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder accentunder="true"><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi></mrow><mo stretchy="true">undefined</mo></munder><mi mathvariant="monospace">D</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow><annotation encoding="application/x-tex">{\tt \underlinesegment{ABC}DAB}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1331em;vertical-align:-.522em></span><span class=mord><span class=mord><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">ABC</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span><span class="mord mathtt">DAB</span></span></span></span></span></span>.
Префикс можно рассматривать как особый случай подстроки. Обычный префикс может быть как
пустой строкой (ε), так и всей строкой.<br><em><strong>Собственный префикс</strong></em> (<em>proper prefix</em>) — это префикс с дополнительными ограничениями:
он не может быть пустым и не может быть равен всей строке целиком.</p></dd><dt><strong>Суффикс</strong></dt><dd><p>Строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> называется <em><strong>суффиксом</strong></em> (<em>suffix</em>) строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>, если существует такая строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span>, что
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>v</mi><mi>w</mi></mrow><annotation encoding="application/x-tex">{x=vw}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span></span> Например, <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">D</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow><annotation encoding="application/x-tex">{\tt DAB}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">DAB</span></span></span></span></span></span> — суффикс строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><munder accentunder="true"><mrow><mi mathvariant="monospace">D</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow><mo stretchy="true">undefined</mo></munder></mrow><annotation encoding="application/x-tex">{\tt ABC\underlinesegment{DAB}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1331em;vertical-align:-.522em></span><span class=mord><span class=mord><span class="mord mathtt">ABC</span><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">DAB</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span></span></span></span></span></span>.
Также, как и в случае с префиксом, обычный суффикс может быть как пустым, так и всей
строкой.<br><em><strong>Собственный суффикс</strong></em> (<em>proper suffix</em>) — это суффикс, который не может быть
равен пустой строке и всей строке целиком.</p></dd><dt><strong>Период</strong></dt><dd><p><em><strong>Период</strong></em> (<em>period</em>) строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> — это целое число <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal">p</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>p</mi><mo>≤</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{1&lt;p≤|x|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>1</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mord>∣</span></span></span></span></span> такое, что
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>i</mi><mo>∈</mo><mspace linebreak="newline"></mspace><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∣</mi><mo>−</mo><mi>p</mi><mo>−</mo><mn>1</mn><mspace linebreak="newline"></mspace></mrow><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mi>p</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{∀i∈\\{0,1,…|x|-p-1\\}x[i]=x[i+p]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∀</span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>∈</span><span class="mspace newline"></span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mord>∣</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal">p</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord>1</span><span class="mspace newline"></span></span><span class="mord mathnormal">x</span><span class=mopen>[</span><span class="mord mathnormal">i</span><span class=mclose>]</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">x</span><span class=mopen>[</span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal">p</span><span class=mclose>]</span></span></span></span></span><br>Проще говоря, это длина постоянно повторяющегося фрагмента текста, причем,
последнее вхождение может быть &ldquo;обрезано&rdquo;. Например, строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">{\tt{AABAAABAA}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class=mord><span class="mord mathtt">AABAAABAA</span></span></span></span></span></span></span> (её длина
равна 9), имеет периоды 4, 7, 8 и 9:</p><p><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="1.2em"><mrow><munder><munder><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi></mrow><mo stretchy="true">⏟</mo></munder><mn mathvariant="monospace">4</mn></munder><munder><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi></mrow><mo stretchy="true">⏟</mo></munder><munder><mrow><mi mathvariant="monospace">A</mi><mphantom><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi></mphantom></mrow><mo stretchy="true">⏟</mo></munder></mrow></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="1.2em"><mrow><munder><munder><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow><mo stretchy="true">⏟</mo></munder><mn mathvariant="monospace">7</mn></munder><munder><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mphantom><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mphantom></mrow><mo stretchy="true">⏟</mo></munder></mrow></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="1.2em"><mrow><munder><munder><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi></mrow><mo stretchy="true">⏟</mo></munder><mn mathvariant="monospace">8</mn></munder><munder><mrow><mi mathvariant="monospace">A</mi><mphantom><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi></mphantom></mrow><mo stretchy="true">⏟</mo></munder></mrow></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="1.2em"><munder><munder><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi></mrow><mo stretchy="true">⏟</mo></munder><mn mathvariant="monospace">9</mn></munder></mstyle></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
        &amp; \tt{\large{\underbrace{AABA}_4\underbrace{AABA}\underbrace{A\phantom{ABA}}}} \\\\
        &amp; \tt{\large{\underbrace{AABAAAB}_7\underbrace{AA\phantom{BAAAB}}}} \\\\
        &amp; \tt{\large{\underbrace{AABAAABA}_8\underbrace{A\phantom{ABAAABA}}}} \\\\
        &amp; \tt{\large{\underbrace{AABAAABAA}_9}}
      \end{aligned}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:15.086em;vertical-align:-7.293em></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:7.793em><span style=top:-9.793em><span class=pstrut style=height:2.84em></span><span class=mord></span></span><span style=top:-7.1465em><span class=pstrut style=height:2.84em></span><span class=mord></span></span><span style=top:-5.6465em><span class=pstrut style=height:2.84em></span><span class=mord></span></span><span style=top:-3em><span class=pstrut style=height:2.84em></span><span class=mord></span></span><span style=top:-1.5em><span class=pstrut style=height:2.84em></span><span class=mord></span></span><span style=top:1.1465em><span class=pstrut style=height:2.84em></span><span class=mord></span></span><span style=top:2.6465em><span class=pstrut style=height:2.84em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:7.293em><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:7.793em><span style=top:-9.953em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mord><span class=mord><span class="mord sizing reset-size6 size7"><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.7446em><span class=pstrut style=height:3em></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathtt mtight">4</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">AABA</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2554em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">AABA</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">A</span><span class="mord mathtt" style=color:transparent>ABA</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span></span></span></span><span style=top:-5.8065em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mord><span class=mord><span class="mord sizing reset-size6 size7"><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.7446em><span class=pstrut style=height:3em></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathtt mtight">7</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">AABAAAB</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2554em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">AA</span><span class="mord mathtt" style=color:transparent>BAAAB</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span></span></span></span><span style=top:-1.66em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mord><span class=mord><span class="mord sizing reset-size6 size7"><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.7446em><span class=pstrut style=height:3em></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathtt mtight">8</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">AABAAABA</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2554em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">A</span><span class="mord mathtt" style=color:transparent>ABAAABA</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span></span></span></span><span style=top:2.4865em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mord><span class=mord><span class="mord sizing reset-size6 size7"><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.7446em><span class=pstrut style=height:3em></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathtt mtight">9</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">AABAAABAA</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2554em><span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:7.293em><span></span></span></span></span></span></span></span></span></span></span></p></dd></dl><p>Отметим, что длина строки всегда является её периодом, а это значит, что любой строки
всегда есть хотя бы один период.<br>Обозначим <em><strong>наименьший период</strong></em> строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span> (численное значение), а саму
подстроку наименьшего периода — через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{period(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>.</p><p>Возьмем непустую строку <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> и какое-то число <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal">p</span></span></span></span> такое, что <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>p</mi><mo>≤</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{0&lt;p≤|x|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>0</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mord>∣</span></span></span></span></span>. Во всех следующих
случаях <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal">p</span></span></span></span> будет периодом строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>:</p><ol><li><p>Если <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> — это подстрока некоторой строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">{y^k}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0435em;vertical-align:-.1944em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8491em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span></span></span></span></span>, где <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>y</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">{|y|=p}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span></span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{k&gt;0}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7335em;vertical-align:-.0391em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span><span class=mord>0</span></span></span></span></span>.<br><strong>Пример</strong><br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mi>y</mi><mi>k</mi></msup><mo>=</mo><munder><munder><mtext mathvariant="monospace">ABC</mtext><mo stretchy="true">⏟</mo></munder><mi>y</mi></munder><munder><munder><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi></mrow><mo stretchy="true">⏟</mo></munder><mi>y</mi></munder><munder><munder><mtext mathvariant="monospace">ABC</mtext><mo stretchy="true">⏟</mo></munder><mi>y</mi></munder><munder><munder><mtext mathvariant="monospace">ABC</mtext><mo stretchy="true">⏟</mo></munder><mi>y</mi></munder></mrow><mspace width="2em"/><mi>y</mi><mo>=</mo><mtext mathvariant="monospace">ABC</mtext><mspace width="1em"/><mrow><mi>p</mi><mo>=</mo><mn>3</mn></mrow><mspace width="1em"/><mrow><mi>k</mi><mo>=</mo><mn>4</mn></mrow></mrow><annotation encoding="application/x-tex">{y^k=\underbrace{\texttt{ABC}}_y\underbrace{\tt{ABC}}_y\underbrace{\texttt{ABC}}_y\underbrace{\texttt{ABC}}_y}
        \qquad y=\texttt{ABC} \quad  {p=3} \quad {k=4} </annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:2.1346em;vertical-align:-1.2855em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8491em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.8506em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>y</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord text"><span class="mord texttt">ABC</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2855em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.8506em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>y</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=mord><span class="mord mathtt">ABC</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2855em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.8506em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>y</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord text"><span class="mord texttt">ABC</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2855em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.8506em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>y</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord text"><span class="mord texttt">ABC</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2855em><span></span></span></span></span></span></span><span class=mspace style=margin-right:2em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord text"><span class="mord texttt">ABC</span></span><span class=mspace style=margin-right:1em></span><span class=mord><span class="mord mathnormal">p</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>3</span></span><span class=mspace style=margin-right:1em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>4</span></span></span></span></span><br>Если взять за <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> любой префикс или подстроку (фактор) строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">{y^k}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0435em;vertical-align:-.1944em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8491em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span></span></span></span></span>, то один из её
периодов будет тоже 3.</p></li><li><p>Если строку <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> можно представить как <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mi>v</mi><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mi>u</mi></mrow><annotation encoding="application/x-tex">{(uv)^ku}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0991em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.03588em>uv</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8491em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span></span></span></span></span>, где <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>u</mi><mi>v</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">{|uv|=p}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.03588em>uv</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span></span></span></span></span>, строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span> — непустая и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{k&gt;0}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7335em;vertical-align:-.0391em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span><span class=mord>0</span></span></span></span></span><br><strong>Пример</strong><br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><munder><munder><mtext mathvariant="monospace">ABC</mtext><mo stretchy="true">⏟</mo></munder><mi>u</mi></munder><munder><munder><mtext mathvariant="monospace">DEFG</mtext><mo stretchy="true">⏟</mo></munder><mi>v</mi></munder><munder><munder><mtext mathvariant="monospace">ABC</mtext><mo stretchy="true">⏟</mo></munder><mi>u</mi></munder><munder><munder><mtext mathvariant="monospace">DEFG</mtext><mo stretchy="true">⏟</mo></munder><mi>v</mi></munder><munder><munder><mtext mathvariant="monospace">ABC</mtext><mo stretchy="true">⏟</mo></munder><mi>u</mi></munder></mrow><annotation encoding="application/x-tex">{x = \underbrace{\texttt{ABC}}_u\underbrace{\texttt{DEFG}}_v\underbrace{\texttt{ABC}}_u\underbrace{\texttt{DEFG}}_v\underbrace{\texttt{ABC}}_u}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.7605em;vertical-align:-1.1494em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.8506em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord text"><span class="mord texttt">ABC</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.1494em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.8506em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>v</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord text"><span class="mord texttt">DEFG</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.1494em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.8506em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord text"><span class="mord texttt">ABC</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.1494em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.8506em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>v</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord text"><span class="mord texttt">DEFG</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.1494em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.8506em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord text"><span class="mord texttt">ABC</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.1494em><span></span></span></span></span></span></span></span></span></span><br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>u</mi><mo>=</mo><mtext mathvariant="monospace">ABC</mtext></mrow><mo separator="true">,</mo><mtext> </mtext><mrow><mi>v</mi><mo>=</mo><mtext mathvariant="monospace">DEFG</mtext></mrow></mrow><annotation encoding="application/x-tex">{u=\texttt{ABC}}, \space {v=\texttt{DEFG}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8055em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">u</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">ABC</span></span></span><span class=mpunct>,</span><span class=mspace> </span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">DEFG</span></span></span></span></span></span><br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><mi>u</mi><mi>v</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mi>u</mi></mrow><annotation encoding="application/x-tex">{x=(uv)²u}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0641em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.03588em>uv</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span></span></span></span></span><br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">∣</mi><mi>u</mi><mi>v</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mn>7</mn></mrow><mo separator="true">,</mo><mtext> </mtext><mrow><mi>p</mi><mo>=</mo><mn>7</mn></mrow></mrow><annotation encoding="application/x-tex">{|uv|=7}, \space {p=7}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.03588em>uv</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>7</span></span><span class=mpunct>,</span><span class=mspace> </span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">p</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>7</span></span></span></span></span></p></li><li><p>Возьмем некоторые строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.04398em>z</span></span></span></span> равной длины и строку <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span>, такие, что
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi><mi>w</mi><mo>=</mo><mi>w</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">{x=yw=wz}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class="mord mathnormal" style=margin-right:.04398em>z</span></span></span></span></span>; <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>y</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>z</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{|y|=|z|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=mord>∣</span></span></span></span></span>. В этом случае длина <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.04398em>z</span></span></span></span> будет периодом строки
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>y</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>z</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">{|y|=|z|=p}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span></span></span></span></span>.<br><strong>Пример</strong><br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mpadded width="0px"><mrow><mover><mover><mphantom><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">D</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow></mphantom><mo stretchy="true">⏞</mo></mover><mi>w</mi></mover><mover><mover><mphantom><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">D</mi></mrow></mphantom><mo stretchy="true">⏞</mo></mover><mi>z</mi></mover></mrow></mpadded><munder><munder><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">D</mi></mrow><mo stretchy="true">⏟</mo></munder><mi>y</mi></munder><munder><munder><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">D</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow><mo stretchy="true">⏟</mo></munder><mi>w</mi></munder></mrow><annotation encoding="application/x-tex">{x=\mathrlap{
        \overbrace{\phantom{\mathtt{ABCDAB}}}^w
        \overbrace{\phantom{\mathtt{ABCD}}}^z
      } \underbrace{\mathtt{ABCD}}_y\underbrace{\mathtt{ABCDAB}}_w
      }</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:3.046em;vertical-align:-1.2855em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord vbox"><span class=thinbox><span class=rlap><span class=strut style=height:1.7605em></span><span class=inner><span class=mord><span class="mord mover"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.7605em><span style=top:-3.2591em><span class=pstrut style=height:3.2591em></span><span class="mord mover"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.2591em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>ABCDAB</span></span></span></span><span class=svg-align style=top:-3.7111em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117-45 179-50H4e5v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7 5-6 9-10 13-.7 1-7.3 1-20 1H6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M200428 334c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3.0 5 4 11 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60H4e5v120z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M4e5 542l-6 6h-17c-12.7.0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5s-117.2-55.8-184.5-66.5c-.7.0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z"/></svg></span></span></span></span></span></span></span></span><span style=top:-4.7182em><span class=pstrut style=height:3.2591em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span></span></span></span></span><span class="mord mover"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.7605em><span style=top:-3.2591em><span class=pstrut style=height:3.2591em></span><span class="mord mover"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.2591em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>ABCD</span></span></span></span><span class=svg-align style=top:-3.7111em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117-45 179-50H4e5v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7 5-6 9-10 13-.7 1-7.3 1-20 1H6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M200428 334c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3.0 5 4 11 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60H4e5v120z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M4e5 542l-6 6h-17c-12.7.0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5s-117.2-55.8-184.5-66.5c-.7.0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z"/></svg></span></span></span></span></span></span></span></span><span style=top:-4.7182em><span class=pstrut style=height:3.2591em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.04398em>z</span></span></span></span></span></span></span></span></span><span class=fix></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.8506em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>y</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathtt">ABCD</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2855em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span style=top:-1.8506em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.352em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathtt">ABCDAB</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.648em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.1494em><span></span></span></span></span></span></span></span></span></span><br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">D</mi></mrow></mrow><annotation encoding="application/x-tex">{y=\tt ABCD}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8055em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord mathtt">ABCD</span></span></span></span></span></span><br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mrow><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">D</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow></mrow><annotation encoding="application/x-tex">{z=\tt CDAB}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord mathtt">CDAB</span></span></span></span></span></span><br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">D</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow></mrow><annotation encoding="application/x-tex">{w=\tt ABCDAB}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord mathtt">ABCDAB</span></span></span></span></span></span><br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>y</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>z</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">{p=|y|=|z|=4}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">p</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>4</span></span></span></span></span></p></li></ol><dl><dt><strong>Грань</strong></dt><dd><p><strong>Грань</strong> (также <strong>граница</strong> или <strong>бордер</strong>) (<em>border</em>) строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> — это любой
собственный префикс строки, который равен её суффиксу. Т.е. грань — это такая строка
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span>, что <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi><mi>w</mi><mo>=</mo><mi>w</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">{x=yw=wz}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class="mord mathnormal" style=margin-right:.04398em>z</span></span></span></span></span>. Грань не может быть равна всей строке, но суффикс и префикс строки
могут быть перекрывающимися.
Например, грани строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">{\tt AABAAABAA}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">AABAAABAA</span></span></span></span></span></span>: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mo separator="true">,</mo><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mo separator="true">,</mo><mi mathvariant="monospace">A</mi><mo separator="true">,</mo><mi mathvariant="monospace">ε</mi></mrow><annotation encoding="application/x-tex">{\tt AABAA, AA, A, ε}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8055em;vertical-align:-.1944em></span><span class=mord><span class=mord><span class="mord mathtt">AABAA</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathtt">AA</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathtt">A</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">ε</span></span></span></span></span></span>.</p><p>Обозначим <em><strong>наибольшую грань</strong></em> строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>o</mi><mi>r</mi><mi>d</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Border(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05017em>B</span><span class="mord mathnormal" style=margin-right:.02778em>or</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>. Мы можем рассматривать такую грань
как наибольшее совпадающее пересечение при наложении строки самой на себя.<br>Строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> <em><strong>свободна от граней</strong></em> (<em>border free</em>), если наибольшая грань строки — это пустая
строка, или другими словами, если наименьший период равен длине строки (<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{per(x)=|x|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mord>∣</span></span></span></span></span>)<br>Между гранями и периодами имеется взаимно однозначное соответствие, это можно увидеть по
пункту 3 из описания периода.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 928 121"><g transform="translate(8,16)"><path d="M16 0H152" fill="none" stroke="currentColor"/><path d="M152 0H456" fill="none" stroke="currentColor"/><path d="M16 32H152" fill="none" stroke="currentColor"/><path d="M152 32H456" fill="none" stroke="currentColor"/><path d="M32 48H136" fill="none" stroke="currentColor"/><path d="M152 64H456" fill="none" stroke="currentColor"/><path d="M456 64H592" fill="none" stroke="currentColor"/><path d="M152 96H456" fill="none" stroke="currentColor"/><path d="M456 96H592" fill="none" stroke="currentColor"/><path d="M16 0V32" fill="none" stroke="currentColor"/><path d="M152 0V32" fill="none" stroke="currentColor"/><path d="M152 32V64" fill="none" stroke="currentColor"/><path d="M152 64V96" fill="none" stroke="currentColor"/><path d="M456 0V32" fill="none" stroke="currentColor"/><path d="M456 32V48" fill="none" stroke="currentColor"/><path d="M456 48V64" fill="none" stroke="currentColor"/><path d="M456 64V96" fill="none" stroke="currentColor"/><path d="M592 64V96" fill="none" stroke="currentColor"/><polygon points="40.000000,48.000000 28.000000,42.400002 28.000000,53.599998" fill="currentColor" transform="rotate(180.000000, 32.000000, 48.000000)"/><polygon points="144.000000,48.000000 132.000000,42.400002 132.000000,53.599998" fill="currentColor" transform="rotate(0.000000, 136.000000, 48.000000)"/><text text-anchor="middle" x="0" y="20" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="56" y="68" fill="currentColor" style="font-size:1em">П</text><text text-anchor="middle" x="64" y="68" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="72" y="68" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="80" y="68" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="88" y="68" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="96" y="68" fill="currentColor" style="font-size:1em">д</text><text text-anchor="middle" x="112" y="68" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="136" y="84" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="256" y="20" fill="currentColor" style="font-size:1em">Г</text><text text-anchor="middle" x="256" y="84" fill="currentColor" style="font-size:1em">Г</text><text text-anchor="middle" x="264" y="20" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="264" y="84" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="272" y="20" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="272" y="84" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="280" y="20" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="280" y="84" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="288" y="20" fill="currentColor" style="font-size:1em">ь</text><text text-anchor="middle" x="288" y="84" fill="currentColor" style="font-size:1em">ь</text><text text-anchor="middle" x="304" y="20" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="304" y="84" fill="currentColor" style="font-size:1em">x</text></g></svg></div></dd></dl><h2 id=описание-алгоритма>Описание алгоритма
<a class=anchor href=#%d0%be%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%b8%d0%b5-%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc%d0%b0>#</a></h2><p>Пусть <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> — непустая строка, а <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span> — разбиение <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>. Обозначим через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal" style=margin-right:.01968em>l</span></span></span></span> длину левой части
разбиения минус 1 (<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>u</mi><mi mathvariant="normal">∣</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{l = |u| - 1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord mathnormal">u</span><span class=mord>∣</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord>1</span></span></span></span></span>). <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>l</mi><mo>&lt;</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{0≤l&lt;|x|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>0</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mord>∣</span></span></span></span></span>.<br>Непустая строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> называется <em><strong>повторением для разбиения <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold-italic">uv</mtext></mrow><annotation encoding="application/x-tex">\textit{\textbf{uv}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4444em></span><span class="mord text"><span class="mord text"><span class="mord textbf textit">uv</span></span></span></span></span></span></strong></em>
(<em>repetition for factorization</em>) или <em><strong>повторением в позиции <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold-italic">l</mtext></mrow><annotation encoding="application/x-tex">\textit{\textbf{l}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord text"><span class="mord text"><span class="mord textbf textit">l</span></span></span></span></span></span> строки
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold-italic">x</mtext></mrow><annotation encoding="application/x-tex">\textit{\textbf{x}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4444em></span><span class="mord text"><span class="mord text"><span class="mord textbf textit">x</span></span></span></span></span></span></strong></em>, если выполняются оба условия:</p><ul><li><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> — суффикс <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> или <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> — суффикс <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span></li><li><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> — префикс <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span> или <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span> — префикс <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span></li></ul><p>Базовый случай повторения (<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> — суффикс <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> — префикс <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span>) — это когда разбиение
между <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span> — это центр квадрата где-то в строке <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>:</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 233"><g transform="translate(8,16)"><path d="M48 0H80" fill="none" stroke="currentColor"/><path d="M80 0h32" fill="none" stroke="currentColor"/><path d="M112 0h32" fill="none" stroke="currentColor"/><path d="M144 0h32" fill="none" stroke="currentColor"/><path d="M176 0h32" fill="none" stroke="currentColor"/><path d="M208 0h32" fill="none" stroke="currentColor"/><path d="M240 0h32" fill="none" stroke="currentColor"/><path d="M272 0h32" fill="none" stroke="currentColor"/><path d="M304 0h32" fill="none" stroke="currentColor"/><path d="M336 0h32" fill="none" stroke="currentColor"/><path d="M368 0h32" fill="none" stroke="currentColor"/><path d="M4e2.0h32" fill="none" stroke="currentColor"/><path d="M432 0h32" fill="none" stroke="currentColor"/><path d="M464 0h32" fill="none" stroke="currentColor"/><path d="M496 0h32" fill="none" stroke="currentColor"/><path d="M528 0h32" fill="none" stroke="currentColor"/><path d="M560 0h32" fill="none" stroke="currentColor"/><path d="M592 0h32" fill="none" stroke="currentColor"/><path d="M624 0h32" fill="none" stroke="currentColor"/><path d="M656 0h32" fill="none" stroke="currentColor"/><path d="M688 0h32" fill="none" stroke="currentColor"/><path d="M48 48H208" fill="none" stroke="currentColor"/><path d="M208 48h32" fill="none" stroke="currentColor"/><path d="M240 48h96" fill="none" stroke="currentColor"/><path d="M336 48h32" fill="none" stroke="currentColor"/><path d="M368 48H496" fill="none" stroke="currentColor"/><path d="M496 48h24" fill="none" stroke="currentColor"/><path d="M520 48H712" fill="none" stroke="currentColor"/><path d="M48 80H208" fill="none" stroke="currentColor"/><path d="M208 80h32" fill="none" stroke="currentColor"/><path d="M240 80h96" fill="none" stroke="currentColor"/><path d="M336 80h32" fill="none" stroke="currentColor"/><path d="M368 80H496" fill="none" stroke="currentColor"/><path d="M496 80h24" fill="none" stroke="currentColor"/><path d="M520 80H712" fill="none" stroke="currentColor"/><path d="M208 128H368" fill="none" stroke="currentColor"/><path d="M368 128H520" fill="none" stroke="currentColor"/><path d="M208 160H368" fill="none" stroke="currentColor"/><path d="M368 160H520" fill="none" stroke="currentColor"/><path d="M64 192H360" fill="none" stroke="currentColor"/><path d="M376 192H704" fill="none" stroke="currentColor"/><path d="M48 0V16" fill="none" stroke="currentColor"/><path d="M48 48V80" fill="none" stroke="currentColor"/><path d="M80 0V16" fill="none" stroke="currentColor"/><path d="M112 0V16" fill="none" stroke="currentColor"/><path d="M144 0V16" fill="none" stroke="currentColor"/><path d="M176 0V16" fill="none" stroke="currentColor"/><path d="M208 0V16" fill="none" stroke="currentColor"/><path d="M208 48V80" fill="none" stroke="currentColor"/><path d="M208 80v48" fill="none" stroke="currentColor"/><path d="M208 128v32" fill="none" stroke="currentColor"/><path d="M240 0V16" fill="none" stroke="currentColor"/><path d="M240 48V80" fill="none" stroke="currentColor"/><path d="M272 0V16" fill="none" stroke="currentColor"/><path d="M304 0V16" fill="none" stroke="currentColor"/><path d="M336 0V16" fill="none" stroke="currentColor"/><path d="M336 48V80" fill="none" stroke="currentColor"/><path d="M368 0V16" fill="none" stroke="currentColor"/><path d="M368 48V80" fill="none" stroke="currentColor"/><path d="M368 128v32" fill="none" stroke="currentColor"/><path d="M4e2.0V16" fill="none" stroke="currentColor"/><path d="M432 0V16" fill="none" stroke="currentColor"/><path d="M464 0V16" fill="none" stroke="currentColor"/><path d="M496 0V16" fill="none" stroke="currentColor"/><path d="M496 48V80" fill="none" stroke="currentColor"/><path d="M520 48V80" fill="none" stroke="currentColor"/><path d="M520 80v48" fill="none" stroke="currentColor"/><path d="M520 128v32" fill="none" stroke="currentColor"/><path d="M528 0V16" fill="none" stroke="currentColor"/><path d="M560 0V16" fill="none" stroke="currentColor"/><path d="M592 0V16" fill="none" stroke="currentColor"/><path d="M624 0V16" fill="none" stroke="currentColor"/><path d="M656 0V16" fill="none" stroke="currentColor"/><path d="M688 0V16" fill="none" stroke="currentColor"/><path d="M712 48V80" fill="none" stroke="currentColor"/><path d="M720 0V16" fill="none" stroke="currentColor"/><polygon points="72.000000,192.000000 60.000000,186.399994 60.000000,197.600006" fill="currentColor" transform="rotate(180.000000, 64.000000, 192.000000)"/><polygon points="368.000000,192.000000 356.000000,186.399994 356.000000,197.600006" fill="currentColor" transform="rotate(0.000000, 360.000000, 192.000000)"/><polygon points="384.000000,192.000000 372.000000,186.399994 372.000000,197.600006" fill="currentColor" transform="rotate(180.000000, 376.000000, 192.000000)"/><polygon points="712.000000,192.000000 700.000000,186.399994 700.000000,197.600006" fill="currentColor" transform="rotate(0.000000, 704.000000, 192.000000)"/><text text-anchor="middle" x="32" y="68" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="64" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="200" y="212" fill="currentColor" style="font-size:1em">𝒖</text><text text-anchor="middle" x="216" y="100" fill="currentColor" style="font-size:1em">l</text><text text-anchor="middle" x="224" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="224" y="100" fill="currentColor" style="font-size:1em">-</text><text text-anchor="middle" x="232" y="100" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="256" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="288" y="148" fill="currentColor" style="font-size:1em">𝒘</text><text text-anchor="middle" x="320" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="344" y="100" fill="currentColor" style="font-size:1em">l</text><text text-anchor="middle" x="352" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="376" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="384" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="408" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="416" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="440" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="440" y="148" fill="currentColor" style="font-size:1em">𝒘</text><text text-anchor="middle" x="448" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="472" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="480" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="496" y="100" fill="currentColor" style="font-size:1em">l</text><text text-anchor="middle" x="504" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="504" y="100" fill="currentColor" style="font-size:1em">+</text><text text-anchor="middle" x="512" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="512" y="100" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="536" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="536" y="212" fill="currentColor" style="font-size:1em">𝒗</text><text text-anchor="middle" x="544" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="568" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="576" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="600" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="608" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="632" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="664" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="696" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="704" y="20" fill="currentColor" style="font-size:1em">0</text></g></svg></div><p>Другие случаи соответствуют ситуациям, когда <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal" style=margin-right:.01968em>l</span></span></span></span> находится близко к краям строки или при
переполнении <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span>. Стоит заметить, что если есть строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{x=uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span>, а в качестве <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> взять
строку <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">vu</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">vu</span></span></span></span>, то эта строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> будет повторением для разбиения <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">uv</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span> (выполнятся оба
условия). Т.е. любое разбиение непустой строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> всегда имеет хотя бы одно повторение.</p><p>Длина <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02778em>r</span></span></span></span> повторения для разбиения <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">uv</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span> называется <em><strong>локальным периодом
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold-italic">uv</mtext></mrow><annotation encoding="application/x-tex">\textit{\textbf{uv}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4444em></span><span class="mord text"><span class="mord text"><span class="mord textbf textit">uv</span></span></span></span></span></span></strong></em> или <em><strong>локальным периодом строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold-italic">x</mtext></mrow><annotation encoding="application/x-tex">\textit{\textbf{x}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4444em></span><span class="mord text"><span class="mord text"><span class="mord textbf textit">x</span></span></span></span></span></span> в позиции
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold-italic">l</mtext></mrow><annotation encoding="application/x-tex">\textit{\textbf{l}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord text"><span class="mord text"><span class="mord textbf textit">l</span></span></span></span></span></span></strong></em>.
Другими словами, число <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02778em>r</span></span></span></span> является локальным периодом строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> в позиции <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal" style=margin-right:.01968em>l</span></span></span></span>, если
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{x[i]=x[i+r]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">x</span><span class=mopen>[</span><span class="mord mathnormal">i</span><span class=mclose>]</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">x</span><span class=mopen>[</span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mclose>]</span></span></span></span></span> для всех индексов <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>−</mo><mi>r</mi><mo>+</mo><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>l</mi></mrow><annotation encoding="application/x-tex">{l-r+1≤i≤l}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8304em;vertical-align:-.136em></span><span class=mord><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class=mord>1</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.01968em>l</span></span></span></span></span> и выполняются оба условия повторения.</p><p><em><strong>Наименьшее возможное значение</strong></em> локального периода для разбиения <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span> обозначается как
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{r(u,v)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mopen>(</span><span class="mord mathnormal">u</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mclose>)</span></span></span></span></span>.</p><p><strong>Примеры</strong></p><p>Пусть строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mtext mathvariant="monospace">ABAABAA</mtext></mrow><annotation encoding="application/x-tex">{x=\texttt{ABAABAA}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">ABAABAA</span></span></span></span></span></span>.</p><p>Рассмотрим наименьший локальный период в позиции <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">{l=2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class=mord><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>2</span></span></span></span></span>:</p><p><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mpadded width="0px"><mrow><mover><mover><mrow><mphantom><mtable rowspacing="0.46em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">0</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">1</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn mathvariant="monospace">2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd></mtr></mtable></mphantom><mspace width="0.4em"/></mrow><mo stretchy="true">⏞</mo></mover><mi>u</mi></mover><mover><mover><mrow><mphantom><mtable rowspacing="0.46em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">3</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">4</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">5</mn></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>A</mi></mstyle></mtd></mtr></mtable></mphantom><mspace width="1.3em"/></mrow><mo stretchy="true">⏞</mo></mover><mi>v</mi></mover></mrow></mpadded><mtable rowspacing="0.46em" columnalign="center center center center center center center" columnlines="dashed dashed solid dashed dashed dashed" columnspacing="1em" rowlines="none dashed"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">0</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">1</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn mathvariant="monospace">2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">3</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">4</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">5</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">6</mn></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mi mathvariant="monospace">A</mi><mo stretchy="true">undefined</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mi mathvariant="monospace">A</mi><mo stretchy="true">undefined</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">{
  \gdef\string_idx#1{\color{aaaaaa} \tt #1}
  \mathrlap{
    \overbrace{\phantom{
       \def\arraystretch{1.3}\begin{array}{c c c} \string_idx{0} &amp; \string_idx{1} &amp; \tt 2 \\\\
        \tt A &amp; \tt B &amp; \tt A
       \end{array}
      }
      \hspace{0.4em}
    }^u
    \overbrace{\phantom{
       \def\arraystretch{1.3}\begin{array}{c c c} \string_idx{3} &amp; \string_idx{4} &amp; \string_idx{5}
       \\\\ A &amp; B &amp; A
       \end{array}
      }
      \hspace{1.3em}
    }^v
  } \def\arraystretch{1.3}\begin{array}{c:c:c|c:c:c:c} \tt
    \string_idx{0} &amp; \string_idx{1} &amp; \tt 2 &amp; \string_idx{3} &amp; \string_idx{4} &amp; \string_idx{5} &amp; \string_idx{6} \\\\ \hdashline
    \tt A &amp; \tt B &amp; \tt \underlinesegment{A} &amp; \tt \underlinesegment{A} &amp; \tt B &amp; \tt A &amp;
    \tt A
  \end{array}}
</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:5.8564em;vertical-align:-2.117em></span><span class=mord><span class="mord vbox"><span class=thinbox><span class=rlap><span class=strut style=height:5.8294em;vertical-align:-2.09em></span><span class=inner><span class=mord><span class="mord mover"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.7394em><span style=top:-5.238em><span class=pstrut style=height:5.238em></span><span class="mord mover"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.238em><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class=mord><span class=mord style=color:transparent><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>0</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>1</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>2</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span><span class=mspace style=margin-right:.4em></span></span></span><span class=svg-align style=top:-7.28em><span class=pstrut style=height:4.59em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117-45 179-50H4e5v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7 5-6 9-10 13-.7 1-7.3 1-20 1H6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M200428 334c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3.0 5 4 11 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60H4e5v120z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M4e5 542l-6 6h-17c-12.7.0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5s-117.2-55.8-184.5-66.5c-.7.0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z"/></svg></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span></span><span style=top:-8.676em><span class=pstrut style=height:5.238em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class="mord mover"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.7394em><span style=top:-5.238em><span class=pstrut style=height:5.238em></span><span class="mord mover"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.238em><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class=mord><span class=mord style=color:transparent><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>3</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class="mord mathnormal" style=color:transparent>A</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>4</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class="mord mathnormal" style=margin-right:.05017em;color:transparent>B</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>5</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class="mord mathnormal" style=color:transparent>A</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span><span class=mspace style=margin-right:1.3em></span></span></span><span class=svg-align style=top:-7.28em><span class=pstrut style=height:4.59em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117-45 179-50H4e5v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7 5-6 9-10 13-.7 1-7.3 1-20 1H6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M200428 334c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3.0 5 4 11 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60H4e5v120z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M4e5 542l-6 6h-17c-12.7.0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5s-117.2-55.8-184.5-66.5c-.7.0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z"/></svg></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span></span><span style=top:-8.676em><span class=pstrut style=height:5.238em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>v</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span></span></span><span class=fix></span></span></span></span><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.617em><span style=top:-4.617em><span class=pstrut style=height:4.617em></span><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.617em><span style=top:-4.617em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>0</span></span></span></span></span><span style=top:-3.057em><span class=pstrut style=height:3.092em></span><span class=mord></span></span><span style=top:-1.497em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.117em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.734em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.117em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.617em><span style=top:-4.617em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>1</span></span></span></span><span style=top:-1.497em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.117em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.734em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.117em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.617em><span style=top:-4.617em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">2</span></span></span></span><span style=top:-1.497em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">A</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.117em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.734em;border-right-width:.04em;border-right-style:solid;margin:0 -.02em;vertical-align:-2.117em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.617em><span style=top:-4.617em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>3</span></span></span></span><span style=top:-1.497em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">A</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.117em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.734em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.117em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.617em><span style=top:-4.617em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>4</span></span></span></span><span style=top:-1.497em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.117em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.734em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.117em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.617em><span style=top:-4.617em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>5</span></span></span></span><span style=top:-1.497em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.117em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.734em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.117em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.617em><span style=top:-4.617em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>6</span></span></span></span><span style=top:-1.497em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.117em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span><span style=top:-4.114em><span class=pstrut style=height:4.617em></span><span class=hdashline style=border-bottom-width:.04em></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.117em><span></span></span></span></span></span></span></span></span></span></p><p><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mtext mathvariant="monospace">ABA</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">ABAA</mtext><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∣</mi><mtext mathvariant="monospace">A</mtext><mi mathvariant="normal">∣</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r(\texttt{ABA}, \texttt{ABAA}) = |\texttt{A}| = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mopen>(</span><span class="mord text"><span class="mord texttt">ABA</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">ABAA</span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>∣</span><span class="mord text"><span class="mord texttt">A</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>1</span></span></span></span>,<br>наименьшее повторение <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mtext mathvariant="monospace">A</mtext></mrow><annotation encoding="application/x-tex">w=\texttt{A}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6111em></span><span class="mord text"><span class="mord texttt">A</span></span></span></span></span>.</p><p>Рассмотрим наименьший локальный период в позиции <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{l=1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class=mord><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>1</span></span></span></span></span>:</p><p><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mpadded width="0px"><mrow><munder><munder><mrow><mspace width="1.05em"/><mphantom><mtable rowspacing="0.46em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">0</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd></mtr></mtable></mphantom></mrow><mo stretchy="true">⏟</mo></munder><mi>w</mi></munder><munder><munder><mphantom><mtable rowspacing="0.46em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mrow><mn mathvariant="monospace">2</mn><mstyle mathcolor="#aaaaaa"><mrow><mn mathvariant="monospace">3</mn><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">4</mn></mstyle></mrow></mstyle></mrow></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow></mstyle></mtd></mtr></mtable></mphantom><mo stretchy="true">⏟</mo></munder><mi>w</mi></munder></mrow></mpadded><mspace width="1em"/><mtable rowspacing="0.46em" columnalign="center center center center center center center" columnlines="dashed solid dashed dashed dashed dashed" columnspacing="1em" rowlines="none dashed"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">0</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">2</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">3</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">4</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">5</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">6</mn></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">{
   \gdef\string_idx#1{\color{aaaaaa} \tt #1}
   \mathrlap{
   \underbrace{
    \hspace{1.05em}
    \phantom{
      \def\arraystretch{1.3}\begin{array}{c c} \string_idx{0} &amp; 1 \\\\
      \tt A &amp; \tt B
      \end{array}
    }
   }_w
   \underbrace{
    \phantom{
       \def\arraystretch{1.3}\begin{array}{c c c}
          \string_idx{2} \string_idx{3} \string_idx{4} \\\\
           \tt A &amp; \tt A \tt B
          \end{array}
    }
   }_w
  } \hspace{1em}
    \def\arraystretch{1.3}\begin{array}{c:c|c:c:c:c:c}
      \string_idx{0} &amp; 1 &amp; \string_idx{2} &amp; \string_idx{3} &amp; \string_idx{4} &amp;
      \string_idx{5} &amp; \string_idx{6} \\\\
      \hdashline
      \tt A &amp; \tt B &amp; \tt A &amp; \tt A &amp; \tt B &amp; \tt A &amp; \tt A
    \end{array}
}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:5.8294em;vertical-align:-3.2394em></span><span class=mord><span class="mord vbox"><span class=thinbox><span class=rlap><span class=strut style=height:5.8294em;vertical-align:-3.2394em></span><span class=inner><span class=mord><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-1.3506em><span class=pstrut style=height:4.59em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span class=svg-align style=top:-1.852em><span class=pstrut style=height:4.59em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class=mord><span class=mspace style=margin-right:1.05em></span><span class=mord style=color:transparent><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>0</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent>1</span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.738em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.2394em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-1.3506em><span class=pstrut style=height:4.59em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span class=svg-align style=top:-1.852em><span class=pstrut style=height:4.59em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class=mord><span class=mord style=color:transparent><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>2</span><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>3</span><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>4</span></span></span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:-.53em><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>A</span><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>B</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.738em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.2394em><span></span></span></span></span></span></span></span><span class=fix></span></span></span></span><span class=mspace style=margin-right:1em></span><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>0</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>1</span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:solid;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>2</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>3</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>4</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>5</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>6</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span><span style=top:-4.06em><span class=pstrut style=height:4.59em></span><span class=hdashline style=border-bottom-width:.04em></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span></span></span></span></span></p><p><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mtext mathvariant="monospace">AB</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">AABAA</mtext><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∣</mi><mtext mathvariant="monospace">AAB</mtext><mi mathvariant="normal">∣</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">{r(\texttt{AB}, \texttt{AABAA}) = |\texttt{AAB}| = 3}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mopen>(</span><span class="mord text"><span class="mord texttt">AB</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">AABAA</span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord text"><span class="mord texttt">AAB</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>3</span></span></span></span></span>,<br>наименьшее повторение <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mtext mathvariant="monospace">AAB</mtext></mrow><annotation encoding="application/x-tex">{w=\texttt{AAB}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">AAB</span></span></span></span></span></span>.</p><p>Пусть строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow></mrow><annotation encoding="application/x-tex">{x=\tt AABABAB}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord mathtt">AABABAB</span></span></span></span></span></span></p><p>Рассмотрим наименьший локальный период в позиции <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">{l=5}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class=mord><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>5</span></span></span></span></span>:</p><p><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mpadded width="0px"><mrow><mpadded height="0px" depth="0px"><mphantom><mtable rowspacing="0.46em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">0</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">1</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">2</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">3</mn></mstyle></mstyle></mtd></mtr></mtable></mphantom></mpadded><munder><munder><mphantom><mtable rowspacing="0.46em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">4</mn></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mspace width="0.6em"/></mstyle></mtd></mtr></mtable></mphantom><mo stretchy="true">⏟</mo></munder><mi>w</mi></munder><munder><munder><mphantom><mtable rowspacing="0.46em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">6</mn></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd></mtr></mtable><mspace width="0.6em"/></mphantom><mo stretchy="true">⏟</mo></munder><mi>w</mi></munder></mrow></mpadded><mtable rowspacing="0.46em" columnalign="center center center center center center center" columnlines="dashed dashed dashed dashed dashed solid" columnspacing="1em" rowlines="none dashed"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">0</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">1</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">2</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">3</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">4</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext mathvariant="monospace">5</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">6</mn></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">{
\gdef\string_idx#1{\color{aaaaaa} \tt #1}
\mathrlap{
   \hphantom{
    \def\arraystretch{1.3}\begin{array}{c c c c}
      \string_idx{0} &amp; \string_idx{1} &amp; \string_idx{2} &amp; \string_idx{3}
      \end{array}
   }
   \underbrace{
    \phantom{
      \def\arraystretch{1.3}\begin{array}{c c}
        \string_idx{4} \\\\
            \tt B &amp; \tt \hspace{0.6em}
      \end{array}
    }
   }_w
   \underbrace{
    \phantom{
       \def\arraystretch{1.3}\begin{array}{c}
          \string_idx{6} \\\\
           \tt B
          \end{array}
       \hspace{0.6em}
    }
   }_w
  } \def\arraystretch{1.3}\begin{array}{c:c:c:c:c:c|c}
      \string_idx{0} &amp; \string_idx{1} &amp; \string_idx{2} &amp; \string_idx{3} &amp; \string_idx{4} &amp;
      \texttt{5} &amp; \string_idx{6} \\\\
      \hdashline
      \tt A &amp; \tt A &amp; \tt B &amp; \tt A &amp; \tt B &amp; \tt A &amp; \tt B
    \end{array}
}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:5.8294em;vertical-align:-3.2394em></span><span class=mord><span class="mord vbox"><span class=thinbox><span class=rlap><span class=strut style=height:5.8294em;vertical-align:-3.2394em></span><span class=inner><span class=mord><span class=mord><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0><span style=top:-3em><span class=pstrut style=height:3em></span><span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.03em><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.53em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.03em><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.53em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.03em><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.53em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.03em><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>3</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.53em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span></span></span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-1.3506em><span class=pstrut style=height:4.59em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span class=svg-align style=top:-1.852em><span class=pstrut style=height:4.59em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class=mord><span class=mord style=color:transparent><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>4</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:-.53em><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class=mspace style=color:transparent;margin-right:.6em></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.738em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.2394em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-1.3506em><span class=pstrut style=height:4.59em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span class=svg-align style=top:-1.852em><span class=pstrut style=height:4.59em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class=mord><span class=mord style=color:transparent><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>6</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span><span class=mspace style=color:transparent;margin-right:.6em></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.738em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.2394em><span></span></span></span></span></span></span></span><span class=fix></span></span></span></span><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>0</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>1</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>2</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>3</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>4</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class="mord text"><span class="mord texttt">5</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:solid;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>6</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span><span style=top:-4.06em><span class=pstrut style=height:4.59em></span><span class=hdashline style=border-bottom-width:.04em></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span></span></span></span></span></p><p><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mtext mathvariant="monospace">AABABA</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">B</mtext><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∣</mi><mtext mathvariant="monospace">BA</mtext><mi mathvariant="normal">∣</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">{r(\texttt{AABABA}, \texttt{B}) = |\texttt{BA}| = 2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mopen>(</span><span class="mord text"><span class="mord texttt">AABABA</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">B</span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord text"><span class="mord texttt">BA</span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>2</span></span></span></span></span>,<br>наименьшее повторение <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mtext mathvariant="monospace">BA</mtext></mrow><annotation encoding="application/x-tex">{w=\texttt{BA}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">BA</span></span></span></span></span></span>.</p><p>Рассмотрим наименьший локальный период позиции <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{l=1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class=mord><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>1</span></span></span></span></span>:</p><p><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mpadded width="0px"><mrow><munder><munder><mphantom><mtable rowspacing="0.46em" columnalign="center center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mrow><mn mathvariant="monospace">3</mn><mstyle mathcolor="#aaaaaa"><mrow><mn mathvariant="monospace">2</mn><mstyle mathcolor="#aaaaaa"><mrow><mn mathvariant="monospace">1</mn><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">01</mn></mstyle></mrow></mstyle></mrow></mstyle></mrow></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd></mtr></mtable></mphantom><mo stretchy="true">⏟</mo></munder><mi>w</mi></munder><munder><munder><mphantom><mtable rowspacing="0.46em" columnalign="center center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mrow><mn mathvariant="monospace">2</mn><mstyle mathcolor="#aaaaaa"><mrow><mn mathvariant="monospace">3</mn><mstyle mathcolor="#aaaaaa"><mrow><mn mathvariant="monospace">4</mn><mstyle mathcolor="#aaaaaa"><mrow><mn mathvariant="monospace">5</mn><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">6</mn></mstyle></mrow></mstyle></mrow></mstyle></mrow></mstyle></mrow></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd></mtr></mtable></mphantom><mo stretchy="true">⏟</mo></munder><mi>w</mi></munder></mrow></mpadded><mspace width="6.6em"/><mtable rowspacing="0.46em" columnalign="center center center center center center center" columnlines="dashed solid dashed dashed dashed dashed" columnspacing="1em" rowlines="none dashed"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">0</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">2</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">3</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">4</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">5</mn></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="#aaaaaa"><mn mathvariant="monospace">6</mn></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">{
\gdef\string_idx#1{\color{aaaaaa} \tt #1}
\mathrlap{
   \underbrace{
    \phantom{
      \def\arraystretch{1.3}\begin{array}{c c c c c}
        \string_idx{3} \string_idx{2} \string_idx{1} \string_idx{0} 1 \\\\
            \tt B &amp; \tt A &amp; \tt B &amp; \tt A &amp; \tt A
      \end{array}
    }
   }_w
   \underbrace{
    \phantom{
       \def\arraystretch{1.3}\begin{array}{c c c c c}
          \string_idx{2} \string_idx{3} \string_idx{4} \string_idx{5} \string_idx{6}\\\\
           \tt B &amp; \tt A &amp; \tt B &amp; \tt A &amp; \tt B
          \end{array}
    }
   }_w
  } \hspace{6.6em}
    \def\arraystretch{1.3}\begin{array}{c:c|c:c:c:c:c}
      \string_idx{0} &amp; 1 &amp; \string_idx{2} &amp; \string_idx{3} &amp; \string_idx{4} &amp;
      \string_idx{5} &amp; \string_idx{6} \\\\
      \hdashline
      \tt A &amp; \tt A &amp; \tt B &amp; \tt A &amp; \tt B &amp; \tt A &amp; \tt B
    \end{array}
}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:5.8294em;vertical-align:-3.2394em></span><span class=mord><span class="mord vbox"><span class=thinbox><span class=rlap><span class=strut style=height:5.8294em;vertical-align:-3.2394em></span><span class=inner><span class=mord><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-1.3506em><span class=pstrut style=height:4.59em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span class=svg-align style=top:-1.852em><span class=pstrut style=height:4.59em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class=mord><span class=mord style=color:transparent><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>3</span><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>2</span><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>1</span><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>01</span></span></span></span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:-.53em><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:-.53em><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:-.53em><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:-.53em><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.738em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.2394em><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-1.3506em><span class=pstrut style=height:4.59em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span class=svg-align style=top:-1.852em><span class=pstrut style=height:4.59em></span><span class=stretchy style=height:.548em;min-width:1.6em><span class=brace-left style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688.0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688.0 2 .3 4 1 18.688 2.7 76 4.3 172 5H4e5v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class=brace-center style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62H4e5v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3.0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class=brace-right style=height:.548em><svg width="400em" height=".548em" viewBox="0 0 4e5 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-3e2V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class=mord><span class=mord style=color:transparent><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>2</span><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>3</span><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>4</span><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>5</span><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>6</span></span></span></span></span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:-.53em><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:-.53em><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:-.53em><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:-.53em><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord style=color:transparent><span class=mord style=color:transparent><span class="mord mathtt" style=color:transparent>B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.738em><span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.2394em><span></span></span></span></span></span></span></span><span class=fix></span></span></span></span><span class=mspace style=margin-right:6.6em></span><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:4.59em></span><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>0</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>1</span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:solid;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>2</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>3</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>4</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>5</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:4.68em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-2.09em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.59em><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord style=color:#aaa><span class="mord mathtt" style=color:#aaa>6</span></span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span><span style=top:-4.06em><span class=pstrut style=height:4.59em></span><span class=hdashline style=border-bottom-width:.04em></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.09em><span></span></span></span></span></span></span></span></span></span></p><p><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mtext mathvariant="monospace">AA</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">BABAB</mtext><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∣</mi><mrow><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">∣</mi><mo>=</mo><mn mathvariant="monospace">7</mn></mrow></mrow><annotation encoding="application/x-tex">{r(\texttt{AA}, \texttt{BABAB}) = |\tt BABABAA| = 7}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mopen>(</span><span class="mord text"><span class="mord texttt">AA</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">BABAB</span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class=mord><span class="mord mathtt">BABABAA</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathtt">7</span></span></span></span></span></span>,<br>наименьшее повторение <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mtext mathvariant="monospace">BABABAA</mtext></mrow><annotation encoding="application/x-tex">{w=\texttt{BABABAA}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">BABABAA</span></span></span></span></span></span>.</p><p>Наименьший локальный период разбиения <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{x=uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span> не может быть больше глобального
периода строки: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>r</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">{1≤r(u,v)≤v}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>1</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mopen>(</span><span class="mord mathnormal">u</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span></span>, это следует из определений.</p><p>Разбиение <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{x=uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span>, при котором наименьший локальный период равен глобальному периоду всей
строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{r(u,v)=per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mopen>(</span><span class="mord mathnormal">u</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span> называется <em><strong>критическим разбиением</strong></em> (<em>critical
factorization</em>), а позиция <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>u</mi><mi mathvariant="normal">∣</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{l=|u|-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.01968em>l</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class="mord mathnormal">u</span><span class=mord>∣</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord>1</span></span></span></span></span> — <em><strong>критической позицией <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold-italic">x</mtext></mrow><annotation encoding="application/x-tex">\textit{\textbf{x}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4444em></span><span class="mord text"><span class="mord text"><span class="mord textbf textit">x</span></span></span></span></span></span></strong></em> (<em>critical position</em>).</p><p><strong>Пример</strong></p><p>Пусть <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><munder accentunder="true"><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow><mo stretchy="true">undefined</mo></munder><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow></mrow><annotation encoding="application/x-tex">{x=\tt \underlinesegment{AABABAB}AAB}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1331em;vertical-align:-.522em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">AABABAB</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span><span class="mord mathtt">AAB</span></span></span></span></span></span>.<br>Глобальный период строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>: 7 (<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi></mrow><annotation encoding="application/x-tex">{\tt AABABAB}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">AABABAB</span></span></span></span></span></span>)<br>Локальные периоды для каждой позиции разбиения показаны в следующей таблице:</p><p><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.46em" columnalign="right center center center center center center center center center center" columnlines="solid dashed dashed dashed dashed dashed dashed dashed dashed dashed" columnspacing="1em" rowlines="none dashed none dashed"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>Строка</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="monospace">B</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>Позиция разбиения </mtext><mi>l</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>9</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>Лок. период </mtext><mi>r</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mn>7</mn><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mn>7</mn><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">{\def\arraystretch{1.3}\begin{array}{r|c:c:c:c:c:c:c:c:c:c}
  \text{Строка} &amp; \tt A &amp; \tt A &amp; \tt B &amp; \tt A &amp; \tt B &amp; \tt A &amp; \tt B &amp; \tt A &amp; \tt A
  &amp; \tt B \\\\ \hdashline
  \text{Позиция разбиения }l &amp; 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp;
  7 &amp; 8 &amp; 9 \\\\ \hdashline
  \text{Лок. период }r(u,v) &amp; 1 &amp; \underline{7} &amp; 2 &amp; 2 &amp; 2 &amp; 2 &amp; \underline{7} &amp; 1 &amp; 3 &amp; 1
\end{array}
}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:7.8em;vertical-align:-3.65em></span><span class=mord><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:6.15em></span><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:3.092em></span><span class=mord><span class="mord text"><span class="mord cyrillic_fallback">Строка</span></span></span></span><span style=top:-4.59em><span class=pstrut style=height:3.092em></span><span class=mord></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord><span class="mord text"><span class="mord cyrillic_fallback">Позиция</span><span class=mord> </span><span class="mord cyrillic_fallback">разбиения</span><span class=mord> </span></span><span class="mord mathnormal" style=margin-right:.01968em>l</span></span></span><span style=top:-1.47em><span class=pstrut style=height:3.092em></span><span class=mord></span></span><span style=top:.09em><span class=pstrut style=height:3.092em></span><span class=mord><span class="mord text"><span class="mord cyrillic_fallback">Лок</span><span class=mord>. </span><span class="mord cyrillic_fallback">период</span><span class=mord> </span></span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mopen>(</span><span class="mord mathnormal">u</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:7.8em;border-right-width:.04em;border-right-style:solid;margin:0 -.02em;vertical-align:-3.65em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>0</span></span></span><span style=top:.09em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:7.8em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-3.65em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>1</span></span></span><span style=top:.09em><span class=pstrut style=height:3.092em></span><span class=mord><span class="mord underline"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6444em><span style=top:-2.84em><span class=pstrut style=height:3em></span><span class=underline-line style=border-bottom-width:.04em></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>7</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2em><span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:7.8em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-3.65em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>2</span></span></span><span style=top:.09em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:7.8em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-3.65em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>3</span></span></span><span style=top:.09em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:7.8em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-3.65em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>4</span></span></span><span style=top:.09em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:7.8em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-3.65em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>5</span></span></span><span style=top:.09em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:7.8em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-3.65em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>6</span></span></span><span style=top:.09em><span class=pstrut style=height:3.092em></span><span class=mord><span class="mord underline"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6444em><span style=top:-2.84em><span class=pstrut style=height:3em></span><span class=underline-line style=border-bottom-width:.04em></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>7</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2em><span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:7.8em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-3.65em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>7</span></span></span><span style=top:.09em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:7.8em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-3.65em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">A</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>8</span></span></span><span style=top:.09em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=vertical-separator style="height:7.8em;border-right-width:.04em;border-right-style:dashed;margin:0 -.02em;vertical-align:-3.65em"></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.15em><span style=top:-6.15em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord><span class="mord mathtt">B</span></span></span></span><span style=top:-3.03em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>9</span></span></span><span style=top:.09em><span class=pstrut style=height:3.092em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span><span style=top:-4.06em><span class=pstrut style=height:6.15em></span><span class=hdashline style=border-bottom-width:.04em></span></span><span style=top:-7.18em><span class=pstrut style=height:6.15em></span><span class=hdashline style=border-bottom-width:.04em></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.65em><span></span></span></span></span></span></span></span></span></span></p><p>Критические разбиения: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext mathvariant="monospace">AA</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">BABABAAB</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(\texttt{AA}, \texttt{BABABAAB})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class="mord text"><span class="mord texttt">AA</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">BABABAAB</span></span><span class=mclose>)</span></span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext mathvariant="monospace">AABABAB</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">AAB</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(\texttt{AABABAB}, \texttt{AAB})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class="mord text"><span class="mord texttt">AABABAB</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">AAB</span></span><span class=mclose>)</span></span></span></span></span>.</p><p>В двустороннем алгоритме в качестве разбиения для строки шаблона используется
критическое разбиение, при этом длина левой подстроки меньше глобального периода всей
строки шаблона (<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>u</mi><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{|u| &lt; per(pattern)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal">u</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span></span>).</p><p>Используются следующие правила сдвигов:</p><ul><li><p>При несовпадении в процессе сравнения правой подстроки шаблон сдвигается вправо на
количество просканированных символов, так, чтобы позиция разбиения шаблона оказалась на
позиции несовпадающего символа:</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 944 281"><g transform="translate(8,16)"><path d="M80 0h32" fill="none" stroke="currentColor"/><path d="M112 0h32" fill="none" stroke="currentColor"/><path d="M144 0h32" fill="none" stroke="currentColor"/><path d="M176 0h32" fill="none" stroke="currentColor"/><path d="M208 0h32" fill="none" stroke="currentColor"/><path d="M240 0h32" fill="none" stroke="currentColor"/><path d="M272 0h32" fill="none" stroke="currentColor"/><path d="M304 0h32" fill="none" stroke="currentColor"/><path d="M336 0h32" fill="none" stroke="currentColor"/><path d="M368 0h32" fill="none" stroke="currentColor"/><path d="M4e2.0h32" fill="none" stroke="currentColor"/><path d="M432 0h32" fill="none" stroke="currentColor"/><path d="M464 0h32" fill="none" stroke="currentColor"/><path d="M496 0h32" fill="none" stroke="currentColor"/><path d="M528 0h32" fill="none" stroke="currentColor"/><path d="M560 0h32" fill="none" stroke="currentColor"/><path d="M592 0h32" fill="none" stroke="currentColor"/><path d="M624 0h32" fill="none" stroke="currentColor"/><path d="M656 0h32" fill="none" stroke="currentColor"/><path d="M688 0h32" fill="none" stroke="currentColor"/><path d="M720 0h32" fill="none" stroke="currentColor"/><path d="M80 48H752" fill="none" stroke="currentColor"/><path d="M80 80H752" fill="none" stroke="currentColor"/><path d="M184 112H312" fill="none" stroke="currentColor"/><path d="M96 144H288" fill="none" stroke="currentColor"/><path d="M96 176h80" fill="none" stroke="currentColor"/><path d="M176 176H288" fill="none" stroke="currentColor"/><path d="M192 192h64" fill="none" stroke="currentColor"/><path d="M192 224h72" fill="none" stroke="currentColor"/><path d="M280 224H392" fill="none" stroke="currentColor"/><path d="M192 256h80" fill="none" stroke="currentColor"/><path d="M272 256H392" fill="none" stroke="currentColor"/><path d="M80 0V16" fill="none" stroke="currentColor"/><path d="M80 48V80" fill="none" stroke="currentColor"/><path d="M112 0V16" fill="none" stroke="currentColor"/><path d="M144 0V16" fill="none" stroke="currentColor"/><path d="M176 0V16" fill="none" stroke="currentColor"/><path d="M176 160v16" fill="none" stroke="currentColor"/><path d="M208 0V16" fill="none" stroke="currentColor"/><path d="M240 0V16" fill="none" stroke="currentColor"/><path d="M272 0V16" fill="none" stroke="currentColor"/><path d="M272 208v16" fill="none" stroke="currentColor"/><path d="M272 224v32" fill="none" stroke="currentColor"/><path d="M304 0V16" fill="none" stroke="currentColor"/><path d="M336 0V16" fill="none" stroke="currentColor"/><path d="M368 0V16" fill="none" stroke="currentColor"/><path d="M4e2.0V16" fill="none" stroke="currentColor"/><path d="M432 0V16" fill="none" stroke="currentColor"/><path d="M464 0V16" fill="none" stroke="currentColor"/><path d="M496 0V16" fill="none" stroke="currentColor"/><path d="M528 0V16" fill="none" stroke="currentColor"/><path d="M560 0V16" fill="none" stroke="currentColor"/><path d="M592 0V16" fill="none" stroke="currentColor"/><path d="M624 0V16" fill="none" stroke="currentColor"/><path d="M656 0V16" fill="none" stroke="currentColor"/><path d="M688 0V16" fill="none" stroke="currentColor"/><path d="M720 0V16" fill="none" stroke="currentColor"/><path d="M752 0V16" fill="none" stroke="currentColor"/><path d="M752 48V80" fill="none" stroke="currentColor"/><path d="M176 152v8" fill="none" stroke="currentColor"/><polygon points="280.000000,224.000000 268.000000,218.399994 268.000000,229.600006" fill="currentColor" transform="rotate(90.000000, 272.000000, 224.000000)"/><polygon points="320.000000,112.000000 308.000000,106.400002 308.000000,117.599998" fill="currentColor" transform="rotate(0.000000, 312.000000, 112.000000)"/><path d="M96 144A16 16 0 0080 160" fill="none" stroke="currentColor"/><path d="M288 144a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M80 160a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M304 160a16 16 0 01-16 16" fill="none" stroke="currentColor"/><path d="M176 176a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M256 192a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M192 224a16 16 0 00-16 16" fill="none" stroke="currentColor"/><path d="M392 224a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M176 240a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M408 240a16 16 0 01-16 16" fill="none" stroke="currentColor"/><circle cx="176" cy="176" r="6" stroke="currentColor" fill="#fff"/><text text-anchor="middle" x="0" y="164" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="244" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="164" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="244" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="164" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="244" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="164" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="244" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="68" fill="currentColor" style="font-size:1em">T</text><text text-anchor="middle" x="32" y="164" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="244" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="68" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="164" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="244" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="68" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="164" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="244" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="68" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="164" fill="currentColor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="244" fill="currentColor" style="font-size:1em">₂</text><text text-anchor="middle" x="64" y="68" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="164" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="244" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="96" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="68" fill="currentColor" style="font-size:1em">E</text><text text-anchor="middle" x="96" y="164" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="128" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="164" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="160" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="160" y="164" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="192" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="100" fill="currentColor" style="font-size:1em">п</text><text text-anchor="middle" x="192" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="192" y="164" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="244" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="200" y="100" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="208" y="100" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="216" y="100" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="224" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="224" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="100" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="224" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="164" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="244" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="232" y="100" fill="currentColor" style="font-size:1em">я</text><text text-anchor="middle" x="248" y="100" fill="currentColor" style="font-size:1em">ч</text><text text-anchor="middle" x="256" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="256" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="100" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="256" y="132" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="256" y="164" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="244" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="264" y="100" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="272" y="100" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="280" y="100" fill="currentColor" style="font-size:1em">ь</text><text text-anchor="middle" x="288" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="164" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="244" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="320" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="320" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="244" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="352" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="352" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="244" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="384" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="384" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="244" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="408" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="416" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="440" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="472" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="480" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="480" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="504" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="512" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="512" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="536" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="544" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="544" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="568" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="576" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="576" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="600" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="608" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="608" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="632" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="640" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="664" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="672" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="696" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="704" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="728" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="736" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="68" fill="currentColor" style="font-size:1em">D</text></g></svg></div></li><li><p>При несовпадении в процессе сравнения левой подстроки шаблон сдвигается на глобальный
период шаблона <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{per(pattern)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span></span>:</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 944 313"><g transform="translate(8,16)"><path d="M80 0h32" fill="none" stroke="currentColor"/><path d="M112 0h32" fill="none" stroke="currentColor"/><path d="M144 0h32" fill="none" stroke="currentColor"/><path d="M176 0h32" fill="none" stroke="currentColor"/><path d="M208 0h32" fill="none" stroke="currentColor"/><path d="M240 0h32" fill="none" stroke="currentColor"/><path d="M272 0h32" fill="none" stroke="currentColor"/><path d="M304 0h32" fill="none" stroke="currentColor"/><path d="M336 0h32" fill="none" stroke="currentColor"/><path d="M368 0h32" fill="none" stroke="currentColor"/><path d="M4e2.0h32" fill="none" stroke="currentColor"/><path d="M432 0h32" fill="none" stroke="currentColor"/><path d="M464 0h32" fill="none" stroke="currentColor"/><path d="M496 0h32" fill="none" stroke="currentColor"/><path d="M528 0h32" fill="none" stroke="currentColor"/><path d="M560 0h32" fill="none" stroke="currentColor"/><path d="M592 0h32" fill="none" stroke="currentColor"/><path d="M624 0h32" fill="none" stroke="currentColor"/><path d="M656 0h32" fill="none" stroke="currentColor"/><path d="M688 0h32" fill="none" stroke="currentColor"/><path d="M720 0h32" fill="none" stroke="currentColor"/><path d="M80 48H752" fill="none" stroke="currentColor"/><path d="M80 80H752" fill="none" stroke="currentColor"/><path d="M184 128h80" fill="none" stroke="currentColor"/><path d="M280 128H408" fill="none" stroke="currentColor"/><path d="M192 160H392" fill="none" stroke="currentColor"/><path d="M192 192h80" fill="none" stroke="currentColor"/><path d="M272 192H392" fill="none" stroke="currentColor"/><path d="M352 240H552" fill="none" stroke="currentColor"/><path d="M2e2 256H328" fill="none" stroke="currentColor"/><path d="M352 272h80" fill="none" stroke="currentColor"/><path d="M432 272H552" fill="none" stroke="currentColor"/><path d="M80 0V16" fill="none" stroke="currentColor"/><path d="M80 48V80" fill="none" stroke="currentColor"/><path d="M112 0V16" fill="none" stroke="currentColor"/><path d="M144 0V16" fill="none" stroke="currentColor"/><path d="M176 0V16" fill="none" stroke="currentColor"/><path d="M184 192v48" fill="none" stroke="currentColor"/><path d="M208 0V16" fill="none" stroke="currentColor"/><path d="M240 0V16" fill="none" stroke="currentColor"/><path d="M272 0V16" fill="none" stroke="currentColor"/><path d="M272 176v16" fill="none" stroke="currentColor"/><path d="M304 0V16" fill="none" stroke="currentColor"/><path d="M336 0V16" fill="none" stroke="currentColor"/><path d="M368 0V16" fill="none" stroke="currentColor"/><path d="M4e2.0V16" fill="none" stroke="currentColor"/><path d="M432 0V16" fill="none" stroke="currentColor"/><path d="M432 256v16" fill="none" stroke="currentColor"/><path d="M464 0V16" fill="none" stroke="currentColor"/><path d="M496 0V16" fill="none" stroke="currentColor"/><path d="M528 0V16" fill="none" stroke="currentColor"/><path d="M560 0V16" fill="none" stroke="currentColor"/><path d="M592 0V16" fill="none" stroke="currentColor"/><path d="M624 0V16" fill="none" stroke="currentColor"/><path d="M656 0V16" fill="none" stroke="currentColor"/><path d="M688 0V16" fill="none" stroke="currentColor"/><path d="M720 0V16" fill="none" stroke="currentColor"/><path d="M752 0V16" fill="none" stroke="currentColor"/><path d="M752 48V80" fill="none" stroke="currentColor"/><path d="M272 168v8" fill="none" stroke="currentColor"/><path d="M432 248v8" fill="none" stroke="currentColor"/><polygon points="192.000000,128.000000 180.000000,122.400002 180.000000,133.600006" fill="currentColor" transform="rotate(180.000000, 184.000000, 128.000000)"/><polygon points="336.000000,256.000000 324.000000,250.399994 324.000000,261.600006" fill="currentColor" transform="rotate(0.000000, 328.000000, 256.000000)"/><polygon points="416.000000,128.000000 404.000000,122.400002 404.000000,133.600006" fill="currentColor" transform="rotate(0.000000, 408.000000, 128.000000)"/><path d="M192 160a16 16 0 00-16 16" fill="none" stroke="currentColor"/><path d="M392 160a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M176 176a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M408 176a16 16 0 01-16 16" fill="none" stroke="currentColor"/><path d="M352 240a16 16 0 00-16 16" fill="none" stroke="currentColor"/><path d="M552 240a16 16 0 0116 16" fill="none" stroke="currentColor"/><path d="M184 240a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M336 256a16 16 0 0016 16" fill="none" stroke="currentColor"/><path d="M568 256a16 16 0 01-16 16" fill="none" stroke="currentColor"/><text text-anchor="middle" x="0" y="180" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="260" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="180" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="260" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="180" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="260" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="180" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="260" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="68" fill="currentColor" style="font-size:1em">T</text><text text-anchor="middle" x="32" y="180" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="260" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="68" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="180" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="260" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="68" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="48" y="180" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="260" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="68" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="180" fill="currentColor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="260" fill="currentColor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="68" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="180" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="260" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="96" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="68" fill="currentColor" style="font-size:1em">E</text><text text-anchor="middle" x="128" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="160" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="160" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="192" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="192" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="192" y="116" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="192" y="180" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="192" y="276" fill="currentColor" style="font-size:1em">С</text><text text-anchor="middle" x="200" y="116" fill="currentColor" style="font-size:1em">.</text><text text-anchor="middle" x="200" y="276" fill="currentColor" style="font-size:1em">д</text><text text-anchor="middle" x="208" y="276" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="216" y="116" fill="currentColor" style="font-size:1em">л</text><text text-anchor="middle" x="216" y="276" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="224" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="224" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="116" fill="currentColor" style="font-size:1em">е</text><text text-anchor="middle" x="224" y="148" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="224" y="180" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="224" y="276" fill="currentColor" style="font-size:1em">г</text><text text-anchor="middle" x="224" y="292" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="232" y="116" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="232" y="292" fill="currentColor" style="font-size:1em">и</text><text text-anchor="middle" x="240" y="116" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="240" y="276" fill="currentColor" style="font-size:1em">н</text><text text-anchor="middle" x="240" y="292" fill="currentColor" style="font-size:1em">м</text><text text-anchor="middle" x="248" y="116" fill="currentColor" style="font-size:1em">я</text><text text-anchor="middle" x="248" y="276" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="248" y="292" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="256" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="256" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="148" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="256" y="180" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="256" y="292" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="264" y="276" fill="currentColor" style="font-size:1em">p</text><text text-anchor="middle" x="264" y="292" fill="currentColor" style="font-size:1em">л</text><text text-anchor="middle" x="272" y="276" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="272" y="292" fill="currentColor" style="font-size:1em">о</text><text text-anchor="middle" x="280" y="276" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="280" y="292" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="288" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="288" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="116" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="288" y="148" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="288" y="180" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="288" y="276" fill="currentColor" style="font-size:1em">(</text><text text-anchor="middle" x="296" y="116" fill="currentColor" style="font-size:1em">.</text><text text-anchor="middle" x="296" y="276" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="304" y="276" fill="currentColor" style="font-size:1em">)</text><text text-anchor="middle" x="312" y="116" fill="currentColor" style="font-size:1em">п</text><text text-anchor="middle" x="312" y="276" fill="currentColor" style="font-size:1em">=</text><text text-anchor="middle" x="320" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="320" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="116" fill="currentColor" style="font-size:1em">р</text><text text-anchor="middle" x="320" y="148" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="320" y="180" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="276" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="328" y="116" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="336" y="116" fill="currentColor" style="font-size:1em">в</text><text text-anchor="middle" x="344" y="116" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="352" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="352" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="116" fill="currentColor" style="font-size:1em">я</text><text text-anchor="middle" x="352" y="148" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="352" y="180" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="352" y="260" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="368" y="116" fill="currentColor" style="font-size:1em">ч</text><text text-anchor="middle" x="376" y="116" fill="currentColor" style="font-size:1em">а</text><text text-anchor="middle" x="384" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="384" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="116" fill="currentColor" style="font-size:1em">с</text><text text-anchor="middle" x="384" y="148" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="384" y="180" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="384" y="260" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="392" y="116" fill="currentColor" style="font-size:1em">т</text><text text-anchor="middle" x="400" y="116" fill="currentColor" style="font-size:1em">ь</text><text text-anchor="middle" x="408" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="416" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="416" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="416" y="260" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="440" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="448" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="448" y="260" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="472" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="480" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="480" y="68" fill="currentColor" style="font-size:1em">C</text><text text-anchor="middle" x="480" y="260" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="504" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="512" y="20" fill="currentColor" style="font-size:1em">3</text><text text-anchor="middle" x="512" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="512" y="260" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="536" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="544" y="20" fill="currentColor" style="font-size:1em">4</text><text text-anchor="middle" x="544" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="544" y="260" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="568" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="576" y="20" fill="currentColor" style="font-size:1em">5</text><text text-anchor="middle" x="576" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="600" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="608" y="20" fill="currentColor" style="font-size:1em">6</text><text text-anchor="middle" x="608" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="632" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="20" fill="currentColor" style="font-size:1em">7</text><text text-anchor="middle" x="640" y="68" fill="currentColor" style="font-size:1em">D</text><text text-anchor="middle" x="664" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="672" y="20" fill="currentColor" style="font-size:1em">8</text><text text-anchor="middle" x="672" y="68" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="696" y="20" fill="currentColor" style="font-size:1em">1</text><text text-anchor="middle" x="704" y="20" fill="currentColor" style="font-size:1em">9</text><text text-anchor="middle" x="704" y="68" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="728" y="20" fill="currentColor" style="font-size:1em">2</text><text text-anchor="middle" x="736" y="20" fill="currentColor" style="font-size:1em">0</text><text text-anchor="middle" x="736" y="68" fill="currentColor" style="font-size:1em">D</text></g></svg></div></li></ul><p>Такие правила сдвигов приводят к квадратичной сложности в худшем случае. Для улучшения
асимптотической сложности худшего случая, в алгоритме также используется техника
запоминания префикса (<em>prefix memorization</em>): когда производится сдвиг на <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{per(pattern)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span></span>
по правилу сдвига для левой подстроки, дополнительно запоминается префикс совпавшей части
шаблона, чтобы не сравнивать его ещё раз в следующем цикле.<br>Это та же техника, которая используется в модификации алгоритма Бойера-Мура с добавлением
правила Галиля (<a href=https://ru.wikipedia.org/wiki/%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC_%D0%91%D0%BE%D0%B9%D0%B5%D1%80%D0%B0_%E2%80%94_%D0%9C%D1%83%D1%80%D0%B0#cite_ref-_c27d75dd26585688_6-0>Wikipedia</a>).</p><p>Ниже представлена первый вариант двустороннего алгоритма. Считаем, что глобальный период
строки шаблона <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{per(pattern)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span></span> и критическое разбиение <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span> с <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>u</mi><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{|u|&lt;per(pattern)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal">u</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span></span>
вычислены заранее.</p><p>Код на kotlin, без обработки суррогатных пар.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>data</span> <span style=color:#00f>class</span> <span style=color:#2b91af>Factorization</span>(<span style=color:#00f>val</span> left: IntRange, <span style=color:#00f>val</span> right: IntRange)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>/**
</span></span></span><span style=display:flex><span><span style=color:green> * Возвращает позиции всех вхождений шаблона [pattern] в строке [text]
</span></span></span><span style=display:flex><span><span style=color:green> */</span>
</span></span><span style=display:flex><span><span style=color:#00f>fun</span> cp1(text: String, pattern: String): List&lt;Int&gt; {
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> result = mutableListOf&lt;Int&gt;()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green>// factorize() разбивает строку шаблона pattern на 2 подстроки:
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// left и right так, что |left| &lt; period.
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// left, right - закрытые диапазоны индексов соответствующих подстрок
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// period - глобальный период строки шаблона
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:#00f>val</span> <span>(</span>left, right) = factorize(pattern)
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> period = pattern.getMinimalPeriod()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> pos = 0
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> memPrefix = -1
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> (pos + pattern.length &lt;= text.length) {
</span></span><span style=display:flex><span>        <span style=color:green>// Сравнение правой части
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>val</span> i = (maxOf(right.first, memPrefix + 1)..right.last).find{ i-&gt;
</span></span><span style=display:flex><span>            pattern[i] != text[pos + i]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> (i != <span style=color:#00f>null</span>) {
</span></span><span style=display:flex><span>            pos = pos + i - right.first + 1
</span></span><span style=display:flex><span>            memPrefix = -1
</span></span><span style=display:flex><span>        } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>            <span style=color:green>// Сравнение левой части
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>val</span> match = (left.last downTo memPrefix + 1).all { j -&gt;
</span></span><span style=display:flex><span>                pattern[j] == text[pos + j]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#00f>if</span> (match) result.add(pos)
</span></span><span style=display:flex><span>            pos += period
</span></span><span style=display:flex><span>            memPrefix = pattern.length - period - 1
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> result
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>memprefix</code> — позиция запомненного префикса, обновляется при встрече несовпадающих
символов. Может быть установлена в неотрицательное значение только при сканировании левой
подстроки.</p><dl><dt>Лемма</dt><dd><p>Пусть <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span> — критическое разбиение строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>. Если <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> — суффикс <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> — префикс
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span> (базовый случай), то длина <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span> кратна глобальному периоду строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>.</p></dd></dl><details><summary>Доказательство</summary><div class=markdown-inner><p>Свойство тривиально выполняется для пустой строки, в противном случае, так как
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{r(u,v)=per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mopen>(</span><span class="mord mathnormal">u</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>, т.е. <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span> равен периоду строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span></span></span>, то <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> можно записать как
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>y</mi><mi>z</mi><msup><mo stretchy="false">)</mo><mi>e</mi></msup></mrow><annotation encoding="application/x-tex">{(yz)^e}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.04398em>yz</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6644em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span></span></span></span>, где <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>y</mi><mi>z</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{|yz|=per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.04398em>yz</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.04398em>z</span></span></span></span> — не пустая, <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{e&gt;0}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6835em;vertical-align:-.0391em></span><span class=mord><span class="mord mathnormal">e</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span><span class=mord>0</span></span></span></span></span>. Если <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span> не будет пустой, то
она будет повторением для разбиения <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span>. Но <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>y</mi><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{|y|&lt;per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span> будет противоречить тому,
что <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span> — критическое разбиение. Поэтому, <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>w</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi>e</mi><mo>∗</mo><mi>p</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{|w|=e*period(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">e</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 169"><g transform="translate(8,16)"><path d="M328 16h80" fill="none" stroke="currentColor"/><path d="M24 32H128" fill="none" stroke="currentColor"/><path d="M128 32h96" fill="none" stroke="currentColor"/><path d="M224 32h96" fill="none" stroke="currentColor"/><path d="M320 32h96" fill="none" stroke="currentColor"/><path d="M416 32h96" fill="none" stroke="currentColor"/><path d="M512 32h96" fill="none" stroke="currentColor"/><path d="M608 32H736" fill="none" stroke="currentColor"/><path d="M24 64H128" fill="none" stroke="currentColor"/><path d="M128 64h96" fill="none" stroke="currentColor"/><path d="M224 64h96" fill="none" stroke="currentColor"/><path d="M320 64h96" fill="none" stroke="currentColor"/><path d="M416 64h96" fill="none" stroke="currentColor"/><path d="M512 64h96" fill="none" stroke="currentColor"/><path d="M608 64H736" fill="none" stroke="currentColor"/><path d="M24 112H224" fill="none" stroke="currentColor"/><path d="M224 112H416" fill="none" stroke="currentColor"/><path d="M416 112H608" fill="none" stroke="currentColor"/><path d="M608 112H736" fill="none" stroke="currentColor"/><path d="M24 144H224" fill="none" stroke="currentColor"/><path d="M224 144H416" fill="none" stroke="currentColor"/><path d="M416 144H608" fill="none" stroke="currentColor"/><path d="M608 144H736" fill="none" stroke="currentColor"/><path d="M24 32V64" fill="none" stroke="currentColor"/><path d="M24 112v32" fill="none" stroke="currentColor"/><path d="M128 32V64" fill="none" stroke="currentColor"/><path d="M224 32V64" fill="none" stroke="currentColor"/><path d="M224 64v48" fill="none" stroke="currentColor"/><path d="M224 112v32" fill="none" stroke="currentColor"/><path d="M320 32V64" fill="none" stroke="currentColor"/><path d="M416 32V64" fill="none" stroke="currentColor"/><path d="M416 64v48" fill="none" stroke="currentColor"/><path d="M416 112v32" fill="none" stroke="currentColor"/><path d="M512 32V64" fill="none" stroke="currentColor"/><path d="M608 32V64" fill="none" stroke="currentColor"/><path d="M608 64v48" fill="none" stroke="currentColor"/><path d="M608 112v32" fill="none" stroke="currentColor"/><path d="M736 32V64" fill="none" stroke="currentColor"/><path d="M736 112v32" fill="none" stroke="currentColor"/><polygon points="336.000000,16.000000 324.000000,10.400000 324.000000,21.600000" fill="currentColor" transform="rotate(180.000000, 328.000000, 16.000000)"/><polygon points="416.000000,16.000000 404.000000,10.400000 404.000000,21.600000" fill="currentColor" transform="rotate(0.000000, 408.000000, 16.000000)"/><text text-anchor="middle" x="152" y="52" fill="currentColor" style="font-size:1em">y</text><text text-anchor="middle" x="160" y="52" fill="currentColor" style="font-size:1em">z</text><text text-anchor="middle" x="280" y="52" fill="currentColor" style="font-size:1em">y</text><text text-anchor="middle" x="288" y="52" fill="currentColor" style="font-size:1em">z</text><text text-anchor="middle" x="320" y="132" fill="currentColor" style="font-size:1em">𝒘</text><text text-anchor="middle" x="336" y="4" fill="currentColor" style="font-size:1em">p</text><text text-anchor="middle" x="344" y="4" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="352" y="4" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="360" y="4" fill="currentColor" style="font-size:1em">i</text><text text-anchor="middle" x="368" y="4" fill="currentColor" style="font-size:1em">o</text><text text-anchor="middle" x="376" y="4" fill="currentColor" style="font-size:1em">d</text><text text-anchor="middle" x="376" y="52" fill="currentColor" style="font-size:1em">y</text><text text-anchor="middle" x="384" y="4" fill="currentColor" style="font-size:1em">(</text><text text-anchor="middle" x="384" y="52" fill="currentColor" style="font-size:1em">z</text><text text-anchor="middle" x="392" y="4" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="400" y="4" fill="currentColor" style="font-size:1em">)</text><text text-anchor="middle" x="472" y="52" fill="currentColor" style="font-size:1em">y</text><text text-anchor="middle" x="480" y="52" fill="currentColor" style="font-size:1em">z</text><text text-anchor="middle" x="512" y="132" fill="currentColor" style="font-size:1em">𝒘</text><text text-anchor="middle" x="568" y="52" fill="currentColor" style="font-size:1em">y</text><text text-anchor="middle" x="576" y="52" fill="currentColor" style="font-size:1em">z</text></g></svg></div></div></details><p>Доказательство корректности алгоритма есть в <a href=#reference_text_algorithms>[1]</a>. В таком
виде алгоритм использует максимум <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>∗</mo><mi mathvariant="normal">∣</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{2*|text|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>2</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222em></span><span class=mord>∣</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class=mord>∣</span></span></span></span></span> операций сравнения. (доказательство там же).</p><p>Глобальный период строки шаблона требуется только тогда, когда он относительно не большой
(меньше примерно половины длины шаблона), в остальных случаях можно обойтись без его
вычисления.</p><p>Второй вариант двустороннего алгоритма рассчитан на применение при большом периоде строки
шаблона. Дополнительное его преимущество — относительно небольшое максимальное количество
сравнений.</p><p>Вариант отличается от первого тем, что в нем больше не используется запоминание префикса,
а при несовпадении в левой подстроке используется другое правило — шаблон сдвигается не на
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{per(pattern)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span></span> позиций, а на некоторое количество <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>q</span></span></span></span>, которое может быть меньше
глобального периода (<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>≤</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{q ≤ per(pattern)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span></span>).<br>Если взять в качестве значения <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{q=1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8389em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>1</span></span></span></span></span>, то алгоритм станет аналогичен
наивному алгоритму с квадратичной сложностью, поэтому число <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>q</span></span></span></span> выбирается с
дополнительным ограничением: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>&gt;</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>u</mi><mi mathvariant="normal">∣</mi><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><mi>v</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{q &gt; \max(|u|, |v|)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span><span class=mop>max</span><span class=mopen>(</span><span class=mord>∣</span><span class="mord mathnormal">u</span><span class=mord>∣</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mord>∣</span><span class=mclose>)</span></span></span></span></span>, где <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span> — критическое разбиение
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">{pattern}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8095em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span></span></span></span></span>. В таком виде число сравнений во втором варианте по прежнему будет
меньше <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>∗</mo><mi mathvariant="normal">∣</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{2*|text|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>2</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222em></span><span class=mord>∣</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class=mord>∣</span></span></span></span></span>, как и в первом, но вычисление глобального периода не
потребуется.<br>Запоминание префикса в данном случае не может быть применено из-за того, что
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>q</span></span></span></span> может быть меньше <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{per(pattern)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span></span>.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>fun</span> twoWay2(text: String, pattern: String): List&lt;Int&gt; {
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> result = mutableListOf&lt;Int&gt;()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> <span>(</span>left, right) = factorize(pattern)
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> q = maxOf(left.length, right.length) + 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> pos = 0
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> (pos + pattern.length &lt;= text.length) {
</span></span><span style=display:flex><span>        <span style=color:green>// Сравнение правой части
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>val</span> i = right.find { i -&gt; pattern[i] != text[pos + i] }
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> (i != <span style=color:#00f>null</span>) {
</span></span><span style=display:flex><span>            pos = pos + i - right.first + 1
</span></span><span style=display:flex><span>        } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>            <span style=color:green>// Сравнение левой части
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>val</span> match = left.reversed().all { j -&gt; pattern[j] == text[pos + j] }
</span></span><span style=display:flex><span>            <span style=color:#00f>if</span> (match) result.add(pos)
</span></span><span style=display:flex><span>            pos += q
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> result
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Доказательство корректности и максимального количества сравнений аналогично доказательству
первого варианта и также есть в <a href=#reference_text_algorithms>[1]</a>.</p><p>Конечный двусторонний алгоритм использует оба предыдущих варианта, выбирая нужный в
зависимости от того, является ли левая подстрока суффиксом периодической части правой. В
алгоритме, кроме критического разбиения строки шаблона на <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo separator="true">,</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">{u,v}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">u</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span></span>, где <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>u</mi><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{|u|&lt;per(pattern)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal">u</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span></span>, также
используется заранее вычисленный период только правой подстроки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span>. Его вычисление может
быть произведено без дополнительных затрат одновременно с вычислением критического
разбиения.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>data</span> <span style=color:#00f>class</span> <span style=color:#2b91af>Factorization</span>(
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> left: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> right: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> rightPeriod: Int
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>fun</span> twoWay(text: String, pattern: String): List&lt;Int&gt; {
</span></span><span style=display:flex><span>    <span style=color:green>// factorize() разбивает строку шаблона pattern на 2 подстроки:
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// left и right так, что |left| &lt; per(pattern) и вычисляет период правой подстроки.
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// left, right — закрытые диапазоны индексов соответствующих подстрок.
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:green>// rightPeriod — период правой подстроки
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:#00f>val</span> <span>(</span>left, right, rightPeriod) = factorize(pattern)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green>// left — суффикс подстроки right[0..rightPeriod-1]
</span></span></span><span style=display:flex><span><span style=color:green></span>    <span style=color:#00f>val</span> leftIsSuffixOfRight = left.all { i -&gt;
</span></span><span style=display:flex><span>        pattern[i] == pattern[right.first + rightPeriod - left.length + i]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#00f>if</span> (leftIsSuffixOfRight) {
</span></span><span style=display:flex><span>        <span style=color:green>// rightPeriod равен периоду строки шаблона per(pattern).
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:green>// Вызываем первый вариант алгоритма, используя left, right
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:green>// и rightPeriod в качестве глобального периода
</span></span></span><span style=display:flex><span><span style=color:green></span>        cp1(text, pattern, left, right, rightPeriod)
</span></span><span style=display:flex><span>    } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>        <span style=color:green>// Вызываем второй вариант алгоритма, используя left, right
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:green>// и q.
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>val</span> q = maxOf(left.length, right.length) + 1
</span></span><span style=display:flex><span>        cp2(text, pattern, left, right, q)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Доказательства корректности алгоритма, а также того, что <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>u</mi><mi mathvariant="normal">∣</mi><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><mi>v</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{q=max(|u|,|v|)+1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class=mopen>(</span><span class=mord>∣</span><span class="mord mathnormal">u</span><span class=mord>∣</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mord>∣</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class=mord>1</span></span></span></span></span> соответствует
условию <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>≤</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{q≤per(pattern)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>q</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span></span> в случае, если <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> не является суффиксом <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo stretchy="false">[</mo><mn>0</mn><mo>…</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{v[0…p-1]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mopen>[</span><span class=mord>0</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">p</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord>1</span><span class=mclose>]</span></span></span></span></span>, даны в <a href=#reference_text_algorithms>[1]</a>.</p><p>Алгоритм выполняется за время <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi mathvariant="normal">∣</mi><mo>+</mo><mi mathvariant="normal">∣</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(|text| + |pattern|)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>O</span><span class=mopen>(</span><span class=mord>∣</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class=mord>∣</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class=mord>∣</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mord>∣</span><span class=mclose>)</span></span></span></span></span> с константной памятью, при этом
выполняется не более <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>∗</mo><mi mathvariant="normal">∣</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{2*|text|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>2</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222em></span><span class=mord>∣</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class=mord>∣</span></span></span></span></span> сравнений.</p><p>Условие &ldquo;<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mrow><mtext> </mtext><mtext mathvariant="monospace">—</mtext><mtext> </mtext><mtext mathvariant="monospace">суффикс</mtext><mtext> </mtext></mrow><mi>v</mi><mo stretchy="false">[</mo><mn>0</mn><mo>…</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{u\texttt{ — суффикс }v[0…p-1]}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">u</span><span class="mord text"><span class="mord texttt"> </span><span class=mord>—</span><span class="mord texttt"> </span><span class="mord texttt cyrillic_fallback">суффикс</span><span class="mord texttt"> </span></span><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mopen>[</span><span class=mord>0</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">p</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord>1</span><span class=mclose>]</span></span></span></span></span>&rdquo; выполняется максимум за <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">{|pattern|/2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mord>∣/2</span></span></span></span></span>
сравнений, вычисление периода и критического разбиения — <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>∗</mo><mi mathvariant="normal">∣</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{4*|pattern|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>4</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222em></span><span class=mord>∣</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mord>∣</span></span></span></span></span> сравнений, поэтому
весь препроцессинг выполняется максимум за <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4.5</mn><mo>∗</mo><mi mathvariant="normal">∣</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{4.5*|pattern|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>4.5</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222em></span><span class=mord>∣</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mord>∣</span></span></span></span></span> сравнений.</p><h4 id=пример-работы-алгоритма>Пример работы алгоритма
<a class=anchor href=#%d0%bf%d1%80%d0%b8%d0%bc%d0%b5%d1%80-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%8b-%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc%d0%b0>#</a></h4><p>1. Возьмем шаблон <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo>=</mo><msup><mtext mathvariant="monospace">A</mtext><mi>n</mi></msup><mtext mathvariant="monospace">B</mtext></mrow><annotation encoding="application/x-tex">{pattern=\texttt{A}^n\texttt{B}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8598em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6654em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord texttt">B</span></span></span></span></span></span>. Критическое разбиение: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mtext mathvariant="monospace">A</mtext><mi>n</mi></msup><mo separator="true">,</mo><mtext mathvariant="monospace">B</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(\texttt{A}^n,
\texttt{B})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6654em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">B</span></span><span class=mclose>)</span></span></span></span></span>. Поиск в тексте <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext mathvariant="monospace">B</mtext><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">{\texttt{B}^m}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6654em></span><span class=mord><span class=mord><span class="mord text"><span class="mord texttt">B</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6654em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span> потребует <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>∗</mo><mi mathvariant="normal">∣</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∣</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{2*|text|/|pattern|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>2</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222em></span><span class=mord>∣</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class=mord>∣/∣</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mord>∣</span></span></span></span></span> сравнений.
Несовпадение встречается в левой части, алгоритм сдвигает шаблон на 3 позиции.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 169"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentColor" style="font-size:1em">T</text><text text-anchor="middle" x="0" y="52" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="100" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="148" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="4" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="8" y="52" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="100" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="148" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="4" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="16" y="52" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="100" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="148" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="4" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="52" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="100" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="148" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="4" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="32" y="52" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="100" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="148" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="52" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="100" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="148" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="52" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="100" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="148" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="52" fill="currentColor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="100" fill="currentColor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="148" fill="currentColor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="52" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="100" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="148" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="88" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="88" y="52" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="104" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="104" y="36" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="104" y="52" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="112" y="52" fill="currentColor" style="font-size:1em">|</text><text text-anchor="middle" x="120" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="120" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="120" y="52" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="136" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="136" y="100" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="152" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="152" y="84" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="152" y="100" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="100" fill="currentColor" style="font-size:1em">|</text><text text-anchor="middle" x="168" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="168" y="84" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="168" y="100" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="184" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="184" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="200" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="200" y="132" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="200" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="148" fill="currentColor" style="font-size:1em">|</text><text text-anchor="middle" x="216" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="216" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="216" y="148" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="232" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="248" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="264" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="280" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="296" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="312" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="328" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="344" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="360" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="376" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="392" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="408" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="424" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="440" y="4" fill="currentColor" style="font-size:1em">B</text></g></svg></div><p>2. Шаблон <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo>=</mo><msup><mtext mathvariant="monospace">A</mtext><mi>n</mi></msup><msup><mtext mathvariant="monospace">BA</mtext><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">{pattern=\texttt{A}^n\texttt{BA}^n}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8598em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6654em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class=mord><span class="mord text"><span class="mord texttt">BA</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6654em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> с глобальным периодом <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{n+1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7278em;vertical-align:-.0833em></span><span class=mord><span class="mord mathnormal">n</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class=mord>1</span></span></span></span></span>. Критическое
разбиение: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mtext mathvariant="monospace">A</mtext><mi>n</mi></msup><mo separator="true">,</mo><msup><mtext mathvariant="monospace">BA</mtext><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(\texttt{A}^n, \texttt{BA}^n)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6654em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord text"><span class="mord texttt">BA</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6654em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span>. Левая часть — суффикс периодической части
правой, поэтому будет использован первый вариант алгоритма и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>∗</mo><mi mathvariant="normal">∣</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi mathvariant="normal">∣</mi><mo>−</mo><mn>2</mn><mi>e</mi><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">{2*|text|-2e-2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>2</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222em></span><span class=mord>∣</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class=mord>∣</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord>2</span><span class="mord mathnormal">e</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord>2</span></span></span></span></span> сравнений при
поиске в тексте <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mtext mathvariant="monospace">A</mtext><mi>n</mi></msup><mtext mathvariant="monospace">BA</mtext><msup><mo stretchy="false">)</mo><mi>e</mi></msup><msup><mtext mathvariant="monospace">A</mtext><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">{text=(\texttt{A}^n\texttt{BA})^e\texttt{A}^{n-1}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0651em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mopen>(</span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6654em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord texttt">BA</span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6644em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8151em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 265"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentColor" style="font-size:1em">T</text><text text-anchor="middle" x="0" y="52" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="100" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="148" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="196" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="244" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="4" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="8" y="52" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="100" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="148" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="196" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="244" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="4" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="16" y="52" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="100" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="148" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="196" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="244" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="4" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="52" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="100" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="148" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="196" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="244" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="4" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="32" y="52" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="100" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="148" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="196" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="244" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="52" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="100" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="148" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="196" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="244" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="52" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="100" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="148" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="196" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="244" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="52" fill="currentColor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="100" fill="currentColor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="148" fill="currentColor" style="font-size:1em">₃</text><text text-anchor="middle" x="56" y="196" fill="currentColor" style="font-size:1em">₄</text><text text-anchor="middle" x="56" y="244" fill="currentColor" style="font-size:1em">₅</text><text text-anchor="middle" x="64" y="52" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="100" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="148" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="196" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="244" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="80" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="80" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="80" y="52" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="96" y="52" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="104" y="52" fill="currentColor" style="font-size:1em">|</text><text text-anchor="middle" x="112" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="112" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="112" y="52" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="128" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="128" y="52" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="128" y="100" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="144" y="52" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="100" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="144" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="152" y="100" fill="currentColor" style="font-size:1em">|</text><text text-anchor="middle" x="160" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="84" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="160" y="100" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="160" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="160" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="168" y="148" fill="currentColor" style="font-size:1em">|</text><text text-anchor="middle" x="176" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="176" y="100" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="176" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="176" y="148" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="192" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="192" y="100" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="192" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="192" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="192" y="196" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="208" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="196" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="228" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="208" y="244" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="216" y="196" fill="currentColor" style="font-size:1em">|</text><text text-anchor="middle" x="224" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="180" fill="currentColor" style="font-size:1em">✘</text><text text-anchor="middle" x="224" y="196" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="224" y="228" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="244" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="232" y="244" fill="currentColor" style="font-size:1em">|</text><text text-anchor="middle" x="240" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="240" y="196" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="240" y="228" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="240" y="244" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="256" y="196" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="256" y="228" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="256" y="244" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="272" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="272" y="228" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="272" y="244" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="288" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="304" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="320" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="336" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="352" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="368" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="384" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="400" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="416" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="432" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="448" y="4" fill="currentColor" style="font-size:1em">A</text></g></svg></div><p>3. Шаблон <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo>=</mo><msup><mtext mathvariant="monospace">A</mtext><mi>n</mi></msup><msup><mtext mathvariant="monospace">BA</mtext><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">{pattern=\texttt{A}^n\texttt{BA}^{n-1}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0096em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6654em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class=mord><span class="mord text"><span class="mord texttt">BA</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8151em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>. Алгоритм будет использовать второй
вариант и также выполнит <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>∗</mo><mi mathvariant="normal">∣</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi mathvariant="normal">∣</mi><mo>−</mo><mn>2</mn><mi>e</mi><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">{2*|text|-2e-2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>2</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222em></span><span class=mord>∣</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class=mord>∣</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord>2</span><span class="mord mathnormal">e</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord>2</span></span></span></span></span> сравнений при
поиске в тексте <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mtext mathvariant="monospace">A</mtext><mi>n</mi></msup><mtext mathvariant="monospace">BA</mtext><msup><mo stretchy="false">)</mo><mi>e</mi></msup><msup><mtext mathvariant="monospace">A</mtext><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">{text=(\texttt{A}^n\texttt{BA})^e\texttt{A}^{n-1}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0651em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mopen>(</span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6654em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord texttt">BA</span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6644em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8151em><span style=top:-3.064em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 169"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentColor" style="font-size:1em">T</text><text text-anchor="middle" x="0" y="52" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="100" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="0" y="148" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="8" y="4" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="8" y="52" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="100" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="148" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="16" y="4" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="16" y="52" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="100" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="148" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="4" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="52" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="100" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="24" y="148" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="4" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="32" y="52" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="100" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="32" y="148" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="52" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="100" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="40" y="148" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="52" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="100" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="48" y="148" fill="currentColor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="52" fill="currentColor" style="font-size:1em">₁</text><text text-anchor="middle" x="56" y="100" fill="currentColor" style="font-size:1em">₂</text><text text-anchor="middle" x="56" y="148" fill="currentColor" style="font-size:1em">₃</text><text text-anchor="middle" x="64" y="52" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="100" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="148" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="80" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="80" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="80" y="52" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="96" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="96" y="52" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="112" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="112" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="112" y="52" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="120" y="52" fill="currentColor" style="font-size:1em">|</text><text text-anchor="middle" x="128" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="128" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="128" y="52" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="144" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="144" y="52" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="144" y="84" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="144" y="100" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="36" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="160" y="52" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="160" y="84" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="160" y="100" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="176" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="176" y="84" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="176" y="100" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="184" y="100" fill="currentColor" style="font-size:1em">|</text><text text-anchor="middle" x="192" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="192" y="84" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="192" y="100" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="208" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="84" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="208" y="100" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="208" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="208" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="84" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="100" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="224" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="224" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="240" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="240" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="240" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="248" y="148" fill="currentColor" style="font-size:1em">|</text><text text-anchor="middle" x="256" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="256" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="256" y="148" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="272" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="272" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="272" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="288" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="288" y="132" fill="currentColor" style="font-size:1em">✔</text><text text-anchor="middle" x="288" y="148" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="304" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="320" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="336" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="352" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="368" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="384" y="4" fill="currentColor" style="font-size:1em">B</text><text text-anchor="middle" x="400" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="416" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="432" y="4" fill="currentColor" style="font-size:1em">A</text><text text-anchor="middle" x="448" y="4" fill="currentColor" style="font-size:1em">B</text></g></svg></div><h2 id=теорема-о-критическом-разбиении>Теорема о критическом разбиении
<a class=anchor href=#%d1%82%d0%b5%d0%be%d1%80%d0%b5%d0%bc%d0%b0-%d0%be-%d0%ba%d1%80%d0%b8%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%bc-%d1%80%d0%b0%d0%b7%d0%b1%d0%b8%d0%b5%d0%bd%d0%b8%d0%b8>#</a></h2><p>Работа двустороннего алгоритма основывается на комбинаторных свойствах строки,
обозначенных в <strong>теореме о критическом разбиении</strong> (<em>Critical Factorization Theorem</em>).</p><p>Теорема гласит, что любая строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> имеет хотя бы одно критическое разбиение <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{x=uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span>
(т.е. такое разбиение, что <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{r(u,v)=per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=mopen>(</span><span class="mord mathnormal">u</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>). Более того, подстрока <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">u</span></span></span></span> может быть
выбрана такой, что <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>u</mi><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{|u|&lt;per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal">u</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>.</p><p>Впервые она была сформулирована и доказана в работах Césari и Vincent в 1978, а в
современном виде — в работе J. Duval (1989). Теорема имеет несколько доказательств, но для
двустороннего алгоритма было представлено свое собственное, на основе вычисления
максимальных суффиксов.</p><p>Введем отношения порядка строк.</p><p><em><strong>Лексикографический</strong></em> (или <em><strong>алфавитный</strong></em>) порядок определяется на множестве строк
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mo lspace="0em" rspace="0em">∗</mo></msup></mrow><annotation encoding="application/x-tex">{A^{*}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6887em></span><span class=mord><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span> упорядоченного алфавита <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">A</span></span></span></span>. Для двух строк <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>∈</mo><msup><mi>A</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">{x, y ∈ A^*}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8831em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span> строка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">{x≤y}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8304em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span></span> тогда, когда
выполняется одно из условий:</p><ul><li><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> — префикс <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span></li><li><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> <em>строго меньше</em> <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span>. Т. е. <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span> можно представить как
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>w</mi><mtext mathvariant="monospace">A</mtext><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>=</mo><mi>w</mi><mtext mathvariant="monospace">B</mtext><mi>y</mi></mrow><annotation encoding="application/x-tex">{x=w\texttt{A}x, y=w\texttt{B}y}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8055em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class="mord text"><span class="mord texttt">A</span></span><span class="mord mathnormal">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class="mord text"><span class="mord texttt">B</span></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span></span>, где <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">{w,x,y}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span></span> — строки из множества <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mo lspace="0em" rspace="0em">∗</mo></msup></mrow><annotation encoding="application/x-tex">{A^{*}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6887em></span><span class=mord><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span>; а
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">A</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">B</mtext></mrow><annotation encoding="application/x-tex">{\texttt{A}, \texttt{B}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8055em;vertical-align:-.1944em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">B</span></span></span></span></span></span> ­— два символа, такие, что <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">A</mtext><mo>&lt;</mo><mtext mathvariant="monospace">B</mtext></mrow><annotation encoding="application/x-tex">{\texttt{A}&lt;\texttt{B}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6502em;vertical-align:-.0391em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">B</span></span></span></span></span></span>.</li></ul><p><em><strong>Обратный лексикографический порядок</strong></em> — лексикографический порядок на алфавите <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">A</span></span></span></span>,
порядок символов которого заменен на обратный. Т.е. <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> строго меньше <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span>, если <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span>
можно представить как <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>w</mi><mtext mathvariant="monospace">A</mtext><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>=</mo><mi>w</mi><mtext mathvariant="monospace">B</mtext><mi>y</mi></mrow><annotation encoding="application/x-tex">{x=w\texttt{A}x, y=w\texttt{B}y}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8055em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class="mord text"><span class="mord texttt">A</span></span><span class="mord mathnormal">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class="mord text"><span class="mord texttt">B</span></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span></span>, где <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">{w,x,y}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span></span> — строки из множества
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mo lspace="0em" rspace="0em">∗</mo></msup></mrow><annotation encoding="application/x-tex">{A^{*}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6887em></span><span class=mord><span class=mord><span class="mord mathnormal">A</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span>, а <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">A</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">B</mtext></mrow><annotation encoding="application/x-tex">{\texttt{A}, \texttt{B}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8055em;vertical-align:-.1944em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">B</span></span></span></span></span></span> ­— два символа, такие, что <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">A</mtext><mo>&gt;</mo><mtext mathvariant="monospace">B</mtext></mrow><annotation encoding="application/x-tex">{\texttt{A}&gt;\texttt{B}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6502em;vertical-align:-.0391em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">B</span></span></span></span></span></span>.</p><p>Обозначим через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo></mrow><annotation encoding="application/x-tex">≤</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mrel>≤</span></span></span></span> прямой лексикографический порядок, а через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⪯</mo></mrow><annotation encoding="application/x-tex">⪯</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mrel>⪯</span></span></span></span> — обратный.</p><p>Стоит отметить, что порядок <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo></mrow><annotation encoding="application/x-tex">≤</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mrel>≤</span></span></span></span> — не инверсия порядка <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⪯</mo></mrow><annotation encoding="application/x-tex">⪯</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mrel>⪯</span></span></span></span>. Например, возьмем алфавит
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mspace linebreak="newline"></mspace><mrow><mtext mathvariant="monospace">A</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">B</mtext><mspace linebreak="newline"></mspace></mrow></mrow><annotation encoding="application/x-tex">{A=\\{\texttt{A},\texttt{B}\\}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8778em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">A</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class="mspace newline"></span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">B</span></span><span class="mspace newline"></span></span></span></span></span></span> с <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">A</mtext><mo>&lt;</mo><mtext mathvariant="monospace">B</mtext></mrow><annotation encoding="application/x-tex">{\texttt{A} &lt; \texttt{B}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6502em;vertical-align:-.0391em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">B</span></span></span></span></span></span>. Для строк <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">B</mi></mrow><annotation encoding="application/x-tex">{\tt ABB}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">ABB</span></span></span></span></span></span> и
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">{\tt ABBAA}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">ABBAA</span></span></span></span></span></span> верны оба равенства:</p><ul><li><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">ABB</mtext><mo>≤</mo><mtext mathvariant="monospace">ABBAA</mtext></mrow><annotation encoding="application/x-tex">{\texttt{ABB} ≤ \texttt{ABBAA}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mord><span class="mord text"><span class="mord texttt">ABB</span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">ABBAA</span></span></span></span></span></span></li><li><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">ABB</mtext><mo>⪯</mo><mtext mathvariant="monospace">ABBAA</mtext></mrow><annotation encoding="application/x-tex">{\texttt{ABB} ⪯ \texttt{ABBAA}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mord><span class="mord text"><span class="mord texttt">ABB</span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>⪯</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">ABBAA</span></span></span></span></span></span></li></ul><p>Более того, в пересечении порядков <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo></mrow><annotation encoding="application/x-tex">≤</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mrel>≤</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⪯</mo></mrow><annotation encoding="application/x-tex">⪯</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mrel>⪯</span></span></span></span> совпадает только первое условие префикса.
Т.е.оба выражения <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">{x ≤ y}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8304em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>⪯</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">{x ⪯ y}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8304em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>⪯</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span></span> верны только в том случае, если <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> — префикс <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span></span>.</p><p>Ниже представлены все суффиксы строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">{\tt ABAABAA}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">ABAABAA</span></span></span></span></span></span>, отсортированные в прямом и
обратном порядке:</p><pre tabindex=0><code class=language-textinline data-lang=textinline>  Суффиксы        ≤                ⪯
ABAABAA         A                BAA
BAABAA          AA               BAABAA
AABAA           AABAA            A
ABAA            ABAA             ABAA
BAA             ABAABAA          ABAABAA
AA              BAA              AA
A               BAABAA           AABAA
</code></pre><p><em><strong>Максимальный суффикс</strong></em> — это наибольшая подстрока строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> в соответствии с заданным
лексикографическим порядком. Обозначим его через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Maxsuf(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>. В примере выше
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">{Maxsuf(\tt ABAABAA)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class=mord><span class="mord mathtt">ABAABAA</span><span class=mclose>)</span></span></span></span></span></span> равен <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">{\tt BAABAA}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">BAABAA</span></span></span></span></span></span> для прямого порядка и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">{\tt AABAA}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">AABAA</span></span></span></span></span></span> для
обратного.</p><p><strong>Теорема</strong></p><p>Пусть <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> ­ — непустая строка из символов алфавита <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">A</span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>u</mi><mi>v</mi><mo>=</mo><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">{x=uv=u&#x27;v&#x27;}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7519em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>uv</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord mathnormal">u</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7519em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7519em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>, где <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span> ­—
лексикографически максимальный суффикс строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> в соответствии с прямым порядком (<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo></mrow><annotation encoding="application/x-tex">≤</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mrel>≤</span></span></span></span>), а
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">v&#x27;</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7519em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7519em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> — лексикографически максимальный суффикс <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> в соответствии с обратным порядком (⪯).
Если <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>v</mi><mi mathvariant="normal">∣</mi><mo>≤</mo><mi mathvariant="normal">∣</mi><msup><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{|v|≤|v&#x27;|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0019em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class=mord>∣</span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7519em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mord>∣</span></span></span></span></span>, то <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{uv}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>uv</span></span></span></span></span> — критическое разбиение <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>, а иначе <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">{u&#x27;v&#x27;}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7519em></span><span class=mord><span class=mord><span class="mord mathnormal">u</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7519em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>v</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7519em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> — критическое
разбиение <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>. Более того, <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>u</mi><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{|u|&lt;per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal">u</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{|u&#x27;|&lt;per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0019em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class=mord><span class="mord mathnormal">u</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7519em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>.</p><p>Доказательство дано в <a href=#reference_text_algorithms>[1]</a></p><p>Имея эту теорему, задача нахождения критического разбиения сводится к задаче нахождения
максимальных суффиксов для прямого и обратного алфавитного порядка.</p><h2 id=вычисление-критического-разбиения>Вычисление критического разбиения
<a class=anchor href=#%d0%b2%d1%8b%d1%87%d0%b8%d1%81%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%ba%d1%80%d0%b8%d1%82%d0%b8%d1%87%d0%b5%d1%81%d0%ba%d0%be%d0%b3%d0%be-%d1%80%d0%b0%d0%b7%d0%b1%d0%b8%d0%b5%d0%bd%d0%b8%d1%8f>#</a></h2><p>Ниже представлен алгоритм вычисления критического разбиения и максимальных суффиксов строки.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>data</span> <span style=color:#00f>class</span> <span style=color:#2b91af>Factorization</span>(
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> left: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> right: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> rightPeriod: Int
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>fun</span> factorize(pattern: String): Factorization {
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> naturalOrder = computeMaxSuffixAndPeriod(pattern, naturalOrder())
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> reverseOrder = computeMaxSuffixAndPeriod(pattern, reverseOrder())
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#00f>if</span> (naturalOrder.right.length &lt;= reverseOrder.right.length)
</span></span><span style=display:flex><span>        naturalOrder <span style=color:#00f>else</span> reverseOrder
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>fun</span> computeMaxSuffixAndPeriod(pattern: String, 
</span></span><span style=display:flex><span>                              comparator: Comparator&lt;Char&gt;): Factorization<span>…</span>
</span></span></code></pre></div><p><code>computeMaxSuffixAndPeriod()</code> — функция, вычисляющая максимальный суффикс и период правой
подстроки.</p><p><strong>Пример 1</strong></p><p>Шаблон <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo>=</mo><mrow><munder accentunder="true"><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi></mrow><mo stretchy="true">undefined</mo></munder><munder accentunder="true"><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi></mrow><mo stretchy="true">undefined</mo></munder><munder accentunder="true"><mrow><mi mathvariant="monospace">A</mi><mtext>   </mtext></mrow><mo stretchy="true">undefined</mo></munder></mrow></mrow><annotation encoding="application/x-tex">{pattern=\tt \underlinesegment{ABA}\underlinesegment{ABA}\underlinesegment{A\space\space\space}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1371em;vertical-align:-.522em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">ABA</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">ABA</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">A</span><span class=mspace> </span><span class=mspace> </span><span class=mspace> </span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span></span></span></span></span></span><br>Период <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">{pattern}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8095em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span></span></span></span></span>: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">{p=3}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8389em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">p</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>3</span></span></span></span></span></p><table><thead><tr><th>Порядок</th><th>Макс. суффикс</th><th>Разбиение</th></tr></thead><tbody><tr><td>Прямой <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo></mrow><annotation encoding="application/x-tex">≤</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mrel>≤</span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">{\tt BAABAA}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">BAABAA</span></span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext mathvariant="monospace">A</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">BAABAA</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(\texttt{A}, \texttt{BAABAA})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class="mord text"><span class="mord texttt">A</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">BAABAA</span></span><span class=mclose>)</span></span></span></span></span></td></tr><tr><td>Обратный <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⪯</mo></mrow><annotation encoding="application/x-tex">⪯</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mrel>⪯</span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">{\tt AABAA}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">AABAA</span></span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext mathvariant="monospace">AB</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">AABAA</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(\texttt{AB}, \texttt{AABAA})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class="mord text"><span class="mord texttt">AB</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">AABAA</span></span><span class=mclose>)</span></span></span></span></span></td></tr></tbody></table><p>Разбиение для прямого порядка — не критическое, его локальный период = 2 (<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">BA</mtext></mrow><annotation encoding="application/x-tex">{\texttt{BA}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord text"><span class="mord texttt">BA</span></span></span></span></span></span>).
Разбиение для обратного порядка — критическое.</p><p><strong>Пример 2</strong></p><p>Шаблон <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mo>=</mo><mrow><munder accentunder="true"><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">B</mi></mrow><mo stretchy="true">undefined</mo></munder><munder accentunder="true"><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mtext>    </mtext></mrow><mo stretchy="true">undefined</mo></munder></mrow></mrow><annotation encoding="application/x-tex">{pattern=\tt \underlinesegment{ABABAABB}\underlinesegment{ABABA\space\space\space\space}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.1371em;vertical-align:-.522em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">ABABAABB</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span><span class="mord accentunder"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6111em><span class=svg-align style=top:-2.478em><span class=pstrut style=height:3em></span><span class=stretchy style=height:.522em;min-width:.888em><span class=halfarrow-left style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMinYMin slice"><path d="M40 281V428H0V94H40V241H4e5v40zm0 0V428H0V94H40V241H4e5v40z"/></svg></span><span class=halfarrow-right style=height:.522em><svg width="400em" height=".522em" viewBox="0 0 4e5 522" preserveAspectRatio="xMaxYMin slice"><path d="M399960 241V94h40V428h-40V281H0v-40zm0 0V94h40V428h-40V281H0v-40z"/></svg></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathtt">ABABA</span><span class=mspace> </span><span class=mspace> </span><span class=mspace> </span><span class=mspace> </span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.522em><span></span></span></span></span></span></span></span></span></span></span><br>Период <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">{pattern}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8095em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span></span></span></span></span>: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">{p=8}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8389em;vertical-align:-.1944em></span><span class=mord><span class="mord mathnormal">p</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>8</span></span></span></span></span></p><table><thead><tr><th>Порядок</th><th>Макс. суффикс</th><th>Разбиение</th></tr></thead><tbody><tr><td>Прямой <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo></mrow><annotation encoding="application/x-tex">≤</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mrel>≤</span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">{\tt BBABABA}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">BBABABA</span></span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext mathvariant="monospace">ABABAA</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">BBABABA</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(\texttt{ABABAA}, \texttt{BBABABA})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class="mord text"><span class="mord texttt">ABABAA</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">BBABABA</span></span><span class=mclose>)</span></span></span></span></span></td></tr><tr><td>Обратный <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⪯</mo></mrow><annotation encoding="application/x-tex">⪯</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7719em;vertical-align:-.136em></span><span class=mrel>⪯</span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">{\tt AABBABABA}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">AABBABABA</span></span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext mathvariant="monospace">ABAB</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">AABBABABA</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{(\texttt{ABAB}, \texttt{AABBABABA})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mopen>(</span><span class="mord text"><span class="mord texttt">ABAB</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">AABBABABA</span></span><span class=mclose>)</span></span></span></span></span></td></tr></tbody></table><p>Оба разбиения критические.</p><p>Алгоритм вычисления максимального суффикса основан на использовании декомпозиции Линдона.
Вместе с максимальным суффиксов в одном цикле вычисляется также период правой подстроки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span></span></span>.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>fun</span> computeMaxSuffixAndPeriod(pattern: String, comparator: Comparator&lt;<span style=color:#00f>in</span> Char&gt;): Factorization {
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> maxSuffix = -1
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> j = 0
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> k = 1
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> period = 1
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> (j + k &lt; pattern.length) {
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> a = pattern[j + k]
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> b = pattern[maxSuffix + k]
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> abOrder = comparator.compare(a, b)
</span></span><span style=display:flex><span>        <span style=color:#00f>when</span> {
</span></span><span style=display:flex><span>            <span style=color:green>// a &lt; b
</span></span></span><span style=display:flex><span><span style=color:green></span>            abOrder &lt; 0 -&gt; {
</span></span><span style=display:flex><span>                j += k
</span></span><span style=display:flex><span>                k = 1
</span></span><span style=display:flex><span>                period = j - maxSuffix
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:green>// a == b
</span></span></span><span style=display:flex><span><span style=color:green></span>            abOrder == 0 -&gt; {
</span></span><span style=display:flex><span>                <span style=color:#00f>if</span> (k != period) {
</span></span><span style=display:flex><span>                    k += 1
</span></span><span style=display:flex><span>                } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>                    j += period
</span></span><span style=display:flex><span>                    k = 1
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:green>// a &gt; b
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>else</span> -&gt;  {
</span></span><span style=display:flex><span>                maxSuffix = j
</span></span><span style=display:flex><span>                j = maxSuffix + 1
</span></span><span style=display:flex><span>                k = 1
</span></span><span style=display:flex><span>                period = 1
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> Factorization(0 .. maxSuffix,
</span></span><span style=display:flex><span>        maxSuffix + 1 .. pattern.lastIndex,
</span></span><span style=display:flex><span>        period
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Обозначим через <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Maxsuf(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span> максимальный суффикс строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> в соответствии с алфавитным
порядком.</p><p>Пусть <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>f</mi><mi>e</mi></msup><mi>g</mi></mrow><annotation encoding="application/x-tex">{Maxsuf(x)=f^eg}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6644em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:.03588em>g</span></span></span></span></span>, где:<br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.10764em>f</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>g</span></span></span></span> — подстроки<br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>f</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi>p</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{|f|=per(Maxsuf(x))}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>))</span></span></span></span></span> (длина <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.10764em>f</span></span></span></span> — это период строки максимального суффикса)<br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>g</span></span></span></span> — собственный префикс подстроки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.10764em>f</span></span></span></span>;<br><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">e</span></span></span></span> — целое число <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">e&gt;0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathnormal">e</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>0</span></span></span></span>.<br>Введем обозначения: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo separator="true">;</mo><mtext> </mtext><mi>R</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">{Per(x)=f; \space Rest(x)=g}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>P</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mpunct>;</span><span class=mspace> </span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal" style=margin-right:.03588em>g</span></span></span></span></span><br>Отметим, что <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Rest(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span> — это грань строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Maxsuf(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span> и <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>o</mi><mi>r</mi><mi>d</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><msup><mi>f</mi><mrow><mi>e</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>g</mi></mrow><annotation encoding="application/x-tex">{Border(Maxsuf(x))=f^{e-1}g}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0641em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05017em>B</span><span class="mord mathnormal" style=margin-right:.02778em>or</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>))</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:.03588em>g</span></span></span></span></span>, даже при <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{e=1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6444em></span><span class=mord><span class="mord mathnormal">e</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord>1</span></span></span></span></span>.</p><p>Переменная <code>maxSuffix</code> в алгоритме — позиция перед первым символом рассматриваемой строки
максимального суффикса.<br><code>period</code> — период строки максимального суффикса, длина <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>P</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>.<br><code>j</code> … <code>j+k</code> — подстрока в <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Maxsuf(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span> последнего встреченного вхождения <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Rest(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span> в
подстроке максимального суффикса.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 960 265"><g transform="translate(8,16)"><path d="M152 0H696" fill="none" stroke="currentColor"/><path d="M152 32H696" fill="none" stroke="currentColor"/><path d="M16 64H120" fill="none" stroke="currentColor"/><path d="M120 64h32" fill="none" stroke="currentColor"/><path d="M152 64h88" fill="none" stroke="currentColor"/><path d="M240 64h32" fill="none" stroke="currentColor"/><path d="M272 64H696" fill="none" stroke="currentColor"/><path d="M696 64h32" fill="none" stroke="currentColor"/><path d="M728 64h64" fill="none" stroke="currentColor"/><path d="M16 96H120" fill="none" stroke="currentColor"/><path d="M120 96h32" fill="none" stroke="currentColor"/><path d="M152 96h88" fill="none" stroke="currentColor"/><path d="M240 96h32" fill="none" stroke="currentColor"/><path d="M272 96H696" fill="none" stroke="currentColor"/><path d="M696 96h32" fill="none" stroke="currentColor"/><path d="M728 96h64" fill="none" stroke="currentColor"/><path d="M152 144H304" fill="none" stroke="currentColor"/><path d="M456 144H608" fill="none" stroke="currentColor"/><path d="M608 144h88" fill="none" stroke="currentColor"/><path d="M152 176H304" fill="none" stroke="currentColor"/><path d="M456 176H608" fill="none" stroke="currentColor"/><path d="M608 176h88" fill="none" stroke="currentColor"/><path d="M152 208h88" fill="none" stroke="currentColor"/><path d="M152 240h88" fill="none" stroke="currentColor"/><path d="M16 64V96" fill="none" stroke="currentColor"/><path d="M120 64V96" fill="none" stroke="currentColor"/><path d="M152 0V32" fill="none" stroke="currentColor"/><path d="M152 64V96" fill="none" stroke="currentColor"/><path d="M152 144v32" fill="none" stroke="currentColor"/><path d="M152 208v32" fill="none" stroke="currentColor"/><path d="M240 64V96" fill="none" stroke="currentColor"/><path d="M240 208v32" fill="none" stroke="currentColor"/><path d="M272 64V96" fill="none" stroke="currentColor"/><path d="M304 144v32" fill="none" stroke="currentColor"/><path d="M456 144v32" fill="none" stroke="currentColor"/><path d="M608 144v32" fill="none" stroke="currentColor"/><path d="M696 0V32" fill="none" stroke="currentColor"/><path d="M696 64V96" fill="none" stroke="currentColor"/><path d="M696 144v32" fill="none" stroke="currentColor"/><path d="M728 64V96" fill="none" stroke="currentColor"/><path d="M792 64V96" fill="none" stroke="currentColor"/><text text-anchor="middle" x="0" y="84" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="128" y="116" fill="currentColor" style="font-size:1em">m</text><text text-anchor="middle" x="136" y="116" fill="currentColor" style="font-size:1em">s</text><text text-anchor="middle" x="152" y="52" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="152" y="116" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="152" y="132" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="152" y="196" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="168" y="228" fill="currentColor" style="font-size:1em">R</text><text text-anchor="middle" x="176" y="164" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="176" y="228" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="184" y="164" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="184" y="228" fill="currentColor" style="font-size:1em">s</text><text text-anchor="middle" x="192" y="164" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="192" y="228" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="200" y="164" fill="currentColor" style="font-size:1em">i</text><text text-anchor="middle" x="200" y="228" fill="currentColor" style="font-size:1em">(</text><text text-anchor="middle" x="208" y="164" fill="currentColor" style="font-size:1em">o</text><text text-anchor="middle" x="208" y="228" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="216" y="164" fill="currentColor" style="font-size:1em">d</text><text text-anchor="middle" x="216" y="228" fill="currentColor" style="font-size:1em">)</text><text text-anchor="middle" x="224" y="164" fill="currentColor" style="font-size:1em">(</text><text text-anchor="middle" x="232" y="164" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="240" y="116" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="240" y="132" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="240" y="164" fill="currentColor" style="font-size:1em">)</text><text text-anchor="middle" x="240" y="196" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="248" y="196" fill="currentColor" style="font-size:1em">m</text><text text-anchor="middle" x="256" y="84" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="256" y="196" fill="currentColor" style="font-size:1em">s</text><text text-anchor="middle" x="264" y="84" fill="currentColor" style="font-size:1em">'</text><text text-anchor="middle" x="264" y="196" fill="currentColor" style="font-size:1em">+</text><text text-anchor="middle" x="272" y="20" fill="currentColor" style="font-size:1em">M</text><text text-anchor="middle" x="272" y="196" fill="currentColor" style="font-size:1em">k</text><text text-anchor="middle" x="280" y="20" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="288" y="20" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="296" y="20" fill="currentColor" style="font-size:1em">s</text><text text-anchor="middle" x="304" y="20" fill="currentColor" style="font-size:1em">u</text><text text-anchor="middle" x="312" y="20" fill="currentColor" style="font-size:1em">f</text><text text-anchor="middle" x="320" y="20" fill="currentColor" style="font-size:1em">(</text><text text-anchor="middle" x="328" y="20" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="328" y="164" fill="currentColor" style="font-size:1em">…</text><text text-anchor="middle" x="336" y="20" fill="currentColor" style="font-size:1em">)</text><text text-anchor="middle" x="352" y="164" fill="currentColor" style="font-size:1em">…</text><text text-anchor="middle" x="376" y="164" fill="currentColor" style="font-size:1em">…</text><text text-anchor="middle" x="408" y="164" fill="currentColor" style="font-size:1em">…</text><text text-anchor="middle" x="432" y="164" fill="currentColor" style="font-size:1em">…</text><text text-anchor="middle" x="472" y="164" fill="currentColor" style="font-size:1em">P</text><text text-anchor="middle" x="480" y="164" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="488" y="164" fill="currentColor" style="font-size:1em">r</text><text text-anchor="middle" x="496" y="164" fill="currentColor" style="font-size:1em">i</text><text text-anchor="middle" x="504" y="164" fill="currentColor" style="font-size:1em">o</text><text text-anchor="middle" x="512" y="164" fill="currentColor" style="font-size:1em">d</text><text text-anchor="middle" x="520" y="164" fill="currentColor" style="font-size:1em">(</text><text text-anchor="middle" x="528" y="164" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="536" y="164" fill="currentColor" style="font-size:1em">)</text><text text-anchor="middle" x="608" y="84" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="608" y="116" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="608" y="132" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="616" y="116" fill="currentColor" style="font-size:1em">j</text><text text-anchor="middle" x="624" y="164" fill="currentColor" style="font-size:1em">R</text><text text-anchor="middle" x="632" y="164" fill="currentColor" style="font-size:1em">e</text><text text-anchor="middle" x="640" y="164" fill="currentColor" style="font-size:1em">s</text><text text-anchor="middle" x="648" y="164" fill="currentColor" style="font-size:1em">t</text><text text-anchor="middle" x="656" y="164" fill="currentColor" style="font-size:1em">(</text><text text-anchor="middle" x="664" y="164" fill="currentColor" style="font-size:1em">x</text><text text-anchor="middle" x="672" y="164" fill="currentColor" style="font-size:1em">)</text><text text-anchor="middle" x="696" y="116" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="696" y="132" fill="currentColor" style="font-size:1em">:</text><text text-anchor="middle" x="704" y="116" fill="currentColor" style="font-size:1em">j</text><text text-anchor="middle" x="712" y="84" fill="currentColor" style="font-size:1em">a</text><text text-anchor="middle" x="712" y="116" fill="currentColor" style="font-size:1em">+</text><text text-anchor="middle" x="720" y="116" fill="currentColor" style="font-size:1em">k</text></g></svg></div><p>Алгоритм выполняется за время <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(|pattern|)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>O</span><span class=mopen>(</span><span class=mord>∣</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mord>∣</span><span class=mclose>)</span></span></span></span></span>, при этом выполняется менее <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>∗</mo><mi mathvariant="normal">∣</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{2*|pattern|}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class=mord>2</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222em></span><span class=mord>∣</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class="mord mathnormal">n</span><span class=mord>∣</span></span></span></span></span>
сравнений.</p><p>Рассмотрим на примере, как изменяется максимальный суффикс строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span> при добавлении в её
конец символов <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">A</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">B</mtext><mtext> и </mtext><mtext mathvariant="monospace">C</mtext></mrow><annotation encoding="application/x-tex">\texttt{A}, \texttt{B}\text{ и }\texttt{C}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8055em;vertical-align:-.1944em></span><span class="mord text"><span class="mord texttt">A</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord text"><span class="mord texttt">B</span></span><span class="mord text"><span class=mord> </span><span class="mord cyrillic_fallback">и</span><span class=mord> </span></span><span class="mord text"><span class="mord texttt">C</span></span></span></span></span>.</p><p>Пусть <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi></mrow></mrow><annotation encoding="application/x-tex">{x=\tt ABCBCBACBCBACBC}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mord><span class="mord mathtt">ABCBCBACBCBACBC</span></span></span></span></span></span>. В соответствии с алфавитным порядком её максимальный суффикс равен
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext mathvariant="monospace">CBCBACBCBACBC</mtext><mo>=</mo><mo stretchy="false">(</mo><mtext mathvariant="monospace">CBCBA</mtext><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mtext mathvariant="monospace">CBC</mtext></mrow><annotation encoding="application/x-tex">{Maxsuf(x)=\texttt{CBCBACBCBACBC}=(\texttt{CBCBA})²\texttt{CBC}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0641em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">CBCBACBCBACBC</span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class=mopen>(</span><span class="mord text"><span class="mord texttt">CBCBA</span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord text"><span class="mord texttt">CBC</span></span></span></span></span></span>.<br>Макс. суффикс для строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mtext mathvariant="monospace">A</mtext></mrow><annotation encoding="application/x-tex">{x\texttt{A}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal">x</span><span class="mord text"><span class="mord texttt">A</span></span></span></span></span></span>: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">{\tt CBCBACBCBACBCA}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">CBCBACBCBACBCA</span></span></span></span></span></span> = <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext mathvariant="monospace">A</mtext></mrow><annotation encoding="application/x-tex">{Maxsuf(x)\texttt{A}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class="mord text"><span class="mord texttt">A</span></span></span></span></span></span>. Слово
без границ.<br>Макс. суффикс для строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mtext mathvariant="monospace">B</mtext></mrow><annotation encoding="application/x-tex">{x\texttt{B}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal">x</span><span class="mord text"><span class="mord texttt">B</span></span></span></span></span></span>: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">A</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">B</mi></mrow><annotation encoding="application/x-tex">{\tt CBCBACBCBACBCB}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">CBCBACBCBACBCB</span></span></span></span></span></span> = <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext mathvariant="monospace">B</mtext></mrow><annotation encoding="application/x-tex">{Maxsuf(x)\texttt{B}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class="mord text"><span class="mord texttt">B</span></span></span></span></span></span>. У
строки такой же период, как и у <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Maxsuf(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>.<br>Макс. суффикс для строки <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mtext mathvariant="monospace">C</mtext></mrow><annotation encoding="application/x-tex">{x\texttt{C}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathnormal">x</span><span class="mord text"><span class="mord texttt">C</span></span></span></span></span></span>: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">C</mi></mrow><annotation encoding="application/x-tex">{\tt CC}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class=mord><span class="mord mathtt">CC</span></span></span></span></span></span>.</p><p>Доказательство корректности алгоритма основывается на следующей лемме.</p><dl><dt><strong>Лемма</strong></dt><dd><p>Возьмем строку <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>, символ <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">A</mi></mrow><annotation encoding="application/x-tex">\tt A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord mathtt">A</span></span></span></span></span> и символ <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">A’</mtext></mrow><annotation encoding="application/x-tex">{\texttt{A&#x27;}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord text"><span class="mord texttt">A’</span></span></span></span></span></span> такой, что
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext mathvariant="monospace">A’</mtext></mrow><annotation encoding="application/x-tex">{Rest(x)\texttt{A&#x27;}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class="mord text"><span class="mord texttt">A’</span></span></span></span></span></span> — это префикс <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Maxsuf(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span>. Тогда значения
<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mtext mathvariant="monospace">A</mtext><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>P</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mtext mathvariant="monospace">A</mtext><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>R</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mtext mathvariant="monospace">A</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Maxsuf(x\texttt{A}), Per(x\texttt{A}), Rest(x\texttt{A})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class="mord text"><span class="mord texttt">A</span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.13889em>P</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class="mord text"><span class="mord texttt">A</span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class="mord text"><span class="mord texttt">A</span></span><span class=mclose>)</span></span></span></span></span> будут равны следующим:</p><table><thead><tr><th><strong>Условие</strong></th><th><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">M</mi><mi mathvariant="bold">a</mi><mi mathvariant="bold">x</mi><mi mathvariant="bold">s</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">f</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mtext mathvariant="monospace">A</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bf Maxsuf(x\texttt{A})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathbf" style=margin-right:.10903em>Maxsuf</span><span class=mopen>(</span><span class="mord mathbf">x</span><span class="mord text"><span class="mord texttt">A</span></span><span class=mclose>)</span></span></span></span></span></th><th><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">P</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">r</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mtext mathvariant="monospace">A</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bf Per(x\texttt{A})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathbf">Per</span><span class=mopen>(</span><span class="mord mathbf">x</span><span class="mord text"><span class="mord texttt">A</span></span><span class=mclose>)</span></span></span></span></span></th><th><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">s</mi><mi mathvariant="bold">t</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mtext mathvariant="monospace">A</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bf Rest(x\texttt{A})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathbf">Rest</span><span class=mopen>(</span><span class="mord mathbf">x</span><span class="mord text"><span class="mord texttt">A</span></span><span class=mclose>)</span></span></span></span></span></th></tr></thead><tbody><tr><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">A</mtext><mo>&lt;</mo><mtext mathvariant="monospace">A’</mtext></mrow><annotation encoding="application/x-tex">{\texttt{A} &lt; \texttt{A&#x27;}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6502em;vertical-align:-.0391em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">A’</span></span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext mathvariant="monospace">A</mtext></mrow><annotation encoding="application/x-tex">{Maxsuf(x)\texttt{A}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class="mord text"><span class="mord texttt">A</span></span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext mathvariant="monospace">A</mtext></mrow><annotation encoding="application/x-tex">{Maxsuf(x)\texttt{A}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class="mord text"><span class="mord texttt">A</span></span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ε</mi></mrow><annotation encoding="application/x-tex">ε</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">ε</span></span></span></span></td></tr><tr><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">A</mtext><mo>=</mo><mtext mathvariant="monospace">A’</mtext></mrow><annotation encoding="application/x-tex">{\texttt{A} = \texttt{A&#x27;}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6111em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">A’</span></span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext mathvariant="monospace">A</mtext></mrow><annotation encoding="application/x-tex">{Maxsuf(x)\texttt{A}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class="mord text"><span class="mord texttt">A</span></span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Per(x)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>P</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext mathvariant="monospace">A</mtext></mrow><annotation encoding="application/x-tex">{Rest(x)\texttt{A}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class="mord text"><span class="mord texttt">A</span></span></span></span></span></span>, либо <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ε</mi></mrow><annotation encoding="application/x-tex">ε</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">ε</span></span></span></span></td></tr><tr><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">A</mtext><mo>&gt;</mo><mtext mathvariant="monospace">A’</mtext></mrow><annotation encoding="application/x-tex">{\texttt{A} &gt; \texttt{A&#x27;}}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6502em;vertical-align:-.0391em></span><span class=mord><span class="mord text"><span class="mord texttt">A</span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span><span class="mord text"><span class="mord texttt">A’</span></span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>s</mi><mi>u</mi><mi>f</mi><mo stretchy="false">(</mo><mi>R</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext mathvariant="monospace">A</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Maxsuf(Rest(x)\texttt{A})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class="mord text"><span class="mord texttt">A</span></span><span class=mclose>)</span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>R</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext mathvariant="monospace">A</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Per(Rest(x)\texttt{A})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>P</span><span class="mord mathnormal" style=margin-right:.02778em>er</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class="mord text"><span class="mord texttt">A</span></span><span class=mclose>)</span></span></span></span></span></td><td><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>R</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext mathvariant="monospace">A</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{Rest(Rest(x)\texttt{A})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.00773em>R</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class="mord text"><span class="mord texttt">A</span></span><span class=mclose>)</span></span></span></span></span></td></tr></tbody></table><p>Доказательство дано в <a href=#reference_text_algorithms>[1]</a>.</p></dd></dl><h2 id=реализация-алгоритма>Реализация алгоритма
<a class=anchor href=#%d1%80%d0%b5%d0%b0%d0%bb%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-%d0%b0%d0%bb%d0%b3%d0%be%d1%80%d0%b8%d1%82%d0%bc%d0%b0>#</a></h2><p>Ниже приведена полная реализация алгоритма (на Kotlin, без учета суррогатных пар).</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#00f>internal</span> <span style=color:#00f>data</span> <span style=color:#00f>class</span> <span style=color:#2b91af>Factorization</span>(
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> pattern: String,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> left: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> right: IntRange,
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> rightPeriod: Int
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    <span style=color:#00f>fun</span> leftIsSuffixOfRight(): Boolean {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> left.all {
</span></span><span style=display:flex><span>            i -&gt; pattern[i] == pattern[right.first + rightPeriod - left.length + i]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>fun</span> findSubstringTwoWay(text: String, pattern: String): List&lt;Int&gt; {
</span></span><span style=display:flex><span>    <span style=color:#00f>when</span> {
</span></span><span style=display:flex><span>        text.isEmpty() -&gt; <span style=color:#00f>return</span> emptyList()
</span></span><span style=display:flex><span>        pattern.isEmpty() -&gt; <span style=color:#00f>return</span> text.indices.toList()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> result: MutableList&lt;Int&gt; = mutableListOf()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> factorization = factorize(pattern)
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (factorization.leftIsSuffixOfRight()) {
</span></span><span style=display:flex><span>        <span style=color:green>// CP1
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>val</span> <span>(</span>_, left, right, period) = factorization
</span></span><span style=display:flex><span>        <span style=color:#00f>var</span> pos = 0
</span></span><span style=display:flex><span>        <span style=color:#00f>var</span> memPrefix = -1
</span></span><span style=display:flex><span>        <span style=color:#00f>while</span> (pos + pattern.length &lt;= text.length) {
</span></span><span style=display:flex><span>            <span style=color:green>// Сравнение правой части
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>val</span> i = (maxOf(right.first, memPrefix + 1)..right.last).find { i -&gt;
</span></span><span style=display:flex><span>                pattern[i] != text[pos + i]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#00f>if</span> (i != <span style=color:#00f>null</span>) {
</span></span><span style=display:flex><span>                pos = pos + i - right.first + 1
</span></span><span style=display:flex><span>                memPrefix = -1
</span></span><span style=display:flex><span>            } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>                <span style=color:green>// Сравнение левой части
</span></span></span><span style=display:flex><span><span style=color:green></span>                <span style=color:#00f>val</span> match = (left.last downTo memPrefix + 1).all { j -&gt;
</span></span><span style=display:flex><span>                    pattern[j] == text[pos + j]
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                <span style=color:#00f>if</span> (match) result.add(pos)
</span></span><span style=display:flex><span>                pos += period
</span></span><span style=display:flex><span>                memPrefix = pattern.length - period - 1
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>        <span style=color:green>// CP2
</span></span></span><span style=display:flex><span><span style=color:green></span>        <span style=color:#00f>val</span> left = factorization.left.reversed()
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> right = factorization.right
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> q = maxOf(left.length, right.length) + 1
</span></span><span style=display:flex><span>        <span style=color:#00f>var</span> pos = 0
</span></span><span style=display:flex><span>        <span style=color:#00f>while</span> (pos + pattern.length &lt;= text.length) {
</span></span><span style=display:flex><span>            <span style=color:green>// Сравнение правой части
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>val</span> i = right.find { i -&gt; pattern[i] != text[pos + i] }
</span></span><span style=display:flex><span>            <span style=color:#00f>if</span> (i != <span style=color:#00f>null</span>) {
</span></span><span style=display:flex><span>                pos = pos + i - right.first + 1
</span></span><span style=display:flex><span>            } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>                <span style=color:green>// Сравнение левой части
</span></span></span><span style=display:flex><span><span style=color:green></span>                <span style=color:#00f>val</span> match = left.all { j -&gt; pattern[j] == text[pos + j] }
</span></span><span style=display:flex><span>                <span style=color:#00f>if</span> (match) result.add(pos)
</span></span><span style=display:flex><span>                pos += q
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> result
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>private</span> <span style=color:#00f>fun</span> factorize(pattern: String): Factorization {
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> naturalOrder = computeMaxSuffixAndPeriod(pattern, naturalOrder())
</span></span><span style=display:flex><span>    <span style=color:#00f>val</span> reverseOrder = computeMaxSuffixAndPeriod(pattern, reverseOrder())
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#00f>if</span> (naturalOrder.right.length &lt;= reverseOrder.right.length)
</span></span><span style=display:flex><span>        naturalOrder <span style=color:#00f>else</span> reverseOrder
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>internal</span> <span style=color:#00f>fun</span> computeMaxSuffixAndPeriod(pattern: String,
</span></span><span style=display:flex><span>                                       comparator: Comparator&lt;<span style=color:#00f>in</span> Char&gt;): Factorization {
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> maxSuffix = -1
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> j = 0
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> k = 1
</span></span><span style=display:flex><span>    <span style=color:#00f>var</span> period = 1
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> (j + k &lt; pattern.length) {
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> a = pattern[j + k]
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> b = pattern[maxSuffix + k]
</span></span><span style=display:flex><span>        <span style=color:#00f>val</span> abOrder = comparator.compare(a, b)
</span></span><span style=display:flex><span>        <span style=color:#00f>when</span> {
</span></span><span style=display:flex><span>            <span style=color:green>// a &lt; b
</span></span></span><span style=display:flex><span><span style=color:green></span>            abOrder &lt; 0 -&gt; {
</span></span><span style=display:flex><span>                j += k
</span></span><span style=display:flex><span>                k = 1
</span></span><span style=display:flex><span>                period = j - maxSuffix
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:green>// a == b
</span></span></span><span style=display:flex><span><span style=color:green></span>            abOrder == 0 -&gt; {
</span></span><span style=display:flex><span>                <span style=color:#00f>if</span> (k != period) {
</span></span><span style=display:flex><span>                    k += 1
</span></span><span style=display:flex><span>                } <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>                    j += period
</span></span><span style=display:flex><span>                    k = 1
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:green>// a &gt; b
</span></span></span><span style=display:flex><span><span style=color:green></span>            <span style=color:#00f>else</span> -&gt; {
</span></span><span style=display:flex><span>                maxSuffix = j
</span></span><span style=display:flex><span>                j = maxSuffix + 1
</span></span><span style=display:flex><span>                k = 1
</span></span><span style=display:flex><span>                period = 1
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> Factorization(
</span></span><span style=display:flex><span>        pattern,
</span></span><span style=display:flex><span>        0..maxSuffix,
</span></span><span style=display:flex><span>        maxSuffix + 1..pattern.lastIndex,
</span></span><span style=display:flex><span>        period
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Она же в репозитории: <a href=https://github.com/illarionov/strstr/blob/main/code/src/main/kotlin/substring/TwoWay.kt>twoway.kt</a>.</p><h2 id=источники>Источники
<a class=anchor href=#%d0%b8%d1%81%d1%82%d0%be%d1%87%d0%bd%d0%b8%d0%ba%d0%b8>#</a></h2><ol><li id=reference_text_algorithms>CROCHEMORE, M., RYTTER, W., 1994, Text Algorithms, Oxford University Press. (<a href=https://www-igm.univ-mlv.fr/~mac/REC/B1.html>ссылка</a>)</li><li id=reference_twoway_string_matching>CROCHEMORE M., PERRIN D., 1991, Two-way string-matching, Journal of the ACM 38(3):651-675. (<a href=https://monge.univ-mlv.fr/~mac/Articles-PDF/CP-1991-jacm.pdf>ссылка</a>)</li><li id=reference_twoway_wikipedia>Wikipedia: Two-way string-matching algorithm (<a href=https://en.wikipedia.org/wiki/Two-way_string-matching_algorithm>ссылка</a>).</li><li id=reference_twoway_itmo>Викиконспекты ИТМО: Двусторонний алгоритм (<a href="https://neerc.ifmo.ru/wiki/index.php?title=%D0%94%D0%B2%D1%83%D1%81%D1%82%D0%BE%D1%80%D0%BE%D0%BD%D0%BD%D0%B8%D0%B9_%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC">ссылка</a>).</li><li id=reference_kutelin_clickhouse>Кутенин Данила М., 2019. Умные алгоритмы обработки строк в ClickHouse (<a href=https://www.hse.ru/edu/vkr/296308510>ссылка</a>)</li><li id=reference_galil_seiferas>Galil-Seiferas algorithm (<a href=http://www-igm.univ-mlv.fr/~lecroq/string/node25.html#SECTION00250>ссылка</a>)</li></ol></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/illarionov/strstr/commit/dffff5a9053fea6224a8dadeae13f7adc3f61ebc title='Последнее изменение от Alexey Illarionov | 2025-01-27' target=_blank rel=noopener><img src=./svg/calendar.svg class=book-icon alt>
<span>2025-01-27</span></a></div><div><a class="flex align-center" href=https://github.com/illarionov/strstr/edit/main/content/_index.md target=_blank rel=noopener><img src=./svg/edit.svg class=book-icon alt>
<span>Редактировать эту страницу</span></a></div></div></footer><div class=book-comments><script src=https://utteranc.es/client.js data-repo=illarionov/strstr data-issue-term=title data-label=comment data-theme=github-light crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#двусторонний-алгоритм>Двусторонний алгоритм</a><ul><li><a href=#общая-схема>Общая схема</a></li><li><a href=#базовые-понятия>Базовые понятия</a></li><li><a href=#описание-алгоритма>Описание алгоритма</a><ul><li></li></ul></li><li><a href=#теорема-о-критическом-разбиении>Теорема о критическом разбиении</a></li><li><a href=#вычисление-критического-разбиения>Вычисление критического разбиения</a></li><li><a href=#реализация-алгоритма>Реализация алгоритма</a></li><li><a href=#источники>Источники</a></li></ul></li></ul></nav></div></aside></main></body></html>